"use strict";(self.webpackChunknext_docs=self.webpackChunknext_docs||[]).push([[6979],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,c=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=s(n),m=a,f=u["".concat(c,".").concat(m)]||u[m]||p[m]||l;return n?r.createElement(f,i(i({ref:t},d),{},{components:n})):r.createElement(f,i({ref:t},d))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[u]="string"==typeof e?e:a,i[1]=o;for(var s=2;s<l;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},96507:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(67294);const a={ringContainer:"ringContainer_Jl9i",ring:"ring_UfU1"};function l(){return r.createElement("div",{className:a.ringContainer},r.createElement("div",{className:a.ring},r.createElement("div",null),r.createElement("div",null),r.createElement("div",null),r.createElement("div",null)))}},94981:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(67294),a=n(96507);const l=r.lazy((()=>Promise.all([n.e(532),n.e(9319),n.e(6678)]).then(n.bind(n,26678)))),i=r.lazy((()=>Promise.all([n.e(532),n.e(9850),n.e(3569)]).then(n.bind(n,43569)))),o=(0,r.forwardRef)((function(e,t){let{files:n,currentFile:o,theme:c,className:s,typingEffectReady:d,onChange:u}=e;const p=!!navigator.maxTouchPoints;return(0,r.useEffect)((()=>{if(p&&u){const e=n.find((e=>e.name===o));e.codeSlides&&u(e.code,o)}}),[o,n,p,u]),r.createElement(r.Suspense,{fallback:r.createElement(a.Z,null)},p?r.createElement(l,{files:n,currentFile:o,className:s}):r.createElement(i,{files:n,currentFile:o,theme:c,className:s,typingEffectReady:d,onChange:u,ref:t}))}))},8697:(e,t,n)=>{n.d(t,{Z:()=>k});var r=n(67294),a=n(73935),l=n(79524),i=n(9200),o=n(51048);function c(e){let{children:t,fallback:n}=e;return(0,o.Z)()?r.createElement(r.Fragment,null,t?.()):n??null}var s,d=n(86010),u=n(55550),p=n(33788);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}const f=e=>{let{title:t,titleId:n,...a}=e;return r.createElement("svg",m({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-up",viewBox:"0 0 16 16","aria-labelledby":n},a),t?r.createElement("title",{id:n},t):null,s||(s=r.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"})))};var b;function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}const h=e=>{let{title:t,titleId:n,...a}=e;return r.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",className:"bi bi-chevron-down",viewBox:"0 0 16 16","aria-labelledby":n},a),t?r.createElement("title",{id:n},t):null,b||(b=r.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"})))};var g=n(96507);const y={example:"example_UmKM",editorColumn:"editorColumn_AL_t",previewColumn:"previewColumn_FsuT",editorContainer:"editorContainer_sUW3",preview:"preview_bwr6",ready:"ready_dhJq",expanded:"expanded_o_pT",collapsed:"collapsed_aDj8",tabs:"tabs_yDjk",tab:"tab_uskj",active:"active_KoUc",buttonToggleShowMore:"buttonToggleShowMore_A68N",expandable:"expandable_arS4",condensed:"condensed_ytqo"};function k(e){let{files:t,hiddenFiles:o,condensed:s,wait:m,className:b}=e;const v=(0,r.useRef)(),k=(0,r.useRef)(),{colorMode:C}=(0,i.I)(),T=(0,l.Z)("/preview/"),N=(0,r.useRef)(),[O,P]=(0,r.useState)(p.cP),[S,_]=(0,r.useState)(!1),[j,I]=(0,r.useState)((()=>(t.find((e=>e.defaultActive))??t[0]).name)),[Z,M]=(0,r.useState)((()=>x(t,j))),[R,A]=(0,r.useState)((()=>E(Z,O))),[F,U]=(0,r.useState)(!1),z=(0,r.useCallback)((()=>{const e=()=>{N.current?.contentWindow?._preview_only_render?_(!0):setTimeout(e,100)};e()}),[]),[D,L]=(0,r.useState)((()=>Object.fromEntries(t.map((e=>[e.name,e.codeSlides?.[0]??e.code]))))),$=(0,u.Z)(D);(0,r.useEffect)((()=>{if(!S)return;const e=N.current?.contentWindow?._preview_only_render;if(!e)return;const{Bricks:t,Context:n,Functions:r,Templates:a,I18N:l,Style:i,templatesAreArrayOfYaml:c}=function(e){const t={},n=[],r=[];for(const[a,l]of Object.entries(e))if(a.startsWith("Functions/")){const[e,t]=a.split("/")[1].split(".");n.push({name:e,source:l,typescript:"ts"===t})}else a.startsWith("tpl-")?r.push({name:a,yaml:l}):"style.css"===a?t.Style=l:t[a]=l;n.length>0&&(t.Functions=n);r.length>0&&(t.Templates=r,t.templatesAreArrayOfYaml=!0);return t}({...o,...$});e("yaml",{yaml:t},{theme:C,context:n,functions:r,templates:a,i18n:l,styleText:i,templatesAreArrayOfYaml:c})}),[S,C,$,o]),(0,r.useEffect)((()=>{if(!S)return;const e=new ResizeObserver((e=>{for(const t of e)P(Math.max(p.cP,t.borderBoxSize?.[0]?.blockSize??t.contentRect.height))}));return e.observe(N.current.contentDocument.body,{box:"border-box"}),()=>{e.disconnect()}}),[S]);const X=(0,r.useCallback)(((e,n)=>{L((t=>({...t,[n]:e})));w(t,n).minLines||M(e.split("\n").length)}),[t]);(0,r.useEffect)((()=>{M(x(t,j))}),[t,j]),(0,r.useEffect)((()=>{A(E(Z,O))}),[Z,O]);const q=(0,r.useCallback)((()=>{const e=!F;(0,a.flushSync)((()=>{U(e)})),e||(k.current?.resetScrollTop(),v.current.scrollIntoViewIfNeeded?v.current.scrollIntoViewIfNeeded():v.current.scrollIntoView({block:"nearest",inline:"nearest"}))}),[F]),H=R>p.qH,B={height:H&&!F?p.qH:Math.max(R,p.lV)};return r.createElement("div",{className:(0,d.Z)(y.example,b,{[y.expandable]:H,[y.condensed]:s}),ref:v},r.createElement("div",{className:y.tabs},t.map((e=>r.createElement("button",{className:(0,d.Z)(y.tab,{[y.active]:e.name===j}),key:e.name,onClick:()=>{I(e.name)}},"Bricks"===e.name?"Storyboard":e.name)))),r.createElement("div",{className:y.editorColumn,style:B},m?r.createElement(g.Z,null):r.createElement(c,{fallback:r.createElement(g.Z,null)},(()=>{const e=n(94981).Z;return r.createElement(e,{files:t,currentFile:j,theme:"dark"===C?"vs-dark":"vs",className:y.editorContainer,typingEffectReady:S,onChange:X,ref:k})}))),r.createElement("div",{className:(0,d.Z)(y.previewColumn,F?y.expanded:y.collapsed),style:{maxHeight:H&&!F?p.qH:"unset",padding:p.$P}},m||r.createElement("div",{className:(0,d.Z)(y.preview,{[y.ready]:S})},r.createElement("iframe",{ref:N,src:T,loading:"lazy",onLoad:z,style:{height:O}})),(m||!S)&&r.createElement(g.Z,null)),H&&r.createElement("button",{className:y.buttonToggleShowMore,role:"button",onClick:q},F?r.createElement(f,null):r.createElement(h,null),r.createElement("span",null,F?"Show less":"Show more")))}function E(e,t){const n=t+2*p.$P,r=e*p.CZ+p.sE+p.z5;return Math.max(n,r)}function w(e,t){return e.find((e=>e.name===t))}function x(e,t){const n=w(e,t);return n.minLines??n.code.split("\n").length}},33788:(e,t,n)=>{n.d(t,{$P:()=>l,CZ:()=>r,cP:()=>a,lV:()=>s,qH:()=>c,sE:()=>i,z5:()=>o});const r=22,a=32,l=20,i=12,o=12,c=16*r+o+i,s=6*r+o+i},55550:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(67294);function a(e,t){void 0===t&&(t=200);const[n,a]=(0,r.useState)(e);return(0,r.useEffect)((()=>{const n=setTimeout((()=>{a(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),n}},19761:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>b,frontMatter:()=>c,metadata:()=>d,toc:()=>p});var r=n(87462),a=(n(67294),n(3905)),l=n(8697);const i=[{name:"Bricks",code:"- brick: sl-input\n  properties:\n    placeholder: Search...\n- brick: div\n  properties:\n    className: tabs\n  children:\n  - brick: :forEach\n    dataSource: <% CTX.tabs %>\n    children:\n    - brick: sl-tab\n      properties:\n        panel: <% ITEM %>\n        textContent: <% _.upperFirst(ITEM) %>\n        active: <%= CTX.activeTab === ITEM %>\n      events:\n        click:\n          action: context.replace\n          args:\n          - activeTab\n          - <% ITEM %>\n- brick: div\n  properties:\n    className: tab-panel\n  children:\n  - brick: :switch\n    dataSource: <%= CTX.activeTab %>\n    slots:\n      basic:\n        bricks:\n        - brick: div\n          properties:\n            textContent: This is the basic settings.\n      advanced:\n        bricks:\n        - brick: div\n          properties:\n            textContent: This is the advanced settings.",highlightRanges:[[16,21],[26,27]]},{name:"Context",code:"- name: tabs\n  value:\n    - basic\n    - advanced\n- name: activeTab\n  value: basic\n  # value: <% PATH.tab ?? 'basic' %>\n  # onChange:\n  #   action: history.push\n  #   args:\n  #   - <% `${APP.homepage}/tabs/${CTX.activeTab}` %>\n  #   - notify: false\n"}],o={"style.css":".tabs {\n  --indicator-color: var(--sl-color-primary-600);\n  --track-color: var(--sl-color-neutral-200);\n  --track-offset: -3px;\n\n  box-shadow: inset 0 var(--track-offset) 0 0 var(--track-color);\n}\n\n.tab-panel {\n  padding: var(--sl-spacing-medium) 0;\n}\n\nsl-tab::part(base) {\n  border-radius: 0;\n}\n\nsl-tab[active]::part(base) {\n  box-shadow: inset 0 var(--track-offset) 0 0 var(--indicator-color);\n}\n"},c={title:"Incremental Rendering"},s=void 0,d={unversionedId:"advanced/incremental-rendering",id:"advanced/incremental-rendering",title:"Incremental Rendering",description:"\u589e\u91cf\u6e32\u67d3\u662f\u6307\u52a8\u6001\u66f4\u65b0\u9875\u9762\u4e2d\u7684\u6307\u5b9a\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u540c\u65f6\u4fdd\u7559\u9875\u9762\u5176\u4ed6\u90e8\u5206\u7684 UI \u53ca\u5176\u72b6\u6001\u3002\u589e\u91cf\u6e32\u67d3\u53ef\u4ee5\u8ba9\u7279\u5b9a\u573a\u666f\u4e0b\u7684 UI \u4ea4\u4e92\u66f4\u52a0\u5e73\u6ed1\u987a\u7545\uff0c\u5e76\u51cf\u5c11\u8d44\u6e90\u7684\u91cd\u590d\u52a0\u8f7d\u3002",source:"@site/docs/advanced/incremental-rendering.mdx",sourceDirName:"advanced",slug:"/advanced/incremental-rendering",permalink:"/docs/advanced/incremental-rendering",draft:!1,tags:[],version:"current",frontMatter:{title:"Incremental Rendering"},sidebar:"docsSidebar",previous:{title:"Media Query",permalink:"/docs/concepts/media-query"}},u={},p=[{value:"\u52a8\u6001\u63a7\u5236\u8282\u70b9",id:"dynamic-control-nodes",level:2},{value:"\u6784\u4ef6\u4e0b\u7684\u5b50\u8def\u7531",id:"sub-routes-in-brick",level:2}],m={toc:p},f="wrapper";function b(e){let{components:t,...n}=e;return(0,a.kt)(f,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u589e\u91cf\u6e32\u67d3\u662f\u6307\u52a8\u6001\u66f4\u65b0\u9875\u9762\u4e2d\u7684\u6307\u5b9a\u7684\u90e8\u5206\u5185\u5bb9\uff0c\u540c\u65f6\u4fdd\u7559\u9875\u9762\u5176\u4ed6\u90e8\u5206\u7684 UI \u53ca\u5176\u72b6\u6001\u3002\u589e\u91cf\u6e32\u67d3\u53ef\u4ee5\u8ba9\u7279\u5b9a\u573a\u666f\u4e0b\u7684 UI \u4ea4\u4e92\u66f4\u52a0\u5e73\u6ed1\u987a\u7545\uff0c\u5e76\u51cf\u5c11\u8d44\u6e90\u7684\u91cd\u590d\u52a0\u8f7d\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\u4e00\u4e2a\u9875\u9762\u901a\u8fc7\u9009\u9879\u5361\u5217\u8868\u6765\u63d0\u4f9b\u8bbf\u95ee\u8d44\u6e90\u5bf9\u8c61\u7684\u4e0d\u540c\u5206\u7c7b\u7684\u4fe1\u606f\uff0c\u4f7f\u7528\u589e\u91cf\u6e32\u67d3\u53ef\u4ee5\u8ba9\u9875\u9762\u5728\u5207\u6362\u9009\u9879\u5361\u65f6\uff0c\u53ea\u9700\u91cd\u65b0\u52a0\u8f7d\u548c\u6e32\u67d3\u9009\u9879\u5361\u7684\u5185\u5bb9\u90e8\u5206\uff0c\u800c\u9009\u9879\u5361\u5916\u90e8\u7684 UI \u53ca\u5176\u72b6\u6001\u90fd\u4f1a\u88ab\u4fdd\u7559\u3002"),(0,a.kt)("p",null,"\u5b9e\u73b0\u589e\u91cf\u6e32\u67d3\u4e3b\u8981\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a",(0,a.kt)("em",{parentName:"p"},"\u52a8\u6001\u63a7\u5236\u8282\u70b9"),"\u3001",(0,a.kt)("em",{parentName:"p"},"\u6784\u4ef6\u4e0b\u7684\u5b50\u8def\u7531"),"\u3002"),(0,a.kt)("h2",{id:"dynamic-control-nodes"},"\u52a8\u6001\u63a7\u5236\u8282\u70b9"),(0,a.kt)("p",null,"\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06\u9875\u9762\u5f53\u524d\u9009\u4e2d\u7684\u9009\u9879\u5361\u8bbe\u7f6e\u5230 context \u4e2d\uff0c\u5e76\u4f7f\u7528\u63a7\u5236\u8282\u70b9 ",(0,a.kt)("inlineCode",{parentName:"p"},":switch")," \u52a8\u6001\u9009\u62e9\u6e32\u67d3\u4e0d\u540c\u7684\u5185\u5bb9\u3002"),(0,a.kt)(l.Z,{files:i,hiddenFiles:o,mdxType:"NextExample"}),(0,a.kt)("p",null,"\u63a7\u5236\u8282\u70b9\u4e2d\u672a\u5339\u914d\u7684\u6784\u4ef6\u4e0d\u4f1a\u88ab\u52a0\u8f7d\uff0c\u56e0\u6b64\u4e0d\u4f1a\u5360\u7528\u7f51\u7edc\u6216\u8ba1\u7b97\u8d44\u6e90\uff0c\u5f53\u5176\u91cd\u65b0\u6e32\u67d3\u65f6\uff0c\u65b0\u5339\u914d\u7684\u6784\u4ef6\u624d\u4f1a\u88ab\u52a0\u8f7d\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u5e0c\u671b\u9009\u9879\u5361\u72b6\u6001\u53ef\u4ee5\u540c\u6b65\u5230 URL \u4e2d\uff0c\u53ef\u4ee5\u7ed1\u5b9a context \u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"onChange")," \u4e8b\u4ef6\uff0c\u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"history.push")," \u5e76\u8bbe\u7f6e\u53c2\u6570 ",(0,a.kt)("inlineCode",{parentName:"p"},"notify: false"),"\uff0c\u4ee5\u4fbf\u66f4\u65b0 URL \u800c\u4e0d\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"- name: activeTab\n  value: <% PATH.tab ?? 'basic' %>\n  onChange:\n    action: history.push\n    args:\n    - <% `${APP.homepage}/tabs/${CTX.activeTab}` %>\n    - notify: false\n")),(0,a.kt)("h2",{id:"sub-routes-in-brick"},"\u6784\u4ef6\u4e0b\u7684\u5b50\u8def\u7531"),(0,a.kt)("p",null,"\u6784\u4ef6\u4e0b\u53ef\u4ee5\u58f0\u660e\u5b50\u8def\u7531\uff0c\u5982\u679c\u9875\u9762\u53d1\u751f\u8df3\u8f6c\u5e76\u4e14\u76ee\u6807\u5730\u5740\u4e0e\u8be5\u5b50\u8def\u7531\u5217\u8868\u4e2d\u7684\u67d0\u4e2a\u8def\u7531\u5339\u914d\uff0c\u5219\u9875\u9762\u4e0d\u4f1a\u53d1\u751f\u6574\u4f53\u91cd\u65b0\u6e32\u67d3\uff0c\u800c\u662f\u4ec5\u589e\u91cf\u6e32\u67d3\u8be5\u5b50\u8def\u7531\u3002\u5176\u6548\u679c\u548c\u4f7f\u7528\u52a8\u6001\u63a7\u5236\u8282\u70b9\u7c7b\u4f3c\uff0c",(0,a.kt)("a",{parentName:"p",href:"https://stackblitz.com/edit/brick-next-sub-routes?file=storyboards%2Fapp-tabs.yml"},"\u67e5\u770b\u5728\u7ebf\u793a\u4f8b"),"\u3002"),(0,a.kt)("admonition",{title:"Important",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"\u8be5\u7279\u6027\u4ecd\u5728\u6d4b\u8bd5\u9636\u6bb5\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b50\u8def\u7531\u8df3\u8f6c\u4f1a\u6574\u4f53\u91cd\u65b0\u6e32\u67d3\uff0c\u53ef\u6309\u9700\u914d\u7f6e\u5e94\u7528\u7ea7\u7279\u6027\u5f00\u5173 ",(0,a.kt)("inlineCode",{parentName:"p"},"incremental-sub-route-rendering")," \u4f53\u9a8c\u8be5\u7279\u6027\u3002"),(0,a.kt)("p",{parentName:"admonition"},"\u9700\u5347\u7ea7 ",(0,a.kt)("inlineCode",{parentName:"p"},"brick_next >= 3.5.19"),"\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"brick: div\nslots:\n  '':\n    type: routes\n    routes:\n    - path: ${APP.homepage}/basic\n      bricks:\n      - brick: div\n        properties:\n          textContent: This is the basic settings.\n    - path: ${APP.homepage}/advanced\n      bricks:\n      - brick: div\n        properties:\n          textContent: This is the advanced settings.\n")))}b.isMDXComponent=!0}}]);