"use strict";(self.webpackChunknext_docs=self.webpackChunknext_docs||[]).push([[3569],{43569:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(67294),r=n(54184),s=n(33788),i=n(86010),c=n(80224),l=n(2243),a=n(91147);const u={slidesActive:"slidesActive_vr0r",cursor:"cursor_RM2z",added:"added_ZxDw",modified:"modified_lx8A"};(0,c.z2)(r),(0,l.z2)(r),(0,a.z2)(r);var d=function(e){return e[e.None=0]="None",e[e.Active=1]="Active",e[e.Finished=2]="Finished",e}(d||{});let f=0;r.languages.typescript.javascriptDefaults.setCompilerOptions({allowNonTsExtensions:!0,lib:[]}),r.languages.typescript.typescriptDefaults.setCompilerOptions({allowNonTsExtensions:!0,lib:[]});const m=(0,o.forwardRef)((function(e,t){let{files:n,currentFile:c,className:l,theme:a,typingEffectReady:m,onChange:g}=e;const y=(0,o.useRef)(),v=(0,o.useRef)(),S=(0,o.useMemo)((()=>new Map),[]),C=(0,o.useMemo)((()=>`${"workspace/"}${++f}`),[]),[w,b]=(0,o.useState)(d.None),E=(0,o.useMemo)((()=>new Set),[]),N=(0,o.useMemo)((()=>{let e=S.get(c);if(!e){const t=n.find((e=>e.name===c));e=r.editor.createModel(t.codeSlides?.[0]??t.code,t.lang??"yaml",r.Uri.file(`${C}/${t.name}`)),S.set(c,e)}return e}),[c,S,n,C]);(0,o.useEffect)((()=>{a&&r.editor.setTheme(a)}),[a]),(0,o.useEffect)((()=>{v.current?v.current.setModel(N):(v.current=r.editor.create(y.current,{model:N,minimap:{enabled:!1},scrollBeyondLastLine:!1,tabSize:2,insertSpaces:!0,automaticLayout:!0,fontSize:13,lineHeight:s.CZ,scrollbar:{horizontalScrollbarSize:s.sE,verticalScrollbarSize:s.sE,horizontalSliderSize:8,verticalSliderSize:8,alwaysConsumeMouseWheel:!1},padding:{top:s.z5},overviewRulerBorder:!1,mouseWheelScrollSensitivity:.5,renderLineHighlight:"none"}),v.current.onKeyDown((e=>{if(e.equals(r.KeyMod.CtrlCmd|r.KeyCode.KeyK)){const t=new KeyboardEvent("keydown",{ctrlKey:e.ctrlKey,metaKey:e.metaKey,key:"k"});document.dispatchEvent(t)}})))}),[N]);const R=(0,o.useRef)();return(0,o.useEffect)((()=>{if(E.has(c))return;const e=n.find((e=>e.name===c));e.highlightRanges&&(v.current?.revealLineNearTop(e.highlightRanges[0][0],r.editor.ScrollType.Immediate),R.current=v.current?.createDecorationsCollection(e.highlightRanges.map((e=>{let[t,n,o]=e;return{range:new r.Range(t,1,n,1),options:{isWholeLine:!0,linesDecorationsClassName:"modified"===o?u.modified:u.added}}}))))}),[E,c,n]),(0,o.useImperativeHandle)(t,(()=>({resetScrollTop:()=>v.current.setScrollTop(0,r.editor.ScrollType.Immediate)})),[]),(0,o.useEffect)((()=>{const e=N.onDidChangeContent((()=>{R.current?.clear(),E.add(c),g?.(N.getValue(),c)}));return()=>{e.dispose()}}),[E,c,N,g]),(0,o.useEffect)((()=>{const e=n.find((e=>e.name===c));if(e.codeSlides&&m){v.current.focus(),b(d.Active);const t=v.current.createDecorationsCollection();(async function(e,t,n){return new Promise((o=>{const s=function(e){return h(e.slice(1).map((e=>h(e.split(""),20))),1e3)}(e);let i=0;const c=function(){const e=s[i],{lineNumber:n,column:a}=p(t),u=new r.Range(n,a,n,a);t.applyEdits([{range:u,text:e}]),l();const d=s[++i];d?(i++,setTimeout(c,d)):setTimeout(o,1e3)},l=function(){const{lineNumber:e,column:o}=p(t);n.set([{range:{startLineNumber:e,startColumn:o,endLineNumber:e,endColumn:o},options:{afterContentClassName:u.cursor}}])};l(),setTimeout(c,2e3)}))})(e.codeSlides,N,t).then((()=>{t.set([]),v.current.setPosition(p(N)),b(d.Finished)}))}}),[c,N,n,m]),(0,o.useEffect)((()=>{switch(w){case d.Active:v.current.updateOptions({readOnly:!0,domReadOnly:!0});break;case d.Finished:v.current.updateOptions({readOnly:!1,domReadOnly:!1})}}),[w]),(0,o.useEffect)((()=>()=>{v.current.dispose();for(const e of S.values())e.dispose()}),[]),o.createElement("div",{ref:y,className:(0,i.Z)(l,{[u.slidesActive]:w===d.Active})})}));function p(e){const t=e.getLineCount();return{lineNumber:t,column:e.getLineLength(t)+1}}function h(e){const t=[];let n=0;for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];for(;n<e.length;){const o=[].concat(e[n]).flat(1/0);t.push(...o),n++,n<e.length&&o.length>0&&t.push(...r)}return t}}}]);