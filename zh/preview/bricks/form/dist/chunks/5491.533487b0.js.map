{"version":3,"file":"chunks/5491.533487b0.js","mappings":"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","sources":["webpack:///../../node_modules/@babel/runtime/helpers/esm/checkPrivateRedeclaration.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classExtractFieldDescriptor.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classApplyDescriptorGet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classApplyDescriptorSet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getBasePath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/historyExtended.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/history.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getV2RuntimeFromDll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Runtime.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomProcessors.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerAppI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/devtools.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/proxyFactories.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/themeAndMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getGeneralGlobals.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/StoryboardFunctionRegistry.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/StoryboardFunctions.js","webpack:///../../node_modules/@ungap/event-target/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mediaQuery.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getStorageItem.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/isStrictMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetFunctions.js","webpack:///../../node_modules/compare-versions/lib/esm/utils.js","webpack:///../../node_modules/compare-versions/lib/esm/compare.js","webpack:///../../node_modules/compare-versions/lib/esm/compareVersions.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/hasInstalledApp.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/getProviderBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/markAsComputed.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveData.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/evaluate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getNextStateOfUseBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealValue.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/checkIf.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getTracks.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setProperties.js","webpack:///../../node_modules/@next-core/runtime/node_modules/path-to-regexp/dist.es2015/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchPath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Dialog.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/poll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/i18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/handleHttpError.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Notification.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/bindListeners.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/DataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveDataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupUseBrickInTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/expandCustomTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/enums.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/expandFormRenderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/getDefaultProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Renderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/listenOnTrackingContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/bindTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mount.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/RendererContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getPageInfo.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/abortController.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerCustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/fulfilStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Router.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/insertPreviewRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/injected.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/auth.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/fetchByProvider.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/createRoot.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/secret_internals.js"],"sourcesContent":["export default function _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}","export default function _classExtractFieldDescriptor(receiver, privateMap, action) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n  }\n  return privateMap.get(receiver);\n}","import classApplyDescriptorGet from \"./classApplyDescriptorGet.js\";\nimport classExtractFieldDescriptor from \"./classExtractFieldDescriptor.js\";\nexport default function _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = classExtractFieldDescriptor(receiver, privateMap, \"get\");\n  return classApplyDescriptorGet(receiver, descriptor);\n}","export default function _classApplyDescriptorGet(receiver, descriptor) {\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n  return descriptor.value;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateFieldInitSpec(obj, privateMap, value) {\n  checkPrivateRedeclaration(obj, privateMap);\n  privateMap.set(obj, value);\n}","import classApplyDescriptorSet from \"./classApplyDescriptorSet.js\";\nimport classExtractFieldDescriptor from \"./classExtractFieldDescriptor.js\";\nexport default function _classPrivateFieldSet(receiver, privateMap, value) {\n  var descriptor = classExtractFieldDescriptor(receiver, privateMap, \"set\");\n  classApplyDescriptorSet(receiver, descriptor, value);\n  return value;\n}","export default function _classApplyDescriptorSet(receiver, descriptor, value) {\n  if (descriptor.set) {\n    descriptor.set.call(receiver, value);\n  } else {\n    if (!descriptor.writable) {\n      throw new TypeError(\"attempted to set read only private field\");\n    }\n    descriptor.value = value;\n  }\n}","export default function _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n  return fn;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateMethodInitSpec(obj, privateSet) {\n  checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nexport default function _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","/**\n * Get site's base path, generally will be `/next/` or `/`.\n */\nexport function getBasePath() {\n  var base = document.querySelector(\"base\");\n  var basePath = base ? base.getAttribute(\"href\") : \"/\";\n  return basePath;\n}\n//# sourceMappingURL=getBasePath.js.map","import { orderBy } from \"lodash\";\nimport { getRuntime } from \"./Runtime.js\";\nexport function matchStoryboard(storyboards, pathname) {\n  // Put apps with longer homepage before shorter ones.\n  // E.g., `/legacy/tool` will match first before `/legacy`.\n  // This enables two apps with relationship of parent-child of homepage.\n  var sortedStoryboards = orderBy(storyboards, storyboard => {\n    var _storyboard$app$homep, _storyboard$app$homep2;\n    return (_storyboard$app$homep = (_storyboard$app$homep2 = storyboard.app.homepage) === null || _storyboard$app$homep2 === void 0 ? void 0 : _storyboard$app$homep2.length) !== null && _storyboard$app$homep !== void 0 ? _storyboard$app$homep : 0;\n  }, \"desc\");\n  for (var storyboard of sortedStoryboards) {\n    var homepage = storyboard.app.homepage;\n    if (typeof homepage === \"string\" && homepage[0] === \"/\") {\n      if (matchHomepage(homepage, pathname)) {\n        return storyboard;\n      }\n    }\n  }\n}\nexport function matchHomepage(homepage, pathname) {\n  return homepage === \"/\" ? pathname === homepage : \"\".concat(pathname.replace(/\\/+$/, \"\"), \"/\").startsWith(\"\".concat(homepage.replace(/\\/+$/, \"\"), \"/\"));\n}\n\n// istanbul ignore next\n/**\n * We say it's an outside app when at least one of the below conditions are true:\n *   - target app is not found.\n *   - target app is not the current app.\n *   - current app is non-standalone mode and target app is standalone mode.\n *\n * Note: when current app is standalone mode, other apps will not be found.\n */\nexport function isOutsideApp(storyboard) {\n  var _getRuntime$getCurren;\n  if (process.env.NODE_ENV === \"test\") {\n    return false;\n  }\n  return !storyboard ||\n  // Sometimes `storyboard.app.standaloneMode` is incorrect.\n  ((_getRuntime$getCurren = getRuntime().getCurrentApp()) === null || _getRuntime$getCurren === void 0 ? void 0 : _getRuntime$getCurren.id) !== storyboard.app.id && !window.STANDALONE_MICRO_APPS && storyboard.app.standaloneMode;\n}\n//# sourceMappingURL=matchStoryboard.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"extraQuery\", \"clear\", \"keepHash\"];\nimport { parsePath } from \"history\";\nimport { getBasePath } from \"../getBasePath.js\";\nimport { _internalApiMatchStoryboard } from \"./Runtime.js\";\nimport { isOutsideApp } from \"./matchStoryboard.js\";\nvar blocked = false;\nexport function getUserConfirmation(message, callback) {\n  blocked = !confirm(message);\n  callback(!blocked);\n}\nexport function historyExtended(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function push(location, state, callback) {\n    blocked = false;\n    originalPush(location, state);\n    callback === null || callback === void 0 || callback(blocked);\n  }\n  function replace(location, state, callback) {\n    blocked = false;\n    originalReplace(location, state);\n    callback === null || callback === void 0 || callback(blocked);\n  }\n  function updateQueryFactory(method) {\n    return function updateQuery(query) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var {\n          extraQuery,\n          clear,\n          keepHash\n        } = options,\n        state = _objectWithoutProperties(options, _excluded);\n      var urlSearchParams = new URLSearchParams(clear ? \"\" : browserHistory.location.search);\n      var params = {};\n      Object.assign(params, query, extraQuery);\n      for (var [key, value] of Object.entries(params)) {\n        if (Array.isArray(value)) {\n          urlSearchParams.delete(key);\n          for (var item of value) {\n            urlSearchParams.append(key, item);\n          }\n        } else if (value === undefined || value === null || value === \"\") {\n          urlSearchParams.delete(key);\n        } else {\n          urlSearchParams.set(key, value);\n        }\n      }\n      (method === \"push\" ? push : replace)(\"?\".concat(urlSearchParams.toString()).concat(keepHash ? browserHistory.location.hash : \"\"), state, callback);\n    };\n  }\n  function pushAnchor(hash, state, callback) {\n    push(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      key: undefined,\n      hash,\n      state: _objectSpread({\n        // The default notify is false\n        notify: false\n      }, state)\n    }), undefined, callback);\n  }\n  function reload(callback) {\n    replace(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      state: _objectSpread(_objectSpread({}, browserHistory.location.state), {}, {\n        // Always notify\n        notify: true\n      })\n    }), undefined, callback);\n  }\n  var blockMessage;\n  function setBlockMessage(message) {\n    blockMessage = message;\n  }\n  function getBlockMessage() {\n    return blockMessage;\n  }\n  function unblock() {\n    blockMessage = undefined;\n  }\n  return _objectSpread({\n    pushQuery: updateQueryFactory(\"push\"),\n    replaceQuery: updateQueryFactory(\"replace\"),\n    pushAnchor: pushAnchor,\n    reload,\n    setBlockMessage,\n    getBlockMessage,\n    unblock\n  }, historyOverridden(_objectSpread(_objectSpread({}, browserHistory), {}, {\n    push,\n    replace\n  })));\n}\n\n/**\n * Override history for standalone micro apps.\n *\n * when `push` or `replace` to other apps, force page refresh.\n */\nfunction historyOverridden(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function updateFactory(method) {\n    return function update(path, state, callback) {\n      var pathname;\n      var pathIsString = typeof path === \"string\";\n      if (pathIsString) {\n        pathname = parsePath(path).pathname;\n      } else {\n        pathname = path.pathname;\n      }\n\n      // When history.push or history.replace is performing with an absolute pathname,\n      // force load the target page when it is a page of an outside app.\n      if (typeof pathname === \"string\" && pathname.startsWith(\"/\") && isOutsideApp(_internalApiMatchStoryboard(pathname))) {\n        // Going to outside apps.\n        return location[method === \"push\" ? \"assign\" : \"replace\"](pathIsString ? getBasePath() + path.substring(1) : browserHistory.createHref(path));\n      }\n      return (method === \"push\" ? originalPush : originalReplace)(path, state, callback);\n    };\n  }\n  return {\n    push: updateFactory(\"push\"),\n    replace: updateFactory(\"replace\")\n  };\n}\n\n/**\n * 扩展的系统会话对象。\n */\n\n/**\n * 更新指定的 query 参数。\n *\n * @param query - 要更新的 query 参数。\n * @param options - 选项。\n */\n\n/** 更新 query 参数时的选项 */\n\n/**\n * 设置指定的 anchor （URL hash）地址，此方法默认不会触发页面重新渲染。\n * 往浏览器会话历史栈中推入一条新记录。\n *\n * @param hash - Hash 地址。\n * @param state - 会话状态设置。\n */\n//# sourceMappingURL=historyExtended.js.map","import { createBrowserHistory } from \"history\";\nimport { getBasePath } from \"./getBasePath.js\";\nimport { getUserConfirmation, historyExtended } from \"./internal/historyExtended.js\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\nvar history;\nexport function createHistory() {\n  if (!history) {\n    // https://github.com/remix-run/history/issues/810\n    var browserHistory = createBrowserHistory({\n      basename: getBasePath().replace(/\\/$/, \"\"),\n      getUserConfirmation\n    });\n    Object.assign(browserHistory, historyExtended(browserHistory));\n    history = browserHistory;\n  }\n  return history;\n}\nfunction getHistoryV3() {\n  return history;\n}\n\n/**\n * When using v3 bricks in v2 container, return history from v2 container.\n */\nfunction getHistoryV2Factory() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return v2Kit.getHistory;\n  }\n}\nexport var getHistory = getHistoryV2Factory() || getHistoryV3;\n//# sourceMappingURL=history.js.map","export function getV2RuntimeFromDll() {\n  var _window$BRICK_NEXT_VE;\n  var {\n    dll\n  } = window;\n  if (dll && (_window$BRICK_NEXT_VE = window.BRICK_NEXT_VERSIONS) !== null && _window$BRICK_NEXT_VE !== void 0 && (_window$BRICK_NEXT_VE = _window$BRICK_NEXT_VE[\"brick-container\"]) !== null && _window$BRICK_NEXT_VE !== void 0 && _window$BRICK_NEXT_VE.startsWith(\"2.\")) {\n    return dll(\"tYg3\");\n  }\n}\n//# sourceMappingURL=getV2RuntimeFromDll.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { i18n, initializeI18n } from \"@next-core/i18n\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { deepFreeze, isObject } from \"@next-core/utils/general\";\nimport moment from \"moment\";\nimport \"moment/locale/zh-cn.js\";\nimport { createHistory } from \"../history.js\";\nimport { matchStoryboard } from \"./matchStoryboard.js\";\nimport { Router } from \"./Router.js\";\nimport { NS, locales } from \"./i18n.js\";\nimport { loadNotificationService } from \"../Notification.js\";\nimport { loadDialogService } from \"../Dialog.js\";\nimport { injectedBrickPackages } from \"./injected.js\";\nimport { hasInstalledApp } from \"./hasInstalledApp.js\";\nimport { listenDevtoolsEagerly } from \"./devtools.js\";\nimport { getV2RuntimeFromDll } from \"../getV2RuntimeFromDll.js\";\nvar runtime;\n\n// Allow inject bootstrap data in a runtime other than Brick Next.\nvar bootstrapData;\nvar router;\nexport var hooks;\nexport function createRuntime(options) {\n  if (runtime) {\n    throw new Error(\"Cannot create multiple runtimes\");\n  }\n  listenDevtoolsEagerly();\n  hooks = options === null || options === void 0 ? void 0 : options.hooks;\n  initializeI18n(NS, locales);\n  moment.locale(i18n.language);\n  i18n.on(\"languageChanged\", () => {\n    moment.locale(i18n.language);\n  });\n  createHistory();\n  runtime = new Runtime();\n  return runtime;\n}\nfunction getRuntimeV3() {\n  return runtime;\n}\n\n// istanbul ignore next\nfunction getRuntimeV2Factory() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function getRuntimeV2() {\n      return new Proxy(v2Kit.getRuntime(), {\n        get() {\n          var key = arguments.length <= 1 ? undefined : arguments[1];\n          switch (key) {\n            case \"getCurrentApp\":\n            case \"getRecentApps\":\n            case \"hasInstalledApp\":\n            case \"getDesktops\":\n            case \"getLaunchpadSettings\":\n            case \"getLaunchpadSiteMap\":\n            case \"toggleLaunchpadEffect\":\n            case \"applyPageTitle\":\n            case \"getNavConfig\":\n            case \"getFeatureFlags\":\n            case \"getMiscSettings\":\n            case \"getBrandSettings\":\n              return Reflect.get(...arguments);\n          }\n        }\n      });\n    };\n  }\n}\n\n// istanbul ignore next\nexport var getRuntime = getRuntimeV2Factory() || getRuntimeV3;\nvar _initialized = /*#__PURE__*/new WeakMap();\nvar _bootstrapped = /*#__PURE__*/new WeakMap();\nexport class Runtime {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _initialized, {\n      writable: true,\n      value: false\n    });\n    _classPrivateFieldInitSpec(this, _bootstrapped, {\n      writable: true,\n      value: false\n    });\n  }\n  initialize(data) {\n    var _data$settings$preset, _data$settings;\n    if (_classPrivateFieldGet(this, _initialized)) {\n      throw new Error(\"The runtime cannot be initialized more than once\");\n    }\n    _classPrivateFieldSet(this, _initialized, true);\n    normalizeBootstrapData(data);\n    bootstrapData = data;\n    var {\n      notification,\n      dialog\n    } = (_data$settings$preset = (_data$settings = data.settings) === null || _data$settings === void 0 ? void 0 : _data$settings.presetBricks) !== null && _data$settings$preset !== void 0 ? _data$settings$preset : {};\n    if (notification !== false) {\n      loadNotificationService(notification !== null && notification !== void 0 ? notification : \"basic.show-notification\", this.loadBricks);\n    }\n    if (dialog !== false) {\n      loadDialogService(dialog !== null && dialog !== void 0 ? dialog : \"basic.show-dialog\", this.loadBricks);\n    }\n  }\n  bootstrap(data) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (data) {\n        _this.initialize(data);\n      }\n      if (_classPrivateFieldGet(_this, _bootstrapped)) {\n        throw new Error(\"The runtime cannot be bootstrapped more than once\");\n      }\n      _classPrivateFieldSet(_this, _bootstrapped, true);\n      router = new Router(bootstrapData.storyboards);\n      yield router.bootstrap();\n    })();\n  }\n  getRecentApps() {\n    var _router$getRecentApps, _router;\n    return (_router$getRecentApps = (_router = router) === null || _router === void 0 ? void 0 : _router.getRecentApps()) !== null && _router$getRecentApps !== void 0 ? _router$getRecentApps : {};\n  }\n  getCurrentApp() {\n    var _router2;\n    return (_router2 = router) === null || _router2 === void 0 ? void 0 : _router2.getRecentApps().currentApp;\n  }\n  hasInstalledApp(appId, matchVersion) {\n    return hasInstalledApp(appId, matchVersion);\n  }\n  getFeatureFlags() {\n    var _bootstrapData, _router3;\n    return _objectSpread(_objectSpread(_objectSpread({}, (_bootstrapData = bootstrapData) === null || _bootstrapData === void 0 || (_bootstrapData = _bootstrapData.settings) === null || _bootstrapData === void 0 ? void 0 : _bootstrapData.featureFlags), (_router3 = router) === null || _router3 === void 0 || (_router3 = _router3.getRecentApps().currentApp) === null || _router3 === void 0 || (_router3 = _router3.config) === null || _router3 === void 0 || (_router3 = _router3.settings) === null || _router3 === void 0 ? void 0 : _router3.featureFlags), {}, {\n      \"migrate-to-brick-next-v3\": true\n    });\n  }\n  getMiscSettings() {\n    var _bootstrapData2, _router4;\n    return _objectSpread(_objectSpread({}, (_bootstrapData2 = bootstrapData) === null || _bootstrapData2 === void 0 || (_bootstrapData2 = _bootstrapData2.settings) === null || _bootstrapData2 === void 0 ? void 0 : _bootstrapData2.misc), (_router4 = router) === null || _router4 === void 0 || (_router4 = _router4.getRecentApps().currentApp) === null || _router4 === void 0 || (_router4 = _router4.config) === null || _router4 === void 0 || (_router4 = _router4.settings) === null || _router4 === void 0 ? void 0 : _router4.misc);\n  }\n  getBrandSettings() {\n    var _bootstrapData3;\n    return _objectSpread({\n      base_title: \"DevOps 管理专家\"\n    }, (_bootstrapData3 = bootstrapData) === null || _bootstrapData3 === void 0 || (_bootstrapData3 = _bootstrapData3.settings) === null || _bootstrapData3 === void 0 ? void 0 : _bootstrapData3.brand);\n  }\n  getLaunchpadSettings() {\n    var _bootstrapData4;\n    return _objectSpread({\n      columns: 7,\n      rows: 4\n    }, (_bootstrapData4 = bootstrapData) === null || _bootstrapData4 === void 0 || (_bootstrapData4 = _bootstrapData4.settings) === null || _bootstrapData4 === void 0 ? void 0 : _bootstrapData4.launchpad);\n  }\n  getDesktops() {\n    var _bootstrapData$deskto, _bootstrapData5;\n    return (_bootstrapData$deskto = (_bootstrapData5 = bootstrapData) === null || _bootstrapData5 === void 0 ? void 0 : _bootstrapData5.desktops) !== null && _bootstrapData$deskto !== void 0 ? _bootstrapData$deskto : [];\n  }\n  getLaunchpadSiteMap() {\n    var _bootstrapData$siteSo, _bootstrapData6;\n    return (_bootstrapData$siteSo = (_bootstrapData6 = bootstrapData) === null || _bootstrapData6 === void 0 ? void 0 : _bootstrapData6.siteSort) !== null && _bootstrapData$siteSo !== void 0 ? _bootstrapData$siteSo : [];\n  }\n  toggleLaunchpadEffect(open) {\n    document.body.classList.toggle(\"launchpad-open\", open);\n  }\n  applyPageTitle(pageTitle) {\n    var baseTitle = this.getBrandSettings().base_title;\n    document.title = pageTitle ? \"\".concat(pageTitle, \" - \").concat(baseTitle) : baseTitle;\n  }\n  getNavConfig() {\n    var _router5;\n    return (_router5 = router) === null || _router5 === void 0 ? void 0 : _router5.getNavConfig();\n  }\n  loadBricks(bricks) {\n    return loadBricksImperatively(bricks, getBrickPackages());\n  }\n}\nfunction normalizeBootstrapData(data) {\n  if (Array.isArray(data.storyboards)) {\n    var _loop = function () {\n      if (app.locales) {\n        // Prefix to avoid conflict between brick package's i18n namespace.\n        var ns = \"tmp/\".concat(app.id);\n        // Support any languages in `app.locales`.\n        Object.entries(app.locales).forEach(_ref => {\n          var [lang, resources] = _ref;\n          i18n.addResourceBundle(lang, ns, resources);\n        });\n        // Use `app.name` as the fallback `app.localeName`.\n        app.localeName = i18n.getFixedT(null, ns)(\"name\", app.name);\n        // Remove the temporary i18n resource bundles.\n        Object.keys(app.locales).forEach(lang => {\n          i18n.removeResourceBundle(lang, ns);\n        });\n      } else {\n        app.localeName = app.name;\n      }\n    };\n    for (var {\n      app\n    } of data.storyboards) {\n      _loop();\n    }\n  }\n  if (isObject(data.settings)) {\n    deepFreeze(data.settings);\n  }\n  if (data.brickPackages) {\n    deepFreeze(data.brickPackages);\n  }\n}\nexport function getBrickPackages() {\n  var _ref2, _ref3, _bootstrapData$brickP, _bootstrapData7;\n  return (_ref2 = (_ref3 = (_bootstrapData$brickP = (_bootstrapData7 = bootstrapData) === null || _bootstrapData7 === void 0 ? void 0 : _bootstrapData7.brickPackages) !== null && _bootstrapData$brickP !== void 0 ? _bootstrapData$brickP : injectedBrickPackages) !== null && _ref3 !== void 0 ? _ref3 : window.STANDALONE_BRICK_PACKAGES) !== null && _ref2 !== void 0 ? _ref2 : [];\n}\nexport function _internalApiGetRenderId() {\n  var _router6;\n  return (_router6 = router) === null || _router6 === void 0 ? void 0 : _router6.getRenderId();\n}\nexport function _internalApiMatchStoryboard(pathname) {\n  var _bootstrapData$storyb, _bootstrapData8;\n  return matchStoryboard((_bootstrapData$storyb = (_bootstrapData8 = bootstrapData) === null || _bootstrapData8 === void 0 ? void 0 : _bootstrapData8.storyboards) !== null && _bootstrapData$storyb !== void 0 ? _bootstrapData$storyb : [], pathname);\n}\nexport function _internalApiGetRuntimeContext() {\n  var _router7;\n  return (_router7 = router) === null || _router7 === void 0 ? void 0 : _router7.getRuntimeContext();\n}\nexport function _internalApiGetStoryboardInBootstrapData(appId) {\n  var _bootstrapData9;\n  return (_bootstrapData9 = bootstrapData) === null || _bootstrapData9 === void 0 || (_bootstrapData9 = _bootstrapData9.storyboards) === null || _bootstrapData9 === void 0 ? void 0 : _bootstrapData9.find(storyboard => storyboard.app.id === appId);\n}\nexport function _internalApiGetAppInBootstrapData(appId) {\n  var _internalApiGetStoryb;\n  return (_internalApiGetStoryb = _internalApiGetStoryboardInBootstrapData(appId)) === null || _internalApiGetStoryb === void 0 ? void 0 : _internalApiGetStoryb.app;\n}\nexport var _test_only_setBootstrapData;\n\n// istanbul ignore next\nif (process.env.NODE_ENV === \"test\") {\n  _test_only_setBootstrapData = data => {\n    bootstrapData = data;\n  };\n}\n//# sourceMappingURL=Runtime.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomProcessorRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(processorFullName, processorFunc) {\n    // `namespace` should be the camelCase of the package name.\n    var [namespace, processorName] = processorFullName.split(\".\");\n    var pkg = _classPrivateFieldGet(this, _registry).get(namespace);\n    if (!pkg) {\n      pkg = new Map();\n      _classPrivateFieldGet(this, _registry).set(namespace, pkg);\n    }\n    if (pkg.has(processorName)) {\n      // eslint-disable-next-line no-console\n      throw new Error(\"Custom processor of \\\"\".concat(processorFullName, \"\\\" already registered\"));\n    }\n    pkg.set(processorName, processorFunc);\n  }\n  get(namespace) {\n    return _classPrivateFieldGet(this, _registry).get(namespace);\n  }\n}\n\n// istanbul ignore next\nfunction getCustomProcessorsV2() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return Object.freeze({\n      define(processorFullName, processorFunc) {\n        return v2Kit.getRuntime().registerCustomProcessor(processorFullName, processorFunc);\n      }\n    });\n  }\n}\n\n// istanbul ignore next\nexport var customProcessors = getCustomProcessorsV2() || new CustomProcessorRegistry();\n//# sourceMappingURL=CustomProcessors.js.map","import { i18n } from \"@next-core/i18n\";\nexport function registerAppI18n(_ref) {\n  var {\n    app,\n    meta\n  } = _ref;\n  if (meta !== null && meta !== void 0 && meta.i18n) {\n    // Prefix to avoid conflict between brick package's i18n namespace.\n    var i18nNamespace = getI18nNamespace(\"app\", app.id);\n    // Support any language in `meta.i18n`.\n    var languages = [];\n    Object.entries(meta.i18n).forEach(_ref2 => {\n      var [lang, resources] = _ref2;\n      i18n.addResourceBundle(lang, i18nNamespace, resources);\n      languages.push(lang);\n    });\n    return () => {\n      for (var lang of languages) {\n        i18n.removeResourceBundle(lang, i18nNamespace);\n      }\n    };\n  }\n}\nexport function getI18nNamespace(type, id) {\n  return \"\".concat(type, \"/\").concat(id);\n}\n//# sourceMappingURL=registerAppI18n.js.map","import { i18n } from \"@next-core/i18n\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\nfunction registerWidgetI18nV3(widgetId, i18nData) {\n  var ns = getI18nNamespace(\"widget\", widgetId);\n  Object.entries(i18nData).forEach(_ref => {\n    var [lang, resources] = _ref;\n    i18n.addResourceBundle(lang, ns, resources);\n  });\n}\nexport function widgetI18nFactory(widgetId) {\n  return i18n.getFixedT(null, getI18nNamespace(\"widget\", widgetId));\n}\n\n// istanbul ignore next\nfunction registerWidgetI18nV2Factory() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function (widgetId, i18nData) {\n      return v2Kit.getRuntime().registerWidgetI18n(widgetId, i18nData);\n    };\n  }\n}\n\n// istanbul ignore next\nexport var registerWidgetI18n = registerWidgetI18nV2Factory() || registerWidgetI18nV3;\n//# sourceMappingURL=WidgetI18n.js.map","export var MESSAGE_SOURCE_PANEL = \"brick-next-devtools-panel\";\nexport var FRAME_ACTIVE_CHANGE = \"devtools-frame-active-change\";\nexport var PANEL_CHANGE = \"devtools-panel-change\";\nvar frameIsActive = true;\nvar selectedPanel;\nexport function devtoolsHookEmit(type, payload) {\n  var devtools = getDevHook();\n  if (!devtools || type === \"evaluation\" && !(frameIsActive && (!selectedPanel || selectedPanel === \"Evaluations\"))) {\n    // Ignore messages if current devtools panel is not relevant.\n    return;\n  }\n  var emit = () => {\n    var _devtools$emit;\n    (_devtools$emit = devtools.emit) === null || _devtools$emit === void 0 || _devtools$emit.call(devtools, {\n      type,\n      payload\n    });\n  };\n\n  // Try to emit only in idle time.\n  // istanbul ignore next\n  if (typeof window.requestIdleCallback === \"function\") {\n    window.requestIdleCallback(emit);\n  } else {\n    setTimeout(emit, 0);\n  }\n}\nexport function listenDevtoolsEagerly() {\n  window.addEventListener(\"message\", _ref => {\n    var {\n      data\n    } = _ref;\n    if ((data === null || data === void 0 ? void 0 : data.source) !== MESSAGE_SOURCE_PANEL) {\n      return;\n    }\n    var payload = data.payload;\n    switch (payload === null || payload === void 0 ? void 0 : payload.type) {\n      case FRAME_ACTIVE_CHANGE:\n        {\n          frameIsActive = payload.active;\n          break;\n        }\n      case PANEL_CHANGE:\n        {\n          selectedPanel = payload.panel;\n          break;\n        }\n    }\n  });\n}\nexport function getDevHook() {\n  return window.__BRICK_NEXT_DEVTOOLS_HOOK__;\n}\n//# sourceMappingURL=devtools.js.map","import { getDevHook } from \"./devtools.js\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar THROW = () => {\n  throw new Error(\"Can't modify read-only proxy object\");\n};\nvar readOnlyHandler = {\n  set: THROW,\n  defineProperty: THROW,\n  deleteProperty: THROW,\n  setPrototypeOf: THROW\n};\nexport function getReadOnlyProxy(object) {\n  return new Proxy(object, readOnlyHandler);\n}\n\n// First, we want to make accessing property of globals lazy,\n// So we use *Proxy* to make a dynamic accessor for each of these globals.\n// But we also want to keep them working in devtools.\nexport function getDynamicReadOnlyProxy(_ref) {\n  var {\n    get,\n    ownKeys\n  } = _ref;\n  if (getDevHook()) {\n    // In devtools, we extract them at beginning.\n    var target = Object.fromEntries(ownKeys(null).map(key => [key, get(null, key, null)]));\n    return getReadOnlyProxy(target);\n  }\n  return new Proxy(Object.freeze({}), {\n    get\n  });\n}\n//# sourceMappingURL=proxyFactories.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { JsonStorage } from \"@next-core/utils/general\";\n// Themes.\nvar theme = \"light\";\nvar storage = new JsonStorage(localStorage);\nvar LOCAL_STORAGE_APPS_THEME_KEY = \"apps-theme\";\nexport function setTheme(value) {\n  if (value !== \"dark\" && value !== \"light\" && value !== \"dark-v2\") {\n    throw new Error(\"Unsupported theme: \".concat(value));\n  }\n  theme = value;\n}\nexport function getTheme() {\n  return theme;\n}\nexport function getCurrentTheme() {\n  return document.documentElement.dataset.theme;\n}\nexport function applyTheme(value) {\n  if (value) {\n    setTheme(value);\n  } else {\n    value = getTheme();\n  }\n  if (value !== getCurrentTheme()) {\n    document.documentElement.dataset.theme = value;\n    window.dispatchEvent(new CustomEvent(\"theme.change\", {\n      detail: value\n    }));\n  }\n}\nexport function batchSetAppsLocalTheme(appsTheme) {\n  storage.setItem(LOCAL_STORAGE_APPS_THEME_KEY, _objectSpread(_objectSpread({}, getLocalAppsTheme()), appsTheme));\n}\nexport function getLocalAppsTheme() {\n  var _result;\n  var result;\n  try {\n    result = storage.getItem(LOCAL_STORAGE_APPS_THEME_KEY);\n  } catch (_unused) {\n    // eslint-disable-next-line no-console\n    console.error(\"JSON parse error inside `getLocalAppsTheme()`\");\n  }\n  return (_result = result) !== null && _result !== void 0 ? _result : {};\n}\n\n// Modes.\nvar mode = \"default\";\nexport function setMode(value) {\n  if (value !== \"dashboard\" && value !== \"default\") {\n    throw new Error(\"Unsupported mode: \".concat(value));\n  }\n  mode = value;\n}\nexport function getMode() {\n  return mode;\n}\nexport function getCurrentMode() {\n  return document.documentElement.dataset.mode;\n}\nexport function applyMode(value) {\n  if (value) {\n    setMode(value);\n  } else {\n    value = getMode();\n  }\n  if (value !== getCurrentMode()) {\n    document.documentElement.dataset.mode = value;\n    window.dispatchEvent(new CustomEvent(\"mode.change\", {\n      detail: value\n    }));\n  }\n}\nexport function getCssPropertyValue(name) {\n  var _window$getComputedSt;\n  var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.documentElement;\n  if (!el) return \"\";\n  return ((_window$getComputedSt = window.getComputedStyle(el)) === null || _window$getComputedSt === void 0 ? void 0 : _window$getComputedSt.getPropertyValue(name)) || \"\";\n}\n//# sourceMappingURL=themeAndMode.js.map","import { identity } from \"lodash\";\nimport { i18n, i18nText } from \"@next-core/i18n\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getTheme } from \"../../themeAndMode.js\";\nimport { getBasePath } from \"../../getBasePath.js\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { hooks } from \"../Runtime.js\";\n// `GeneralGlobals` are globals which are page-state-agnostic,\n// thus they can be used both in storyboard expressions and functions.\nexport function getGeneralGlobals(attemptToVisitGlobals, options) {\n  var globalVariables = {};\n  for (var variableName of attemptToVisitGlobals) {\n    var variable = getIndividualGlobal(variableName, options);\n    if (variable !== undefined) {\n      globalVariables[variableName] = variable;\n    }\n  }\n  return globalVariables;\n}\nfunction getIndividualGlobal(variableName, _ref) {\n  var _hooks$images, _hooks$images2, _hooks$checkPermissio;\n  var {\n    collectCoverage,\n    widgetId,\n    widgetVersion,\n    app,\n    appendI18nNamespace,\n    storyboardFunctions,\n    isStoryboardFunction\n  } = _ref;\n  switch (variableName) {\n    case \"BASE_URL\":\n      return collectCoverage ? \"/next\" : getBasePath().replace(/\\/$/, \"\");\n    case \"FN\":\n      return storyboardFunctions;\n    case \"IMG\":\n      return collectCoverage ? fakeImageFactory() : widgetId ? hooks === null || hooks === void 0 || (_hooks$images = hooks.images) === null || _hooks$images === void 0 ? void 0 : _hooks$images.widgetImagesFactory(widgetId, widgetVersion) : hooks === null || hooks === void 0 || (_hooks$images2 = hooks.images) === null || _hooks$images2 === void 0 ? void 0 : _hooks$images2.imagesFactory(app.id, app.isBuildPush, app.currentVersion);\n    case \"I18N\":\n      return collectCoverage ? identity : widgetId ? widgetI18nFactory(widgetId) : i18n.getFixedT(null, [appendI18nNamespace, getI18nNamespace(\"app\", app.id)].filter(Boolean));\n    case \"I18N_TEXT\":\n      return collectCoverage ? fakeI18nText : i18nText;\n    case \"PERMISSIONS\":\n      return getReadOnlyProxy({\n        check: collectCoverage ? fakeCheckPermissions : hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.checkPermissions\n      });\n    case \"THEME\":\n      return getReadOnlyProxy({\n        getTheme: collectCoverage ? () => \"light\" : getTheme\n        // getCssPropertyValue: collectCoverage ? () => \"\" : getCssPropertyValue,\n      });\n\n    case \"console\":\n      return isStoryboardFunction ? getReadOnlyProxy(console) : undefined;\n    case \"location\":\n      return collectCoverage ? {\n        href: \"http://localhost:3000/functions/test\",\n        origin: \"http://localhost:3000\",\n        host: \"localhost:3000\",\n        hostname: \"localhost\"\n      } : {\n        href: location.href,\n        origin: location.origin,\n        host: location.host,\n        hostname: location.hostname\n      };\n  }\n}\nfunction fakeI18nText(data) {\n  return data === null || data === void 0 ? void 0 : data.en;\n}\nfunction fakeImageFactory() {\n  return {\n    get(name) {\n      return \"mock/images/\".concat(name);\n    }\n  };\n}\nfunction fakeCheckPermissions() {\n  return true;\n}\n//# sourceMappingURL=getGeneralGlobals.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { cook, precookFunction } from \"@next-core/cook\";\nimport { supply } from \"@next-core/supply\";\nimport { collectMemberUsageInFunction } from \"@next-core/utils/storyboard\";\nimport { getGeneralGlobals } from \"./internal/compute/getGeneralGlobals.js\";\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\nexport function StoryboardFunctionRegistryFactory() {\n  var {\n    widgetId,\n    widgetVersion,\n    collectCoverage\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var registeredFunctions = new Map();\n\n  // Use `Proxy` with a frozen target, to make a readonly function registry.\n  var storyboardFunctions = new Proxy(Object.freeze({}), {\n    get(target, key) {\n      return getStoryboardFunction(key);\n    }\n  });\n  var currentApp;\n  function registerStoryboardFunctions(functions, app) {\n    if (app) {\n      currentApp = app;\n    }\n    registeredFunctions.clear();\n    if (Array.isArray(functions)) {\n      for (var fn of functions) {\n        var deps = collectMemberUsageInFunction(fn, \"FN\", !!collectCoverage);\n        var hasPermissionsCheck = collectMemberUsageInFunction(fn, \"PERMISSIONS\", !!collectCoverage).has(\"check\");\n        registeredFunctions.set(fn.name, {\n          source: fn.source,\n          typescript: fn.typescript,\n          deps,\n          hasPermissionsCheck\n        });\n      }\n    }\n  }\n  function getStoryboardFunction(name) {\n    var fn = registeredFunctions.get(name);\n    if (!fn) {\n      return undefined;\n    }\n    if (fn.processed) {\n      return fn.cooked;\n    }\n    var collector;\n    if (collectCoverage) {\n      collector = collectCoverage.createCollector(name);\n    }\n    var precooked = precookFunction(fn.source, {\n      typescript: fn.typescript,\n      hooks: collector && {\n        beforeVisit: collector.beforeVisit\n      }\n    });\n    fn.cooked = cook(precooked.function, fn.source, {\n      rules: {\n        noVar: true\n      },\n      globalVariables: supply(precooked.attemptToVisitGlobals, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        collectCoverage,\n        widgetId,\n        widgetVersion,\n        app: currentApp,\n        storyboardFunctions,\n        isStoryboardFunction: true\n      }), !!collectCoverage),\n      hooks: collector && {\n        beforeEvaluate: collector.beforeEvaluate,\n        beforeCall: collector.beforeCall,\n        beforeBranch: collector.beforeBranch\n      }\n    });\n    fn.processed = true;\n    return fn.cooked;\n  }\n  return {\n    storyboardFunctions,\n    registerStoryboardFunctions,\n    updateStoryboardFunction(name, data) {\n      var newFn = _objectSpread(_objectSpread({}, data), {}, {\n        name\n      });\n      var deps = collectMemberUsageInFunction(newFn, \"FN\", true);\n      var hasPermissionsCheck = collectMemberUsageInFunction(newFn, \"PERMISSIONS\", true).has(\"check\");\n      registeredFunctions.set(name, {\n        source: data.source,\n        typescript: data.typescript,\n        deps,\n        hasPermissionsCheck\n      });\n    },\n    /**\n     * Check whether listed functions attempt to call `PERMISSIONS.check()`,\n     * includes in nested `FN.*()` calls.\n     */\n    checkPermissionsUsage(functionNames) {\n      var checkedFunctions = new Set();\n      var hasPermissionsCheck = name => {\n        if (!checkedFunctions.has(name)) {\n          checkedFunctions.add(name);\n          var fn = registeredFunctions.get(name);\n          return !!fn && (fn.hasPermissionsCheck || [...fn.deps].some(hasPermissionsCheck));\n        }\n        return false;\n      };\n      return functionNames.some(hasPermissionsCheck);\n    }\n  };\n}\n//# sourceMappingURL=StoryboardFunctionRegistry.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nexport var {\n  storyboardFunctions,\n  registerStoryboardFunctions,\n  checkPermissionsUsage\n} = StoryboardFunctionRegistryFactory();\n//# sourceMappingURL=StoryboardFunctions.js.map","/*! (c) Andrea Giammarchi - ISC */\nvar self = {};\ntry {\n  self.EventTarget = (new EventTarget).constructor;\n} catch(EventTarget) {\n  (function (Object, wm) {\n    var create = Object.create;\n    var defineProperty = Object.defineProperty;\n    var proto = EventTarget.prototype;\n    define(proto, 'addEventListener', function (type, listener, options) {\n      for (var\n        secret = wm.get(this),\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener)\n          return;\n      }\n      listeners.push({target: this, listener: listener, options: options});\n    });\n    define(proto, 'dispatchEvent', function (event) {\n      var secret = wm.get(this);\n      var listeners = secret[event.type];\n      if (listeners) {\n        define(event, 'target', this);\n        define(event, 'currentTarget', this);\n        listeners.slice(0).some(dispatch, event);\n        delete event.currentTarget;\n        delete event.target;\n      }\n      return true;\n    });\n    define(proto, 'removeEventListener', function (type, listener) {\n      for (var\n        secret = wm.get(this),\n        /* istanbul ignore next */\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener) {\n          listeners.splice(i, 1);\n          return;\n        }\n      }\n    });\n    self.EventTarget = EventTarget;\n    function EventTarget() {'use strict';\n      wm.set(this, create(null));\n    }\n    function define(target, name, value) {\n      defineProperty(\n        target,\n        name,\n        {\n          configurable: true,\n          writable: true,\n          value: value\n        }\n      );\n    }\n    function dispatch(info) {\n      var options = info.options;\n      if (options && options.once)\n        info.target.removeEventListener(this.type, info.listener);\n      if (typeof info.listener === 'function')\n        info.listener.call(info.target, this);\n      else\n        info.listener.handleEvent(this);\n      return this._stopImmediatePropagationFlag;\n    }\n  }(Object, new WeakMap));\n}\nexport default self.EventTarget;\n","import EventTarget from \"@ungap/event-target\";\nexport var MediaBreakpoint = /*#__PURE__*/function (MediaBreakpoint) {\n  MediaBreakpoint[\"xLarge\"] = \"xLarge\";\n  MediaBreakpoint[\"large\"] = \"large\";\n  MediaBreakpoint[\"medium\"] = \"medium\";\n  MediaBreakpoint[\"small\"] = \"small\";\n  MediaBreakpoint[\"xSmall\"] = \"xSmall\";\n  return MediaBreakpoint;\n}({});\nexport var mediaBreakpointMinWidthMap = new Map([[MediaBreakpoint.xLarge, \"1920px\"], [MediaBreakpoint.large, \"1600px\"], [MediaBreakpoint.medium, \"1280px\"], [MediaBreakpoint.small, \"1024px\"], [MediaBreakpoint.xSmall, 0]]);\nexport var mediaEventTarget = new EventTarget();\nvar breakpointMatchesMap = {};\nvar MEDIA = {};\nfunction handleMatchesChange(data, breakpoint) {\n  var changed = false;\n  breakpointMatchesMap[breakpoint] = data.matches;\n  for (var [_breakpoint] of mediaBreakpointMinWidthMap) {\n    if (breakpointMatchesMap[_breakpoint] && MEDIA.breakpoint !== _breakpoint) {\n      MEDIA.breakpoint = _breakpoint;\n      changed = true;\n      break;\n    }\n  }\n  if (changed) {\n    mediaEventTarget.dispatchEvent(new CustomEvent(\"change\", {\n      detail: MEDIA\n    }));\n  }\n}\nmediaBreakpointMinWidthMap.forEach((minWidth, breakpoint) => {\n  var mediaQueryList = window.matchMedia(\"(min-width: \".concat(minWidth, \")\"));\n  handleMatchesChange(mediaQueryList, breakpoint);\n  if (mediaQueryList.addEventListener) {\n    mediaQueryList.addEventListener(\"change\", event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  } else {\n    mediaQueryList.addListener(event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  }\n});\nexport var getMedia = () => MEDIA;\n//# sourceMappingURL=mediaQuery.js.map","export function getStorageItem(storageType) {\n  return function (name) {\n    var _storage$getItem;\n    var storage = storageType === \"local\" ? localStorage : sessionStorage;\n    return JSON.parse((_storage$getItem = storage.getItem(name)) !== null && _storage$getItem !== void 0 ? _storage$getItem : \"null\");\n  };\n}\n//# sourceMappingURL=getStorageItem.js.map","import { getRuntime } from \"./index.js\";\nexport function isStrictMode(runtimeContext) {\n  var _ref, _getRuntime;\n  return !!((_ref = runtimeContext ? runtimeContext.flags : (_getRuntime = getRuntime()) === null || _getRuntime === void 0 ? void 0 : _getRuntime.getFeatureFlags()) !== null && _ref !== void 0 && _ref[\"brick-next-v3-strict-mode\"]);\n}\nexport function warnAboutStrictMode(strict, message) {\n  for (var _len = arguments.length, extraLogs = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    extraLogs[_key - 2] = arguments[_key];\n  }\n  var punctuation = extraLogs.length === 0 ? \"\" : \",\";\n  if (strict) {\n    // eslint-disable-next-line no-console\n    console.error(\"\".concat(message, \" is dropped in v3 strict mode\").concat(punctuation), ...extraLogs);\n  } else {\n    // eslint-disable-next-line no-console\n    console.warn(\"\".concat(message, \" is deprecated in v3 and will be dropped in strict mode\").concat(punctuation), ...extraLogs);\n  }\n}\n//# sourceMappingURL=isStrictMode.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { uniq } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"./isStrictMode.js\";\nimport { getV2RuntimeFromDll } from \"./getV2RuntimeFromDll.js\";\n\n// Note: `prefix` is a native prop on Element, but it's only used in XML documents.\nvar allowedNativeProps = new Set([\"prefix\"]);\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomTemplateRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(tagName, constructor) {\n    var _constructor$proxy$pr, _constructor$proxy, _compatibleConstructo, _compatibleConstructo2;\n    var registered = _classPrivateFieldGet(this, _registry).has(tagName);\n    if (registered) {\n      // When open launchpad, the storyboard will be updated.\n      // However, we can't *undefine* a custom element.\n      // Just ignore re-registering custom templates.\n      // eslint-disable-next-line no-console\n      console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already registered.\"));\n    } else {\n      registered = !!customElements.get(tagName);\n      if (registered) {\n        // eslint-disable-next-line no-console\n        console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already defined by customElements.\"));\n      }\n    }\n\n    // Transform legacy `proxy.properties[].asVariable` as states.\n    var strict = isStrictMode();\n    var proxyProperties = (_constructor$proxy$pr = (_constructor$proxy = constructor.proxy) === null || _constructor$proxy === void 0 ? void 0 : _constructor$proxy.properties) !== null && _constructor$proxy$pr !== void 0 ? _constructor$proxy$pr : {};\n    var validProxyProps = [];\n    var legacyTplVariables = [];\n    for (var [key, value] of Object.entries(proxyProperties)) {\n      if (value.asVariable) {\n        warnAboutStrictMode(strict, \"Template `asVariable`\", tagName, key);\n        // istanbul ignore next\n        if (!strict) {\n          // For existed TPL usage, treat it as a STATE.\n          legacyTplVariables.push(key);\n        }\n      } else if (value.mergeProperty || value.refTransform) {\n        // eslint-disable-next-line no-console\n        console.error(\"Template `mergeProperty` and `refTransform` are dropped in v3:\", tagName, key);\n      } else if (value.ref) {\n        validProxyProps.push([key, value]);\n      }\n      // Else: documentation only, for exposed states.\n    }\n\n    var compatibleConstructor = _objectSpread(_objectSpread({}, constructor), {}, {\n      proxy: _objectSpread(_objectSpread({}, constructor.proxy), {}, {\n        properties: Object.fromEntries(validProxyProps)\n      }),\n      state: (constructor.state ? strict ? constructor.state : constructor.state.map(item => _objectSpread({\n        // Make `expose` defaults to true in non-strict mode.\n        expose: true\n      }, item)) : []).concat(legacyTplVariables.map(tpl => ({\n        name: tpl,\n        expose: true\n      })))\n    });\n\n    // Now we allow re-register custom template\n    _classPrivateFieldGet(this, _registry).set(tagName, _objectSpread(_objectSpread({}, compatibleConstructor), {}, {\n      name: tagName\n    }));\n    var exposedStates = getExposedStates(compatibleConstructor.state);\n    var proxyMethods = Object.entries((_compatibleConstructo = (_compatibleConstructo2 = compatibleConstructor.proxy) === null || _compatibleConstructo2 === void 0 ? void 0 : _compatibleConstructo2.methods) !== null && _compatibleConstructo !== void 0 ? _compatibleConstructo : {});\n    var props = exposedStates.concat(validProxyProps.map(entry => entry[0]));\n    var methods = proxyMethods.map(entry => entry[0]);\n    var nativeProps = props.concat(methods).filter(prop => prop in HTMLElement.prototype && !allowedNativeProps.has(prop));\n    if (nativeProps.length > 0) {\n      warnAboutStrictMode(strict, \"Using native HTMLElement properties as template properties or methods\", tagName, ...nativeProps);\n      // istanbul ignore next\n      if (strict) {\n        throw new Error(\"In custom template \\\"\".concat(tagName, \"\\\", \").concat(nativeProps.map(p => \"\\\"\".concat(p, \"\\\"\")).join(\", \"), \" are native HTMLElement properties, and should be avoid to be used as brick properties or methods.\"));\n      }\n    }\n    if (registered) {\n      return;\n    }\n    class TplElement extends HTMLElement {\n      get $$typeof() {\n        return \"custom-template\";\n      }\n      static get _dev_only_definedProperties() {\n        return props;\n      }\n      static get _dev_only_definedMethods() {\n        return methods;\n      }\n      $$getElementByRef(ref) {\n        var _this$$$tplStateStore;\n        return (_this$$$tplStateStore = this.$$tplStateStore) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.hostBrick) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.tplHostMetadata) === null || _this$$$tplStateStore === void 0 || (_this$$$tplStateStore = _this$$$tplStateStore.internalBricksByRef.get(ref)) === null || _this$$$tplStateStore === void 0 ? void 0 : _this$$$tplStateStore.element;\n      }\n      connectedCallback() {\n        var shadowRoot = this.shadowRoot;\n        if (!shadowRoot) {\n          shadowRoot = this.attachShadow({\n            mode: \"open\"\n          });\n        }\n        var fragment = document.createDocumentFragment();\n        var style = document.createElement(\"style\");\n        style.textContent = \":host{display:block}:host([hidden]){display:none}\";\n        var slot = document.createElement(\"slot\");\n        fragment.appendChild(style);\n        fragment.appendChild(slot);\n        shadowRoot.appendChild(fragment);\n      }\n      disconnectedCallback() {\n        if (this.shadowRoot) {\n          this.shadowRoot.textContent = \"\";\n        }\n      }\n    }\n    var _loop = function (propName) {\n      if (validProxyProps.some(entry => entry[0] === propName)) {\n        // eslint-disable-next-line no-console\n        console.error(\"Cannot define an exposed state that is also a proxy property: \\\"\".concat(propName, \"\\\" in \").concat(tagName));\n        return 1; // continue\n      }\n      Object.defineProperty(TplElement.prototype, propName, {\n        get() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          return this.$$tplStateStore.getValue(propName);\n        },\n        set(value) {\n          var _this$$$tplStateStore2;\n          // 在 mount 过程中，先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n          // 避免初始化的一次 state update 操作及其 onChange 事件。\n          (_this$$$tplStateStore2 = this.$$tplStateStore) === null || _this$$$tplStateStore2 === void 0 || _this$$$tplStateStore2.updateValue(propName, value, \"replace\");\n        },\n        enumerable: true\n      });\n    };\n    for (var propName of exposedStates) {\n      if (_loop(propName)) continue;\n    }\n    var _loop2 = function (from, to) {\n      Object.defineProperty(TplElement.prototype, from, {\n        get() {\n          var _to$refProperty;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(to.ref);\n          return element[(_to$refProperty = to.refProperty) !== null && _to$refProperty !== void 0 ? _to$refProperty : from];\n        },\n        set(value) {\n          var _this$$$getElementByR;\n          // 同上 exposedState.set\n          var element = (_this$$$getElementByR = this.$$getElementByRef) === null || _this$$$getElementByR === void 0 ? void 0 : _this$$$getElementByR.call(this, to.ref);\n          if (element) {\n            var _to$refProperty2;\n            element[(_to$refProperty2 = to.refProperty) !== null && _to$refProperty2 !== void 0 ? _to$refProperty2 : from] = value;\n          }\n        },\n        enumerable: true\n      });\n    };\n    for (var [from, to] of validProxyProps) {\n      _loop2(from, to);\n    }\n    var _loop3 = function (_from, _to) {\n      Object.defineProperty(TplElement.prototype, _from, {\n        value() {\n          var _to$refMethod;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(_to.ref);\n          element[(_to$refMethod = _to.refMethod) !== null && _to$refMethod !== void 0 ? _to$refMethod : _from](...arguments);\n        },\n        enumerable: true\n      });\n    };\n    for (var [_from, _to] of proxyMethods) {\n      _loop3(_from, _to);\n    }\n    customElements.define(tagName, TplElement);\n  }\n  get(tagName) {\n    return _classPrivateFieldGet(this, _registry).get(tagName);\n  }\n}\nfunction getExposedStates(state) {\n  var _state$filter$map;\n  // Allow duplicated state names which maybe mutually exclusive.\n  return uniq((_state$filter$map = state === null || state === void 0 ? void 0 : state.filter(item => item.expose).map(item => item.name)) !== null && _state$filter$map !== void 0 ? _state$filter$map : []);\n}\n\n// istanbul ignore next\nfunction getCustomTemplatesV2() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return Object.freeze({\n      define(tagName, constructor) {\n        return v2Kit.getRuntime().registerCustomTemplate(tagName, constructor);\n      }\n    });\n  }\n}\n\n// istanbul ignore next\nexport var customTemplates = getCustomTemplatesV2() || new CustomTemplateRegistry();\n//# sourceMappingURL=CustomTemplates.js.map","import { customTemplates } from \"../../CustomTemplates.js\";\nexport function getTplStateStore(_ref, using, extraInfo) {\n  var {\n    tplStateStoreId,\n    tplStateStoreMap\n  } = _ref;\n  if (!tplStateStoreId) {\n    throw new Error(\"Using \\\"\".concat(using, \"\\\" outside of a custom template\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\"));\n  }\n  var store = tplStateStoreMap.get(tplStateStoreId);\n  if (!store) {\n    throw new Error(\"Template state store is not found when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return store;\n}\nexport function getTplHostElement(runtimeContext, using, extraInfo) {\n  var store = getTplStateStore(runtimeContext, using, extraInfo);\n  var hostElement = store.hostBrick.element;\n  if (!hostElement) {\n    throw new Error(\"Template host element is gone when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return hostElement;\n}\nexport function getTagNameOfCustomTemplate(brick, appId) {\n  // When a template is registered by an app, it's namespace maybe missed.\n  if (!brick.includes(\".\") && brick.startsWith(\"tpl-\") && appId) {\n    var tagName = \"\".concat(appId, \".\").concat(brick);\n    if (customTemplates.get(tagName)) {\n      return tagName;\n    }\n  }\n  if (customTemplates.get(brick)) {\n    return brick;\n  }\n  return false;\n}\n//# sourceMappingURL=utils.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\nvar widgetFunctionRegistry = new Map();\nexport var widgetFunctions = new Proxy(Object.freeze({}), {\n  get(target, key) {\n    return widgetFunctionRegistry.get(key);\n  }\n});\nfunction registerWidgetFunctionsV3(widgetId, functions, widgetVersion) {\n  if (widgetFunctionRegistry.has(widgetId)) {\n    // eslint-disable-next-line no-console\n    throw new Error(\"Widget functions of \\\"\".concat(widgetId, \"\\\" already registered\"));\n  }\n  var {\n    storyboardFunctions,\n    registerStoryboardFunctions\n  } = StoryboardFunctionRegistryFactory({\n    widgetId,\n    widgetVersion\n  });\n  widgetFunctionRegistry.set(widgetId, storyboardFunctions);\n  registerStoryboardFunctions(functions);\n}\n\n// istanbul ignore next\nfunction registerWidgetFunctionsV2Factory() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return function (widgetId, functions, widgetVersion) {\n      return v2Kit.getRuntime().registerWidgetFunctions(widgetId, functions, widgetVersion);\n    };\n  }\n}\n\n// istanbul ignore next\nexport var registerWidgetFunctions = registerWidgetFunctionsV2Factory() || registerWidgetFunctionsV3;\n//# sourceMappingURL=WidgetFunctions.js.map","export const semver = /^[v^~<>=]*?(\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+))?(?:-([\\da-z\\-]+(?:\\.[\\da-z\\-]+)*))?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\nexport const validateAndParse = (version) => {\n    if (typeof version !== 'string') {\n        throw new TypeError('Invalid argument expected string');\n    }\n    const match = version.match(semver);\n    if (!match) {\n        throw new Error(`Invalid argument not valid semver ('${version}' received)`);\n    }\n    match.shift();\n    return match;\n};\nconst isWildcard = (s) => s === '*' || s === 'x' || s === 'X';\nconst tryParse = (v) => {\n    const n = parseInt(v, 10);\n    return isNaN(n) ? v : n;\n};\nconst forceType = (a, b) => typeof a !== typeof b ? [String(a), String(b)] : [a, b];\nconst compareStrings = (a, b) => {\n    if (isWildcard(a) || isWildcard(b))\n        return 0;\n    const [ap, bp] = forceType(tryParse(a), tryParse(b));\n    if (ap > bp)\n        return 1;\n    if (ap < bp)\n        return -1;\n    return 0;\n};\nexport const compareSegments = (a, b) => {\n    for (let i = 0; i < Math.max(a.length, b.length); i++) {\n        const r = compareStrings(a[i] || '0', b[i] || '0');\n        if (r !== 0)\n            return r;\n    }\n    return 0;\n};\n//# sourceMappingURL=utils.js.map","import { compareVersions } from './compareVersions';\n/**\n * Compare [semver](https://semver.org/) version strings using the specified operator.\n *\n * @param v1 First version to compare\n * @param v2 Second version to compare\n * @param operator Allowed arithmetic operator to use\n * @returns `true` if the comparison between the firstVersion and the secondVersion satisfies the operator, `false` otherwise.\n *\n * @example\n * ```\n * compare('10.1.8', '10.0.4', '>'); // return true\n * compare('10.0.1', '10.0.1', '='); // return true\n * compare('10.1.1', '10.2.2', '<'); // return true\n * compare('10.1.1', '10.2.2', '<='); // return true\n * compare('10.1.1', '10.2.2', '>='); // return false\n * ```\n */\nexport const compare = (v1, v2, operator) => {\n    // validate input operator\n    assertValidOperator(operator);\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    const res = compareVersions(v1, v2);\n    return operatorResMap[operator].includes(res);\n};\nconst operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1],\n    '!=': [-1, 1],\n};\nconst allowedOperators = Object.keys(operatorResMap);\nconst assertValidOperator = (op) => {\n    if (typeof op !== 'string') {\n        throw new TypeError(`Invalid operator type, expected string but got ${typeof op}`);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n        throw new Error(`Invalid operator, expected one of ${allowedOperators.join('|')}`);\n    }\n};\n//# sourceMappingURL=compare.js.map","import { compareSegments, validateAndParse } from './utils';\n/**\n * Compare [semver](https://semver.org/) version strings to find greater, equal or lesser.\n * This library supports the full semver specification, including comparing versions with different number of digits like `1.0.0`, `1.0`, `1`, and pre-release versions like `1.0.0-alpha`.\n * @param v1 - First version to compare\n * @param v2 - Second version to compare\n * @returns Numeric value compatible with the [Array.sort(fn) interface](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Parameters).\n */\nexport const compareVersions = (v1, v2) => {\n    // validate input and split into segments\n    const n1 = validateAndParse(v1);\n    const n2 = validateAndParse(v2);\n    // pop off the patch\n    const p1 = n1.pop();\n    const p2 = n2.pop();\n    // validate numbers\n    const r = compareSegments(n1, n2);\n    if (r !== 0)\n        return r;\n    // validate pre-release\n    if (p1 && p2) {\n        return compareSegments(p1.split('.'), p2.split('.'));\n    }\n    else if (p1 || p2) {\n        return p1 ? -1 : 1;\n    }\n    return 0;\n};\n//# sourceMappingURL=compareVersions.js.map","import { compare } from \"compare-versions\";\nimport { _internalApiGetAppInBootstrapData, hooks } from \"./Runtime.js\";\nexport function hasInstalledApp(appId, matchVersion) {\n  // First, check whether the app is in bootstrap already.\n  var app = _internalApiGetAppInBootstrapData(appId);\n  if (!app && hooks !== null && hooks !== void 0 && hooks.checkInstalledApps) {\n    app = hooks.checkInstalledApps.getCheckedApp(appId);\n  }\n  if (!app || app.installStatus === \"running\") {\n    return false;\n  }\n  // Todo: `currentVersion` maybe `\"\"`\n  if (!matchVersion || !app.currentVersion) {\n    return true;\n  }\n  // Valid `matchVersion`:\n  //   >=1.2.3\n  //   >1.2.3\n  //   =1.2.3\n  //   <=1.2.3\n  //   <1.2.3\n  var matches = matchVersion.match(/^([><]=?|=)(.*)$/);\n  try {\n    if (!matches) {\n      throw new TypeError(\"Invalid match version: \".concat(matchVersion));\n    }\n    return compare(app.currentVersion, matches[2], matches[1]);\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error);\n  }\n  return false;\n}\n//# sourceMappingURL=hasInstalledApp.js.map","export function getFormStateStore(_ref, using, extraInfo) {\n  var {\n    formStateStoreId,\n    formStateStoreMap\n  } = _ref;\n  if (!formStateStoreId) {\n    throw new Error(\"Using \\\"\".concat(using, \"\\\" outside of form renderer\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\"));\n  }\n  var store = formStateStoreMap.get(formStateStoreId);\n  if (!store) {\n    throw new Error(\"Form state store is not found when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return store;\n}\n//# sourceMappingURL=utils.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { getBrickPackages, hooks } from \"../Runtime.js\";\nvar pool = new Map();\nexport function getProviderBrick(_x) {\n  return _getProviderBrick.apply(this, arguments);\n}\nfunction _getProviderBrick() {\n  _getProviderBrick = _asyncToGenerator(function* (provider) {\n    var _hooks$flowApi;\n    var isFlowApi = hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 ? void 0 : _hooks$flowApi.isFlowApiProvider(provider);\n    if (isFlowApi) {\n      provider = hooks.flowApi.FLOW_API_PROVIDER;\n    }\n    var brick = pool.get(provider);\n    if (brick) {\n      return brick;\n    }\n    if (provider.includes(\"-\") && !customElements.get(provider)) {\n      if (isFlowApi) {\n        hooks.flowApi.registerFlowApiProvider();\n      } else {\n        yield loadBricksImperatively([provider], getBrickPackages());\n        if (!customElements.get(provider)) {\n          throw new Error(\"Provider not defined: \\\"\".concat(provider, \"\\\".\"));\n        }\n      }\n    }\n    brick = document.createElement(provider);\n    pool.set(provider, brick);\n    return brick;\n  });\n  return _getProviderBrick.apply(this, arguments);\n}\n//# sourceMappingURL=getProviderBrick.js.map","import { isObject } from \"@next-core/utils/general\";\nvar computed = new WeakSet();\n\n// The computed (or transformed) result should never be *computed* again.\n// So does the fetched data from a remote api.\nexport function markAsComputed(value) {\n  if (isObject(value)) {\n    if (!hasBeenComputed(value)) {\n      computed.add(value);\n      if (Array.isArray(value)) {\n        value.forEach(markAsComputed);\n      } else {\n        // Only mark pure objects.\n        var proto = Object.getPrototypeOf(value);\n        if (!proto || proto.constructor === Object) {\n          Object.values(value).forEach(markAsComputed);\n        }\n      }\n    }\n  }\n}\nexport function hasBeenComputed(object) {\n  return computed.has(object);\n}\nexport function resetAllComputedMarks() {\n  computed = new WeakSet();\n}\n//# sourceMappingURL=markAsComputed.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { asyncComputeRealValue } from \"../compute/computeRealValue.js\";\nimport { getProviderBrick } from \"./getProviderBrick.js\";\nimport { hooks } from \"../Runtime.js\";\nimport { markAsComputed } from \"../compute/markAsComputed.js\";\nimport { get } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nvar cache = new Map();\nexport function resolveData(_x, _x2, _x3) {\n  return _resolveData.apply(this, arguments);\n}\nfunction _resolveData() {\n  _resolveData = _asyncToGenerator(function* (resolveConf, runtimeContext, options) {\n    var {\n      useProvider,\n      method = \"resolve\",\n      args = [],\n      onReject\n    } = resolveConf;\n    var {\n      provider: legacyProvider,\n      field: legacyField\n    } = resolveConf;\n    if (legacyProvider && !useProvider) {\n      throw new Error(\"You're using \\\"provider: \".concat(legacyProvider, \"\\\" which is dropped in v3, please use \\\"useProvider\\\" instead\"));\n    }\n    var hasLegacyField = legacyField !== null && legacyField !== undefined;\n    if (hasLegacyField) {\n      var strict = isStrictMode();\n      warnAboutStrictMode(strict, \"`resolve.field`\");\n      // istanbul ignore next\n      if (strict) {\n        throw new Error(\"Using deprecated `resolve.field`\");\n      }\n    }\n    var [providerBrick, actualArgs] = yield Promise.all([getProviderBrick(useProvider), asyncComputeRealValue(args, runtimeContext)]);\n    var promise = resolveByProvider(providerBrick, useProvider, method, actualArgs, options, args);\n    var {\n      transform\n    } = resolveConf;\n    var data;\n    try {\n      var value = yield promise;\n      data = hasLegacyField ? get(value, legacyField) : value;\n      // The fetched data and its inner objects should never be *injected* again.\n      markAsComputed(data);\n    } catch (error) {\n      if (isHandleRejectByTransform(onReject)) {\n        transform = onReject.transform;\n        data = error;\n      } else {\n        throw error;\n      }\n    }\n    if (!transform) {\n      return data;\n    }\n\n    // Keep backward compatibility of string transform.\n    if (typeof transform === \"string\") {\n      return {\n        [transform]: data\n      };\n    }\n    return asyncComputeRealValue(transform, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      data\n    }));\n  });\n  return _resolveData.apply(this, arguments);\n}\nexport function clearResolveCache() {\n  cache.clear();\n}\nexport function resolveByProvider(_x4, _x5, _x6, _x7, _x8, _x9) {\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction _resolveByProvider() {\n  _resolveByProvider = _asyncToGenerator(function* (brick, useProvider, method, args, options, originalArgs) {\n    var cacheKey;\n    try {\n      // `args` may contain circular references, which makes\n      // JSON stringify failed, thus we fallback to original args.\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        args\n      });\n    } catch (e) {\n      if (!originalArgs) {\n        throw e;\n      }\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        originalArgs\n      });\n    }\n    var promise;\n    if ((options === null || options === void 0 ? void 0 : options.cache) !== \"reload\") {\n      promise = cache.get(cacheKey);\n    }\n    if (!promise) {\n      promise = _asyncToGenerator(function* () {\n        var _hooks$flowApi;\n        var finalArgs = hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(useProvider) ? yield hooks.flowApi.getArgsOfFlowApi(useProvider, args, method) : args;\n        return brick.resolve(...finalArgs);\n      })();\n      cache.set(cacheKey, promise);\n    }\n    return promise;\n  });\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction isHandleRejectByTransform(onReject) {\n  return !!(onReject !== null && onReject !== void 0 && onReject.transform);\n}\n//# sourceMappingURL=resolveData.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { cook, preevaluate, shouldAllowRecursiveEvaluations } from \"@next-core/cook\";\nimport { loadProcessorsImperatively } from \"@next-core/loader\";\nimport { supply } from \"@next-core/supply\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage, collectAppGetMenuUsage, collectInstalledAppsHasUsage } from \"@next-core/utils/storyboard\";\nimport { cloneDeep, omit } from \"lodash\";\nimport { customProcessors } from \"../../CustomProcessors.js\";\nimport { checkPermissionsUsage, storyboardFunctions } from \"./StoryboardFunctions.js\";\nimport { getGeneralGlobals } from \"./getGeneralGlobals.js\";\nimport { getDynamicReadOnlyProxy, getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { devtoolsHookEmit, getDevHook } from \"../devtools.js\";\nimport { getMedia } from \"../mediaQuery.js\";\nimport { getStorageItem } from \"./getStorageItem.js\";\nimport { _internalApiGetStoryboardInBootstrapData, getBrickPackages, getRuntime, hooks } from \"../Runtime.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { widgetFunctions } from \"./WidgetFunctions.js\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { hasInstalledApp } from \"../hasInstalledApp.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./computeRealValue.js\";\nvar symbolForRaw = Symbol.for(\"pre.evaluated.raw\");\nvar symbolForContext = Symbol.for(\"pre.evaluated.context\");\nexport function isPreEvaluated(raw) {\n  return !!(raw !== null && raw !== void 0 && raw[symbolForRaw]);\n}\nexport function getPreEvaluatedRaw(pre) {\n  return pre[symbolForRaw];\n}\nexport function shouldDismissMarkingComputed(raw) {\n  if (typeof raw === \"string\") {\n    return shouldAllowRecursiveEvaluations(raw);\n  }\n  return shouldAllowRecursiveEvaluations(raw[symbolForRaw]);\n}\nvar possibleErrorConstructs = new WeakSet([SyntaxError, TypeError, ReferenceError]);\nexport function getCookErrorConstructor(error) {\n  return possibleErrorConstructs.has(error.constructor) ? error.constructor : TypeError;\n}\nexport function asyncEvaluate(_x, _x2, _x3) {\n  return _asyncEvaluate.apply(this, arguments);\n}\nfunction _asyncEvaluate() {\n  _asyncEvaluate = _asyncToGenerator(function* (raw,\n  // string or pre-evaluated object.\n  runtimeContext, options) {\n    var {\n      blockingList,\n      run\n    } = lowLevelEvaluate(raw, runtimeContext, options, true);\n    yield Promise.all(blockingList);\n    return run();\n  });\n  return _asyncEvaluate.apply(this, arguments);\n}\nexport function evaluate(raw,\n// string or pre-evaluated object.\nruntimeContext, options) {\n  var {\n    run\n  } = lowLevelEvaluate(raw, runtimeContext, options, false);\n  return run();\n}\nfunction lowLevelEvaluate(raw,\n// string or pre-evaluated object.\nruntimeContext) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var isAsync = arguments.length > 3 ? arguments[3] : undefined;\n  var blockingList = [];\n  if (typeof raw !== \"string\") {\n    // If the `raw` is not a string, it must be a pre-evaluated object.\n    // Then fulfil the context, and restore the original `raw`.\n\n    var passByRuntimeContext = omit(runtimeContext, [\"pendingPermissionsPreCheck\", \"tplStateStoreMap\", \"tplStateStoreScope\", \"formStateStoreMap\", \"formStateStoreScope\"]);\n    runtimeContext = _objectSpread(_objectSpread({}, raw[symbolForContext]), passByRuntimeContext);\n    raw = raw[symbolForRaw];\n  }\n\n  // Collect `APP.getMenu(...)` usage before evaluating.\n  var menuUsage = {\n    usedArgs: new Set()\n  };\n  var hasAppUsage = {\n    usedArgs: new Set()\n  };\n\n  // A `SyntaxError` maybe thrown.\n  var precooked;\n  try {\n    precooked = preevaluate(raw, {\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal(node, parent) {\n          collectAppGetMenuUsage(menuUsage, node, parent);\n          collectInstalledAppsHasUsage(hasAppUsage, node, parent);\n        }\n      }\n    });\n  } catch (error) {\n    var message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n    var errorConstructor = getCookErrorConstructor(error);\n    throw new errorConstructor(message);\n  }\n  if (menuUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"APP.getMenu\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  if (hasAppUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"INSTALLED_APPS.has\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  var globalVariables = {};\n  var {\n    attemptToVisitGlobals\n  } = precooked;\n\n  // Ignore evaluating if required `event/DATA` is missing in\n  // context. Since they are are provided in different context, whenever\n  // missing one of them, memorize the current context for later consuming.\n  if (options.lazy || attemptToVisitGlobals.has(\"EVENT\") && !hasOwnProperty(runtimeContext, \"event\") || attemptToVisitGlobals.has(\"DATA\") && !hasOwnProperty(runtimeContext, \"data\")) {\n    return {\n      blockingList,\n      run() {\n        return Object.keys(runtimeContext).length > 0 ? {\n          [symbolForRaw]: raw,\n          [symbolForContext]: runtimeContext\n        } : raw;\n      }\n    };\n  }\n  var usedCtx;\n  var usedProcessors;\n  var usedStates;\n  var tplStateStore;\n  var strict = isStrictMode(runtimeContext);\n\n  // For existed TPL usage, treat it as a STATE.\n  if (attemptToVisitGlobals.has(\"STATE\") || !strict && attemptToVisitGlobals.has(\"TPL\")) {\n    tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(raw, \"\\\"\"));\n  }\n  var usedFormStates;\n  var formStateStore;\n  if (attemptToVisitGlobals.has(\"FORM_STATE\")) {\n    formStateStore = getFormStateStore(runtimeContext, \"FORM_STATE\", \": \\\"\".concat(raw, \"\\\"\"));\n  }\n  var devHook = getDevHook();\n  if (isAsync || devHook) {\n    if (attemptToVisitGlobals.has(\"CTX\")) {\n      usedCtx = strictCollectMemberUsage(raw, \"CTX\");\n      isAsync && blockingList.push(runtimeContext.ctxStore.waitFor(usedCtx));\n    }\n    if (tplStateStore) {\n      usedStates = strictCollectMemberUsage(raw, \"STATE\");\n      // istanbul ignore if\n      if (!strict) {\n        var usedTpls = strictCollectMemberUsage(raw, \"TPL\");\n        for (var tpl of usedTpls) {\n          usedStates.add(tpl);\n        }\n      }\n      isAsync && blockingList.push(tplStateStore.waitFor(usedStates));\n    }\n    if (formStateStore) {\n      usedFormStates = strictCollectMemberUsage(raw, \"FORM_STATE\");\n      isAsync && blockingList.push(formStateStore.waitFor(usedFormStates));\n    }\n    if (attemptToVisitGlobals.has(\"PROCESSORS\")) {\n      usedProcessors = strictCollectMemberUsage(raw, \"PROCESSORS\", 2);\n      isAsync && blockingList.push(loadProcessorsImperatively(usedProcessors, getBrickPackages()));\n    }\n  }\n  if (isAsync) {\n    var attemptToCheckPermissions = attemptToVisitGlobals.has(\"PERMISSIONS\");\n    // There maybe `PERMISSIONS.check()` usage in functions\n    if (!attemptToCheckPermissions && attemptToVisitGlobals.has(\"FN\")) {\n      var usedFunctions = [...strictCollectMemberUsage(raw, \"FN\")];\n      attemptToCheckPermissions = checkPermissionsUsage(usedFunctions);\n    }\n    if (attemptToCheckPermissions) {\n      blockingList.push(...runtimeContext.pendingPermissionsPreCheck);\n    }\n    if (menuUsage.usedArgs.size > 0 && hooks !== null && hooks !== void 0 && hooks.menu) {\n      // Block evaluating if has `APP.getMenu(...)` usage.\n      var usedMenuIds = [...menuUsage.usedArgs];\n      blockingList.push(Promise.all(usedMenuIds.map(menuId => hooks.menu.fetchMenuById(menuId, runtimeContext, {\n        getStoryboardByAppId: _internalApiGetStoryboardInBootstrapData,\n        resolveData,\n        asyncComputeRealValue\n      }))));\n    }\n    if (hasAppUsage.usedArgs.size > 0) {\n      var _hooks$checkInstalled;\n      // Only wait for specific apps\n      blockingList.push(hooks === null || hooks === void 0 || (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 ? void 0 : _hooks$checkInstalled.waitForCheckingApps([...hasAppUsage.usedArgs]));\n    }\n  }\n  return {\n    blockingList,\n    run() {\n      var _runtimeContext$overr, _hooks$menu, _match$params, _hooks$images;\n      var {\n        app: currentApp,\n        location,\n        query,\n        match,\n        flags,\n        sys,\n        ctxStore,\n        data,\n        event\n      } = runtimeContext;\n      var app = (_runtimeContext$overr = runtimeContext.overrideApp) !== null && _runtimeContext$overr !== void 0 ? _runtimeContext$overr : currentApp;\n      for (var variableName of attemptToVisitGlobals) {\n        switch (variableName) {\n          // case \"ALIAS\":\n          case \"ANCHOR\":\n            globalVariables[variableName] = location.hash ? location.hash.substring(1) : null;\n            break;\n          case \"APP\":\n            globalVariables[variableName] = _objectSpread(_objectSpread({}, cloneDeep(app)), {}, {\n              getMenu: hooks === null || hooks === void 0 || (_hooks$menu = hooks.menu) === null || _hooks$menu === void 0 ? void 0 : _hooks$menu.getMenuById\n            });\n            break;\n          case \"CTX\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return ctxStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedCtx);\n              }\n            });\n            break;\n          case \"DATA\":\n            globalVariables[variableName] = data;\n            break;\n          case \"EVENT\":\n            globalVariables[variableName] = event;\n            break;\n          case \"FLAGS\":\n            globalVariables[variableName] = getReadOnlyProxy(flags);\n            break;\n          case \"FORM_STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return formStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedFormStates);\n              }\n            });\n            break;\n          case \"HASH\":\n            globalVariables[variableName] = location.hash;\n            break;\n          case \"INSTALLED_APPS\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              has: hasInstalledApp\n            });\n            break;\n          case \"ITEM\":\n          case \"INDEX\":\n            {\n              var property = variableName === \"ITEM\" ? \"forEachItem\" : \"forEachIndex\";\n              if (!hasOwnProperty(runtimeContext, property)) {\n                // eslint-disable-next-line no-console\n                console.error(\"Using `\".concat(variableName, \"` but no `:forEach` is found, check your expression: \\\"\").concat(raw, \"\\\"\"));\n              } else {\n                globalVariables[variableName] = runtimeContext[property];\n              }\n              break;\n            }\n          case \"LOCAL_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"local\")\n            });\n            break;\n          case \"MEDIA\":\n            globalVariables[variableName] = getReadOnlyProxy(getMedia());\n            break;\n          case \"MISC\":\n            globalVariables[variableName] = getRuntime().getMiscSettings();\n            break;\n          case \"PARAMS\":\n            globalVariables[variableName] = new URLSearchParams(query);\n            break;\n          case \"PATH\":\n            globalVariables[variableName] = getReadOnlyProxy((_match$params = match === null || match === void 0 ? void 0 : match.params) !== null && _match$params !== void 0 ? _match$params : {});\n            break;\n          case \"PATH_NAME\":\n            globalVariables[variableName] = location.pathname;\n            break;\n          case \"PROCESSORS\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                var pkg = customProcessors.get(key);\n                if (!pkg) {\n                  throw new Error(\"'PROCESSORS.\".concat(key, \"' is not registered! Have you installed the relevant brick package?\"));\n                }\n                return getDynamicReadOnlyProxy({\n                  get(t, k) {\n                    return pkg.get(k);\n                  },\n                  ownKeys() {\n                    return Array.from(pkg.keys());\n                  }\n                });\n              },\n              ownKeys() {\n                var keys = new Set();\n                for (var processor of usedProcessors) {\n                  var namespace = processor.split(\".\")[0];\n                  keys.add(namespace);\n                }\n                return Array.from(keys);\n              }\n            });\n            break;\n          case \"QUERY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.get(key)]));\n            break;\n          case \"QUERY_ARRAY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.getAll(key)]));\n            // case \"SEGUE\":\n            break;\n          case \"SESSION_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"session\")\n            });\n            break;\n          // istanbul ignore next\n          case \"TPL\":\n            warnAboutStrictMode(strict, 'Using \"TPL\" in expression', \"check your expression: \\\"\".concat(raw, \"\\\"\"));\n            if (strict) {\n              break;\n            }\n          // eslint-disable-next-line no-fallthrough\n          case \"STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return tplStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedStates);\n              }\n            });\n            break;\n          case \"SYS\":\n            globalVariables[variableName] = getReadOnlyProxy(sys !== null && sys !== void 0 ? sys : {});\n            break;\n          case \"__WIDGET_FN__\":\n            globalVariables[variableName] = widgetFunctions;\n            break;\n          case \"__WIDGET_IMG__\":\n            globalVariables[variableName] = hooks === null || hooks === void 0 || (_hooks$images = hooks.images) === null || _hooks$images === void 0 ? void 0 : _hooks$images.widgetImagesFactory;\n            break;\n          case \"__WIDGET_I18N__\":\n            globalVariables[variableName] = widgetI18nFactory;\n            break;\n        }\n      }\n      Object.assign(globalVariables, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        storyboardFunctions,\n        app: runtimeContext.app,\n        appendI18nNamespace: runtimeContext.appendI18nNamespace\n      }));\n      try {\n        var result = cook(precooked.expression, precooked.source, {\n          globalVariables: supply(precooked.attemptToVisitGlobals, globalVariables)\n        });\n        var detail = {\n          raw,\n          context: globalVariables,\n          result\n        };\n        devtoolsHookEmit(\"evaluation\", detail);\n        return result;\n      } catch (error) {\n        var _message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n        var _errorConstructor = getCookErrorConstructor(error);\n        throw new _errorConstructor(_message);\n      }\n    }\n  };\n}\n//# sourceMappingURL=evaluate.js.map","export var StateOfUseBrick = /*#__PURE__*/function (StateOfUseBrick) {\n  StateOfUseBrick[StateOfUseBrick[\"INITIAL\"] = 0] = \"INITIAL\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK\"] = 1] = \"USE_BRICK\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_ITEM\"] = 2] = \"USE_BRICK_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_PROPERTIES\"] = 3] = \"USE_BRICK_PROPERTIES\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_TRANSFORM\"] = 4] = \"USE_BRICK_TRANSFORM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_EVENTS\"] = 5] = \"USE_BRICK_EVENTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_IF\"] = 6] = \"USE_BRICK_IF\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS\"] = 7] = \"USE_BRICK_SLOTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM\"] = 8] = \"USE_BRICK_SLOTS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS\"] = 9] = \"USE_BRICK_SLOTS_ITEM_BRICKS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\"] = 10] = \"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_LIFECYCLE\"] = 11] = \"USE_BRICK_LIFECYCLE\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_DATA_SOURCE\"] = 12] = \"USE_BRICK_DATA_SOURCE\";\n  return StateOfUseBrick;\n}({});\nexport function isLazyContentInUseBrick(state) {\n  switch (state) {\n    case StateOfUseBrick.USE_BRICK_PROPERTIES:\n    case StateOfUseBrick.USE_BRICK_TRANSFORM:\n    case StateOfUseBrick.USE_BRICK_EVENTS:\n    case StateOfUseBrick.USE_BRICK_IF:\n    case StateOfUseBrick.USE_BRICK_LIFECYCLE:\n    case StateOfUseBrick.USE_BRICK_DATA_SOURCE:\n      return true;\n  }\n  return false;\n}\nexport function getNextStateOfUseBrick(state, isArray, key) {\n  if (isLazyContentInUseBrick(state)) {\n    return state;\n  }\n  if (isArray) {\n    switch (state) {\n      case StateOfUseBrick.USE_BRICK:\n        return StateOfUseBrick.USE_BRICK_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM;\n    }\n  } else {\n    switch (state) {\n      case StateOfUseBrick.INITIAL:\n        if (key === \"useBrick\") {\n          return StateOfUseBrick.USE_BRICK;\n        }\n        break;\n      case StateOfUseBrick.USE_BRICK:\n      case StateOfUseBrick.USE_BRICK_ITEM:\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:\n        {\n          switch (key) {\n            case \"properties\":\n              return StateOfUseBrick.USE_BRICK_PROPERTIES;\n            case \"transform\":\n              return StateOfUseBrick.USE_BRICK_TRANSFORM;\n            case \"dataSource\":\n              return StateOfUseBrick.USE_BRICK_DATA_SOURCE;\n            case \"events\":\n              return StateOfUseBrick.USE_BRICK_EVENTS;\n            case \"slots\":\n              return StateOfUseBrick.USE_BRICK_SLOTS;\n            case \"children\":\n              return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n            case \"if\":\n              return StateOfUseBrick.USE_BRICK_IF;\n            case \"lifeCycle\":\n              return StateOfUseBrick.USE_BRICK_LIFECYCLE;\n          }\n          break;\n        }\n      case StateOfUseBrick.USE_BRICK_SLOTS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM:\n        if (key === \"bricks\") {\n          return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n        }\n        break;\n    }\n  }\n  return StateOfUseBrick.INITIAL;\n}\n//# sourceMappingURL=getNextStateOfUseBrick.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { transformAndInject, transform, inject } from \"@next-core/inject\";\nimport { asyncEvaluate, isPreEvaluated, evaluate, shouldDismissMarkingComputed } from \"./evaluate.js\";\nimport { getNextStateOfUseBrick, isLazyContentInUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { hasBeenComputed, markAsComputed } from \"./markAsComputed.js\";\nexport function asyncComputeRealValue(_x, _x2) {\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nfunction _asyncComputeRealValue() {\n  _asyncComputeRealValue = _asyncToGenerator(function* (value, runtimeContext) {\n    var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var preEvaluated = isPreEvaluated(value);\n    if (preEvaluated || typeof value === \"string\") {\n      // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n      // are kept and to be evaluated later.\n      var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n      var result;\n      var dismissMarkingComputed = lazy;\n      if (preEvaluated || isEvaluable(value)) {\n        result = yield asyncEvaluate(value, runtimeContext, {\n          lazy\n        });\n        dismissMarkingComputed = shouldDismissMarkingComputed(value);\n      } else {\n        result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n      }\n      if (!dismissMarkingComputed) {\n        markAsComputed(result);\n      }\n      return result;\n    }\n    if (!isObject(value) || hasBeenComputed(value) || typeof value === \"function\") {\n      return value;\n    }\n    if (Array.isArray(value)) {\n      var nextOptions = getNextComputeOptions(internalOptions, true);\n      return Promise.all(value.map(v => asyncComputeRealValue(v, runtimeContext, nextOptions)));\n    }\n    return Object.fromEntries((yield Promise.all(Object.entries(value).map(_ref2 => {\n      var [k, v] = _ref2;\n      return Promise.all([asyncComputeRealValue(k, runtimeContext), asyncComputeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))]);\n    }))).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n  });\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nexport function computeRealValue(value, runtimeContext) {\n  var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var preEvaluated = isPreEvaluated(value);\n  if (preEvaluated || typeof value === \"string\") {\n    // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n    // are kept and to be evaluated later.\n    var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n    var result;\n    var dismissMarkingComputed = lazy;\n    if (preEvaluated || isEvaluable(value)) {\n      result = evaluate(value, runtimeContext);\n      dismissMarkingComputed = shouldDismissMarkingComputed(value);\n    } else {\n      result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n    }\n    if (!dismissMarkingComputed) {\n      markAsComputed(result);\n    }\n    return result;\n  }\n  if (!isObject(value) || hasBeenComputed(value) || typeof value === \"function\") {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    var nextOptions = getNextComputeOptions(internalOptions, true);\n    return value.map(v => computeRealValue(v, runtimeContext, nextOptions));\n  }\n  return Object.fromEntries(Object.entries(value).map(_ref => {\n    var [k, v] = _ref;\n    return [computeRealValue(k, runtimeContext), computeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))];\n  }).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n}\nfunction getNextComputeOptions(internalOptions, isArray, key) {\n  return internalOptions.$$lazyForUseBrick ? _objectSpread(_objectSpread({}, internalOptions), {}, {\n    $$stateOfUseBrick: getNextStateOfUseBrick(internalOptions.$$stateOfUseBrick, isArray, key)\n  }) : internalOptions;\n}\nfunction identity(value) {\n  return value;\n}\n//# sourceMappingURL=computeRealValue.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { isPreEvaluated } from \"./evaluate.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nimport { getV2RuntimeFromDll } from \"../../getV2RuntimeFromDll.js\";\n\n/**\n * 包含 `if` 条件判断的对象。\n */\n\nexport function asyncCheckIf(_x, _x2) {\n  return _asyncCheckIf.apply(this, arguments);\n}\nfunction _asyncCheckIf() {\n  _asyncCheckIf = _asyncToGenerator(function* (ifContainer, runtimeContext) {\n    return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? yield asyncComputeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n  });\n  return _asyncCheckIf.apply(this, arguments);\n}\nexport function checkIf(ifContainer, runtimeContext) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? computeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n}\nexport function checkIfOfComputed(ifContainer) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!ifContainer.if;\n}\nexport function asyncCheckBrickIf(_x3, _x4) {\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nfunction _asyncCheckBrickIf() {\n  _asyncCheckBrickIf = _asyncToGenerator(function* (brickConf, runtimeContext) {\n    if (isObject(brickConf.if) && !isPreEvaluated(brickConf.if)) {\n      var resolved = yield resolveData(brickConf.if, runtimeContext);\n      return checkIfOfComputed(resolved);\n    }\n    return asyncCheckIf(brickConf, runtimeContext);\n  });\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nfunction checkIfByTransformV3(ifContainer, data) {\n  return checkIf(ifContainer, {\n    data\n  });\n}\n\n// istanbul ignore next\nfunction checkIfByTransformV2Factory() {\n  var v2Kit = getV2RuntimeFromDll();\n  if (v2Kit) {\n    return v2Kit.looseCheckIfByTransform;\n  }\n}\n\n// istanbul ignore next\nexport var checkIfByTransform = checkIfByTransformV2Factory() || checkIfByTransformV3;\n//# sourceMappingURL=checkIf.js.map","import { isEvaluable, isTrackAll } from \"@next-core/cook\";\nimport { track, trackAll } from \"@next-core/utils/storyboard\";\nimport { getPreEvaluatedRaw, isPreEvaluated } from \"./evaluate.js\";\nexport function getTracks(value) {\n  var contextNames = false;\n  var stateNames = false;\n  var formStateNames = false;\n  if (typeof value === \"string\" ? isEvaluable(value) : isPreEvaluated(value)) {\n    var raw = typeof value === \"string\" ? value : getPreEvaluatedRaw(value);\n    if (isTrackAll(raw)) {\n      var result = trackAll(raw);\n      if (result) {\n        contextNames = result.context;\n        stateNames = result.state;\n        formStateNames = result.formState;\n      }\n    } else {\n      contextNames = track(raw, \"track context\", \"CTX\");\n      stateNames = track(raw, \"track state\", \"STATE\");\n      formStateNames = track(raw, \"track formstate\", \"FORM_STATE\");\n    }\n  }\n  return {\n    contextNames,\n    stateNames,\n    formStateNames\n  };\n}\n//# sourceMappingURL=getTracks.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { StateOfUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { getTracks } from \"./getTracks.js\";\nexport function asyncComputeRealPropertyEntries(properties, runtimeContext, trackingContextList) {\n  if (isObject(properties)) {\n    return Object.entries(properties).map(_ref => {\n      var [propName, propValue] = _ref;\n      var {\n        contextNames,\n        stateNames,\n        formStateNames\n      } = getTracks(propValue);\n      if (contextNames || stateNames || formStateNames) {\n        trackingContextList.push({\n          contextNames,\n          stateNames,\n          formStateNames,\n          propName,\n          propValue\n        });\n      }\n      // Related: https://github.com/facebook/react/issues/11347\n      var asyncValue = asyncComputeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      return [propName, asyncValue];\n    });\n  }\n  return [];\n}\nexport function computePropertyValue(_x, _x2) {\n  return _computePropertyValue.apply(this, arguments);\n}\nfunction _computePropertyValue() {\n  _computePropertyValue = _asyncToGenerator(function* (asyncPropertyEntries, propName) {\n    for (var [name, asyncValue, ignoreUndefined] of asyncPropertyEntries) {\n      if (name === propName) {\n        var value = yield asyncValue;\n        if (value !== undefined || !ignoreUndefined) {\n          return value;\n        }\n      }\n    }\n  });\n  return _computePropertyValue.apply(this, arguments);\n}\nexport function constructAsyncProperties(_x3) {\n  return _constructAsyncProperties.apply(this, arguments);\n}\nfunction _constructAsyncProperties() {\n  _constructAsyncProperties = _asyncToGenerator(function* (asyncPropertyEntries) {\n    var props = {};\n    for (var [propName, asyncValue, ignoreUndefined] of asyncPropertyEntries) {\n      var value = yield asyncValue;\n      if ((value !== undefined || !ignoreUndefined) && (\n      // For `style` and `dataset`, only object is acceptable.\n      propName !== \"style\" && propName !== \"dataset\" || isObject(value))) {\n        props[propName] = value;\n      }\n    }\n    return props;\n  });\n  return _constructAsyncProperties.apply(this, arguments);\n}\nexport function computeRealProperties(properties, runtimeContext) {\n  if (isObject(properties)) {\n    return Object.fromEntries(Object.entries(properties).map(_ref2 => {\n      var [propName, propValue] = _ref2;\n      // Related: https://github.com/facebook/react/issues/11347\n      var realValue = computeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      // For `style` and `dataset`, only object is acceptable.\n      if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n        return [propName, realValue];\n      }\n    }).filter(Boolean));\n  }\n  return {};\n}\n//# sourceMappingURL=computeRealProperties.js.map","export function setRealProperties(brick, realProps) {\n  if (!realProps) {\n    return;\n  }\n  for (var [propName, propValue] of Object.entries(realProps)) {\n    switch (propName) {\n      case \"style\":\n      case \"dataset\":\n        for (var [k, v] of Object.entries(propValue)) {\n          brick[propName][k] = v;\n        }\n        break;\n      case \"constructor\":\n      case \"__proto__\":\n      case \"innerHTML\":\n        // `innerHTML` is dangerous, use `textContent` instead.\n        throw new Error(\"set `\".concat(propName, \"` is prohibited\"));\n      default:\n        brick[propName] = propValue;\n    }\n  }\n}\n//# sourceMappingURL=setRealProperties.js.map","import { computeRealProperties } from \"./computeRealProperties.js\";\nimport { setRealProperties } from \"./setRealProperties.js\";\nexport function setProperties(bricks, properties, runtimeContext) {\n  var realProps = computeRealProperties(properties, runtimeContext);\n  if (!Array.isArray(bricks)) {\n    bricks = [bricks];\n  }\n  bricks.forEach(brick => {\n    setRealProperties(brick, realProps);\n  });\n}\n//# sourceMappingURL=setProperties.js.map","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \".concat(i));\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \".concat(j));\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \".concat(j));\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \".concat(i));\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \".concat(i));\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a;\n    var defaultPattern = \"[^\".concat(escapeString(options.delimiter || \"/#?\"), \"]+?\");\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \".concat(nextType, \" at \").concat(index, \", expected \").concat(type));\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || defaultPattern,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? defaultPattern : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\".concat(token.pattern, \")$\"), reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not repeat, but got an array\"));\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not be empty\"));\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to be \").concat(typeOfMessage));\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    var groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n    var index = 0;\n    var execResult = groupsRegex.exec(path.source);\n    while (execResult) {\n        keys.push({\n            // Use parenthesized substring match if available, index otherwise\n            name: execResult[1] || index++,\n            prefix: \"\",\n            suffix: \"\",\n            modifier: \"\",\n            pattern: \"\",\n        });\n        execResult = groupsRegex.exec(path.source);\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\".concat(parts.join(\"|\"), \")\"), flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d, _e = options.delimiter, delimiter = _e === void 0 ? \"/#?\" : _e, _f = options.endsWith, endsWith = _f === void 0 ? \"\" : _f;\n    var endsWithRe = \"[\".concat(escapeString(endsWith), \"]|$\");\n    var delimiterRe = \"[\".concat(escapeString(delimiter), \"]\");\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\".concat(prefix, \"((?:\").concat(token.pattern, \")(?:\").concat(suffix).concat(prefix, \"(?:\").concat(token.pattern, \"))*)\").concat(suffix, \")\").concat(mod);\n                    }\n                    else {\n                        route += \"(?:\".concat(prefix, \"(\").concat(token.pattern, \")\").concat(suffix, \")\").concat(token.modifier);\n                    }\n                }\n                else {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        route += \"((?:\".concat(token.pattern, \")\").concat(token.modifier, \")\");\n                    }\n                    else {\n                        route += \"(\".concat(token.pattern, \")\").concat(token.modifier);\n                    }\n                }\n            }\n            else {\n                route += \"(?:\".concat(prefix).concat(suffix, \")\").concat(token.modifier);\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += \"\".concat(delimiterRe, \"?\");\n        route += !options.endsWith ? \"$\" : \"(?=\".concat(endsWithRe, \")\");\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n            : endToken === undefined;\n        if (!strict) {\n            route += \"(?:\".concat(delimiterRe, \"(?=\").concat(endsWithRe, \"))?\");\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\".concat(delimiterRe, \"|\").concat(endsWithRe, \")\");\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","// Ref https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/matchPath.js\n\nimport { pathToRegexp, compile } from \"path-to-regexp\";\nvar cache = new Map();\nvar cacheLimit = 10000;\nvar cacheCount = 0;\nfunction compilePath(path, options) {\n  var cacheKey = \"\".concat(options.end).concat(options.strict).concat(options.sensitive);\n  var pathCache = cache.get(cacheKey);\n  if (!pathCache) {\n    cache.set(cacheKey, pathCache = new Map());\n  }\n  var cacheResult = pathCache.get(path);\n  if (cacheResult) {\n    return cacheResult;\n  }\n  var keys = [];\n  var regexp = pathToRegexp(path, keys, options);\n  var result = {\n    regexp,\n    keys\n  };\n  if (cacheCount < cacheLimit) {\n    pathCache.set(path, result);\n    cacheCount++;\n  }\n  return result;\n}\n\n/**\n * Public API for matching a URL pathname to a path.\n */\nexport function matchPath(pathname, options) {\n  var {\n    path: p,\n    exact = false,\n    strict = false,\n    sensitive = true\n  } = options;\n  var paths = Array.isArray(p) ? p : [p];\n  return paths.reduce((matched, path) => {\n    if (matched) {\n      return matched;\n    }\n    var {\n      regexp,\n      keys\n    } = compilePath(path, {\n      end: exact,\n      strict,\n      sensitive\n    });\n    var match = regexp.exec(pathname);\n    if (!match) {\n      return null;\n    }\n    var [url, ...values] = match;\n    var isExact = pathname === url;\n    if (exact && !isExact) {\n      return null;\n    }\n    var initialParams = {};\n    var result = {\n      path,\n      // the path used to match\n      url: path === \"/\" && url === \"\" ? \"/\" : url,\n      // the matched portion of the URL\n      isExact,\n      // whether or not we matched exactly\n      params: keys.reduce((memo, key, index) => {\n        memo[key.name] = values[index];\n        return memo;\n      }, initialParams)\n    };\n    return result;\n  }, null);\n}\nexport function toPath(path, pathParams) {\n  return compile(path)(pathParams);\n}\n//# sourceMappingURL=matchPath.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { matchPath } from \"./matchPath.js\";\nimport { asyncCheckIf } from \"./compute/checkIf.js\";\nimport { hooks } from \"./Runtime.js\";\nexport function matchRoutes(_x, _x2) {\n  return _matchRoutes.apply(this, arguments);\n}\nfunction _matchRoutes() {\n  _matchRoutes = _asyncToGenerator(function* (routes, runtimeContext) {\n    for (var route of routes) {\n      if (typeof route.path !== \"string\") {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid route with invalid path:\", route);\n        throw new Error(\"Invalid route with invalid type of path: \".concat(typeof route.path));\n      }\n      var match = matchRoute(route, runtimeContext.app.homepage, runtimeContext.location.pathname);\n      if (match && (yield asyncCheckIf(route, runtimeContext))) {\n        if (runtimeContext.app.noAuthGuard || route.public || !(hooks !== null && hooks !== void 0 && hooks.auth) || hooks.auth.isLoggedIn()) {\n          return {\n            match,\n            route\n          };\n        }\n        return \"unauthenticated\";\n      }\n    }\n    return \"missed\";\n  });\n  return _matchRoutes.apply(this, arguments);\n}\nexport function matchRoute(route, homepage, pathname) {\n  var routePath = route.path.replace(/^\\$\\{APP.homepage\\}/, homepage);\n  return matchPath(pathname, {\n    path: routePath,\n    exact: route.exact\n  });\n}\n//# sourceMappingURL=matchRoutes.js.map","export var symbolForAsyncComputedPropsFromHost = Symbol.for(\"tpl.asyncComputedPropsFromHost\");\nexport var symbolForTplStateStoreId = Symbol.for(\"tpl.stateStoreId\");\nexport var symbolForTPlExternalForEachItem = Symbol.for(\"tpl.externalForEachItem\");\nexport var symbolForTPlExternalForEachIndex = Symbol.for(\"tpl.externalForEachIndex\");\n//# sourceMappingURL=constants.js.map","var brick;\nfunction show(options) {\n  if (brick) {\n    return brick.resolve(options);\n  } else {\n    if (options.type === \"confirm\") {\n      if (confirm(options.content)) {\n        return new Promise(resolve => setTimeout(() => {\n          resolve();\n        }, 1));\n      } else {\n        return new Promise((resolve, reject) => setTimeout(() => {\n          reject();\n        }, 1));\n      }\n    } else {\n      alert(options.content);\n      return new Promise(resolve => setTimeout(() => {\n        resolve();\n      }, 1000));\n    }\n  }\n}\nexport function loadDialogService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load dialog service failed:\", error);\n  });\n}\nexport var Dialog = Object.freeze({\n  show\n});\n//# sourceMappingURL=Dialog.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { _internalApiGetRenderId } from \"./Runtime.js\";\nvar timeoutIdList = new Set();\nexport function startPoll(task, _ref, _ref2) {\n  var {\n    progress,\n    success,\n    error,\n    finally: finallyCallback\n  } = _ref;\n  var {\n    interval,\n    leadingRequestDelay,\n    continueOnError,\n    delegateLoadingBar,\n    expectPollEnd,\n    expectPollStopImmediately\n  } = _ref2;\n  var currentRenderId = _internalApiGetRenderId();\n  var currentTimeoutId;\n  function poll() {\n    return _poll.apply(this, arguments);\n  }\n  function _poll() {\n    _poll = _asyncToGenerator(function* () {\n      timeoutIdList.delete(currentTimeoutId);\n      var shouldStop;\n      try {\n        shouldStop = expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately();\n        // Stop polling immediately when the expectation is match before task.\n        if (!shouldStop) {\n          var _result = yield task();\n          // Stop polling immediately when the expectation is match or a different router\n          // is rendering after the task processed.\n          shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n          if (!shouldStop) {\n            progress === null || progress === void 0 || progress(_result);\n            if (expectPollEnd !== null && expectPollEnd !== void 0 && expectPollEnd(_result)) {\n              if (delegateLoadingBar) {\n                window.dispatchEvent(new Event(\"request.end\"));\n              }\n              success === null || success === void 0 || success(_result);\n              finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n            } else {\n              delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n            }\n          }\n        }\n      } catch (e) {\n        // Stop polling immediately when the expectation is match or a different router\n        // is rendering after the task processed.\n        shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n        if (!shouldStop) {\n          error === null || error === void 0 || error(e);\n          if (continueOnError) {\n            delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n          } else {\n            finallyCallback === null || finallyCallback === void 0 || finallyCallback();\n          }\n        }\n      } finally {\n        // Manually dispatch an event of `request.end` when the polling is stopped immediately.\n        if (delegateLoadingBar && shouldStop) {\n          window.dispatchEvent(new Event(\"request.end\"));\n        }\n      }\n    });\n    return _poll.apply(this, arguments);\n  }\n  function delayedPoll(delay) {\n    currentTimeoutId = setTimeout(poll, delay);\n    timeoutIdList.add(currentTimeoutId);\n  }\n  delayedPoll(leadingRequestDelay !== null && leadingRequestDelay !== void 0 ? leadingRequestDelay : 0);\n  if (delegateLoadingBar) {\n    window.dispatchEvent(new Event(\"request.start\"));\n  }\n}\nexport function clearPollTimeout() {\n  for (var timeoutId of timeoutIdList) {\n    clearTimeout(timeoutId);\n  }\n  timeoutIdList.clear();\n}\n//# sourceMappingURL=poll.js.map","export var K = /*#__PURE__*/function (K) {\n  K[\"REQUEST_FAILED\"] = \"REQUEST_FAILED\";\n  K[\"SOMETHING_WENT_WRONG\"] = \"SOMETHING_WENT_WRONG\";\n  K[\"LOGIN_TIMEOUT_MESSAGE\"] = \"LOGIN_TIMEOUT_MESSAGE\";\n  K[\"NETWORK_ERROR\"] = \"NETWORK_ERROR\";\n  return K;\n}({});\nvar en = {\n  [K.REQUEST_FAILED]: \"Request Failed\",\n  [K.SOMETHING_WENT_WRONG]: \"Something went wrong!\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"You haven't logged in or your login session has expired. Login right now?\",\n  [K.NETWORK_ERROR]: \"Network error, please check your network.\"\n};\nvar zh = {\n  [K.REQUEST_FAILED]: \"请求失败\",\n  [K.SOMETHING_WENT_WRONG]: \"出现了一些问题！\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"您还未登录或登录信息已过期，现在重新登录？\",\n  [K.NETWORK_ERROR]: \"网络错误，请检查您的网络连接。\"\n};\nexport var NS = \"core/runtime\";\nexport var locales = {\n  en,\n  zh\n};\n//# sourceMappingURL=i18n.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { HttpAbortError, HttpFetchError, HttpResponseError } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getRuntime } from \"./internal/Runtime.js\";\nimport { getHistory } from \"./history.js\";\nimport { K, NS } from \"./internal/i18n.js\";\nimport { Dialog } from \"./Dialog.js\";\n\n/**\n * 将 http 请求错误转换为可读的字符串。\n *\n * @remarks\n *\n * 将依次尝试读取返回的 JSON 格式数据的字符串类型的 `error` 和 `msg` 字段，如果没有找到则返回 `error.toString()` 的结果。\n *\n * @param error - 错误对象。\n *\n * @returns 转换为字符串的错误信息。\n */\nexport function httpErrorToString(error) {\n  if (error instanceof Event && error.target instanceof HTMLScriptElement) {\n    return error.target.src;\n  }\n  if (error instanceof HttpFetchError) {\n    return i18n.t(\"\".concat(NS, \":\").concat(K.NETWORK_ERROR));\n  }\n  if (error instanceof HttpResponseError) {\n    if (error.responseJson) {\n      if (typeof error.responseJson.error === \"string\") {\n        return error.responseJson.error;\n      } else if (typeof error.responseJson.msg === \"string\") {\n        return error.responseJson.msg;\n      }\n    }\n  }\n  if (error == null) {\n    return \"Unknown error\";\n  }\n  return error.toString();\n}\nexport function isUnauthenticatedError(error) {\n  return error instanceof HttpResponseError && error.response.status === 401 && !!error.responseJson && error.responseJson.code === 100003;\n}\nvar unauthenticatedConfirming = false;\nvar lastErrorMessage;\n\n/**\n * 处理 http 请求错误（使用 AntDesign 模态框弹出错误信息）。\n *\n * @param error - 错误对象。\n */\nexport function handleHttpError(error) {\n  // Do nothing if aborted http requests\n  if (error instanceof HttpAbortError) {\n    return;\n  }\n\n  // Redirect to login page if not logged in.\n  if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n    if (unauthenticatedConfirming) {\n      return;\n    }\n    unauthenticatedConfirming = true;\n    Dialog.show({\n      type: \"confirm\",\n      content: i18n.t(\"\".concat(NS, \":\").concat(K.LOGIN_TIMEOUT_MESSAGE))\n    }).then(() => {\n      redirectToLogin();\n      unauthenticatedConfirming = false;\n    }, () => {\n      unauthenticatedConfirming = false;\n    });\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.error(error);\n  var message = httpErrorToString(error);\n  if (message !== lastErrorMessage) {\n    lastErrorMessage = message;\n    Dialog.show({\n      type: \"error\",\n      title: i18n.t(\"\".concat(NS, \":\").concat(K.REQUEST_FAILED)),\n      content: message,\n      contentStyle: {\n        whiteSpace: \"pre-wrap\"\n      }\n    }).then(() => {\n      lastErrorMessage = undefined;\n    });\n  }\n  return;\n}\nfunction redirectToLogin() {\n  var ssoEnabled = getRuntime().getFeatureFlags()[\"sso-enabled\"];\n  var history = getHistory();\n  history.push(ssoEnabled ? \"/sso-auth/login\" : \"/auth/login\", {\n    from: _objectSpread(_objectSpread({}, history.location), {}, {\n      state: undefined\n    })\n  });\n}\n//# sourceMappingURL=handleHttpError.js.map","var brick;\nfunction show(options) {\n  if (brick) {\n    brick.resolve(options);\n  } else {\n    alert(options.message);\n  }\n}\nexport function loadNotificationService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load notification service failed:\", error);\n  });\n}\nexport var Notification = Object.freeze({\n  show\n});\n//# sourceMappingURL=Notification.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { checkIf } from \"./compute/checkIf.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { getHistory } from \"../history.js\";\nimport { getProviderBrick } from \"./data/getProviderBrick.js\";\nimport { startPoll } from \"./poll.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { setProperties } from \"./compute/setProperties.js\";\nimport { applyMode, applyTheme } from \"../themeAndMode.js\";\nimport { getTplHostElement, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { handleHttpError, httpErrorToString } from \"../handleHttpError.js\";\nimport { Notification } from \"../Notification.js\";\nimport { getFormStateStore } from \"./FormRenderer/utils.js\";\nimport { hooks } from \"./Runtime.js\";\nexport function bindListeners(brick, eventsMap, runtimeContext) {\n  if (!eventsMap) {\n    return;\n  }\n  Object.entries(eventsMap).forEach(_ref => {\n    var [eventType, handlers] = _ref;\n    var listener = listenerFactory(handlers, runtimeContext, {\n      element: brick\n    });\n    brick.addEventListener(eventType, listener);\n\n    // Remember added listeners for unbinding.\n    if (!brick.$$listeners) {\n      brick.$$listeners = [];\n    }\n    brick.$$listeners.push([eventType, listener]);\n\n    // Remember added listeners for devtools.\n    if (!brick.$$eventListeners) {\n      brick.$$eventListeners = [];\n    }\n    for (var handler of [].concat(handlers)) {\n      brick.$$eventListeners.push([eventType, null, handler]);\n    }\n  });\n}\nexport function unbindListeners(brick) {\n  if (brick.$$listeners) {\n    for (var [eventType, listener] of brick.$$listeners) {\n      brick.removeEventListener(eventType, listener);\n    }\n    brick.$$listeners.length = 0;\n  }\n}\nexport function isBuiltinHandler(handler) {\n  return typeof handler.action === \"string\";\n}\nexport function isUseProviderHandler(handler) {\n  return typeof handler.useProvider === \"string\";\n}\nexport function isCustomHandler(handler) {\n  return !!((handler.target || handler.targetRef) && (handler.method || handler.properties));\n}\nexport function isExecuteCustomHandler(handler) {\n  return !!handler.method;\n}\nexport function isSetPropsCustomHandler(handler) {\n  return !!handler.properties;\n}\nexport function isConditionalEventHandler(handler) {\n  return !!handler.then;\n}\nexport function listenerFactory(handlers, runtimeContext, runtimeBrick) {\n  return function (event) {\n    var _handler$batch, _handler$batch2;\n    for (var handler of [].concat(handlers)) {\n      if (!checkIf(handler, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }))) {\n        if (handler.else) {\n          listenerFactory(handler.else, runtimeContext, runtimeBrick)(event);\n        }\n        continue;\n      }\n      if (isConditionalEventHandler(handler)) {\n        listenerFactory(handler.then, runtimeContext, runtimeBrick)(event);\n      } else if (isBuiltinHandler(handler)) {\n        var [object, method] = handler.action.split(\".\");\n        switch (handler.action) {\n          case \"history.push\":\n          case \"history.replace\":\n          case \"history.pushQuery\":\n          case \"history.replaceQuery\":\n          case \"history.pushAnchor\":\n          case \"history.block\":\n          case \"history.goBack\":\n          case \"history.goForward\":\n          case \"history.reload\":\n          case \"history.unblock\":\n            handleHistoryAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n\n          // case \"segue.push\":\n          // case \"segue.replace\":\n          // case \"alias.push\":\n          // case \"alias.replace\":\n\n          case \"window.open\":\n            handleWindowAction(event, handler.args, runtimeContext);\n            break;\n          case \"location.reload\":\n          case \"location.assign\":\n            handleLocationAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"localStorage.setItem\":\n          case \"localStorage.removeItem\":\n          case \"sessionStorage.setItem\":\n          case \"sessionStorage.removeItem\":\n            handleStorageAction(event, object, method, handler.args, runtimeContext);\n            break;\n          case \"event.preventDefault\":\n            event.preventDefault();\n            break;\n          case \"console.log\":\n          case \"console.error\":\n          case \"console.warn\":\n          case \"console.info\":\n            handleConsoleAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"message.success\":\n          case \"message.error\":\n          case \"message.info\":\n          case \"message.warn\":\n            handleMessageAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"handleHttpError\":\n            handleHttpError(event.detail);\n            break;\n          case \"context.assign\":\n          case \"context.replace\":\n          case \"context.refresh\":\n          case \"context.load\":\n            handleContextAction(event, method, handler.args, (_handler$batch = handler.batch) !== null && _handler$batch !== void 0 ? _handler$batch : true, handler.callback, runtimeContext);\n            break;\n          case \"state.update\":\n          case \"state.refresh\":\n          case \"state.load\":\n            handleTplStateAction(event, method, handler.args, (_handler$batch2 = handler.batch) !== null && _handler$batch2 !== void 0 ? _handler$batch2 : true, handler.callback, runtimeContext);\n            break;\n          case \"tpl.dispatchEvent\":\n            {\n              var [type, init] = argsFactory(handler.args, runtimeContext, event);\n              var tplHostElement = getTplHostElement(runtimeContext, handler.action, \": \".concat(type));\n              tplHostElement.dispatchEvent(new CustomEvent(type, init));\n              break;\n            }\n          case \"formstate.update\":\n            handleFormStateAction(event, handler.args, handler.callback, runtimeContext);\n            break;\n          case \"message.subscribe\":\n          case \"message.unsubscribe\":\n            handleMessageDispatcher(event, method, handler.args, runtimeContext, runtimeBrick, handler.callback);\n            break;\n          case \"theme.setDarkTheme\":\n          case \"theme.setLightTheme\":\n            applyTheme(handler.action === \"theme.setDarkTheme\" ? \"dark\" : \"light\");\n            break;\n          case \"theme.setTheme\":\n            {\n              var [theme] = argsFactory(handler.args, runtimeContext, event);\n              applyTheme(theme);\n              break;\n            }\n          case \"mode.setDashboardMode\":\n          case \"mode.setDefaultMode\":\n            applyMode(handler.action === \"mode.setDashboardMode\" ? \"dashboard\" : \"default\");\n            break;\n\n          // case \"menu.clearMenuTitleCache\":\n          // case \"menu.clearMenuCache\":\n\n          // case \"analytics.event\":\n\n          // case \"preview.debug\":\n\n          default:\n            // eslint-disable-next-line no-console\n            console.error(\"unknown event listener action:\", handler.action);\n        }\n      } else if (isUseProviderHandler(handler)) {\n        handleUseProviderAction(event, handler, runtimeContext, runtimeBrick);\n      } else if (isCustomHandler(handler)) {\n        handleCustomAction(event, handler, runtimeContext, runtimeBrick);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"unknown event handler:\", handler);\n      }\n    }\n  };\n}\nfunction handleUseProviderAction(_x, _x2, _x3, _x4) {\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction _handleUseProviderAction() {\n  _handleUseProviderAction = _asyncToGenerator(function* (event, handler, runtimeContext, runtimeBrick) {\n    try {\n      var providerBrick = yield getProviderBrick(handler.useProvider);\n      var method = handler.method !== \"saveAs\" ? \"resolve\" : \"saveAs\";\n      brickCallback(event, providerBrick, handler, method, runtimeContext, runtimeBrick);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(httpErrorToString(error));\n    }\n  });\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction handleCustomAction(event, handler, runtimeContext, runtimeBrick) {\n  var targets = [];\n  var rawTarget = handler.target;\n  var rawTargetRef = handler.targetRef;\n  var computedTarget = rawTarget;\n  // Allow `target` to be set as evaluable string.\n  if (typeof rawTarget === \"string\" ? isEvaluable(rawTarget) : isPreEvaluated(rawTarget)) {\n    computedTarget = computeRealValue(rawTarget, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n  if (typeof computedTarget === \"string\") {\n    if (computedTarget === \"_self\") {\n      targets.push(runtimeBrick.element);\n    } else if (handler.multiple) {\n      targets = Array.from(document.querySelectorAll(computedTarget));\n    } else {\n      var found = document.querySelector(computedTarget);\n      if (found !== null) {\n        targets.push(found);\n      }\n    }\n  } else if (computedTarget) {\n    if (computedTarget instanceof HTMLElement) {\n      targets.push(computedTarget);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(\"unexpected target:\", computedTarget);\n    }\n  } else if (rawTargetRef) {\n    var computedTargetRef = rawTargetRef;\n    // Allow `targetRef` to be set as evaluable string.\n    if (typeof rawTargetRef === \"string\" ? isEvaluable(rawTargetRef) : isPreEvaluated(rawTargetRef)) {\n      computedTargetRef = computeRealValue(rawTargetRef, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    var targetRefs = [].concat(computedTargetRef);\n    var tplHostElement = getTplHostElement(runtimeContext, \"targetRef\", \": \".concat(targetRefs.join(\", \")));\n    targets.push(...targetRefs.map(ref => {\n      var _tplHostElement$$$get;\n      return (_tplHostElement$$$get = tplHostElement.$$getElementByRef) === null || _tplHostElement$$$get === void 0 ? void 0 : _tplHostElement$$$get.call(tplHostElement, ref);\n    }).filter(Boolean));\n  }\n  if (targets.length === 0) {\n    // eslint-disable-next-line no-console\n    console.error(\"target not found:\", rawTarget || rawTargetRef);\n    return;\n  }\n  if (isExecuteCustomHandler(handler)) {\n    targets.forEach(target => {\n      brickCallback(event, target, handler, handler.method, runtimeContext, runtimeBrick, {\n        useEventAsDefault: true\n      });\n    });\n  } else if (isSetPropsCustomHandler(handler)) {\n    setProperties(targets, handler.properties, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n}\nfunction brickCallback(_x5, _x6, _x7, _x8, _x9, _x10, _x11) {\n  return _brickCallback.apply(this, arguments);\n}\nfunction _brickCallback() {\n  _brickCallback = _asyncToGenerator(function* (event, target, handler, method, runtimeContext, runtimeBrick, options) {\n    var _poll;\n    if (typeof target[method] !== \"function\") {\n      // eslint-disable-next-line no-console\n      console.error(\"target has no method:\", {\n        target,\n        method: method\n      });\n      return;\n    }\n    var task = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var _hooks$flowApi;\n        var computedArgs = argsFactory(handler.args, runtimeContext, event, options);\n        if (isUseProviderHandler(handler) && hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(handler.useProvider)) {\n          computedArgs = yield hooks.flowApi.getArgsOfFlowApi(handler.useProvider, computedArgs, method);\n        }\n        return target[method](...computedArgs);\n      });\n      return function task() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    if (!handler.callback) {\n      task();\n      return;\n    }\n    var callbackFactory = eventCallbackFactory(handler.callback, runtimeContext, runtimeBrick);\n    var pollableCallback = {\n      progress: callbackFactory(\"progress\"),\n      success: callbackFactory(\"success\"),\n      error: callbackFactory(\"error\"),\n      finally: callbackFactory(\"finally\")\n    };\n    var poll;\n    if (isUseProviderHandler(handler)) {\n      poll = computeRealValue(handler.poll, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    if ((_poll = poll) !== null && _poll !== void 0 && _poll.enabled) {\n      startPoll(task, pollableCallback, poll);\n    } else {\n      try {\n        // Try to catch synchronized tasks too.\n        var result = yield task();\n        pollableCallback.success(result);\n      } catch (err) {\n        pollableCallback.error(err);\n      } finally {\n        pollableCallback[\"finally\"]();\n      }\n    }\n  });\n  return _brickCallback.apply(this, arguments);\n}\nfunction handleHistoryAction(event, method, args, callback, runtimeContext) {\n  var baseArgsLength = 0;\n  var hasCallback = false;\n  var overrideMethod = method;\n  switch (method) {\n    case \"push\":\n    case \"replace\":\n    case \"pushQuery\":\n    case \"replaceQuery\":\n    case \"pushAnchor\":\n      baseArgsLength = 2;\n      hasCallback = true;\n      break;\n    case \"reload\":\n      hasCallback = true;\n      break;\n    case \"block\":\n      baseArgsLength = 1;\n      overrideMethod = \"setBlockMessage\";\n      break;\n  }\n  var computedArgs = [];\n  if (baseArgsLength > 0) {\n    computedArgs = argsFactory(args, runtimeContext, event, {\n      useEventDetailAsDefault: true\n    });\n    computedArgs.length = baseArgsLength;\n  }\n  if (hasCallback && callback) {\n    var callbackFactory = eventCallbackFactory(callback, runtimeContext, undefined);\n    computedArgs.push(blocked => {\n      callbackFactory(blocked ? \"error\" : \"success\")({\n        blocked\n      });\n      callbackFactory(\"finally\")({\n        blocked\n      });\n    });\n  }\n  getHistory()[overrideMethod](...computedArgs);\n}\nfunction handleWindowAction(event, args, runtimeContext) {\n  var [url, target, features] = argsFactory(args, runtimeContext, event);\n  window.open(url, target || \"_self\", features);\n}\nfunction batchUpdate(args, batch, method, store, runtimeContext, event) {\n  if (batch) {\n    store.updateValues(args, method, arg => {\n      return argsFactory(arg, runtimeContext, event)[0];\n    });\n  } else {\n    args.forEach(arg => {\n      var {\n        name,\n        value\n      } = argsFactory([arg], runtimeContext, event)[0];\n      store.updateValue(name, value, method);\n    });\n  }\n}\nfunction handleContextAction(event, method, args, batch, callback, runtimeContext) {\n  var isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && (method === \"assign\" || method === \"replace\")) {\n    batchUpdate(args, batch, method, runtimeContext.ctxStore, runtimeContext, event);\n  } else {\n    var [name, value] = argsFactory(args, runtimeContext, event);\n    runtimeContext.ctxStore.updateValue(name, value, method, callback, runtimeContext);\n  }\n}\nfunction handleTplStateAction(event, method, args, batch, callback, runtimeContext) {\n  var isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && method === \"update\") {\n    var tplStateStore = getTplStateStore(runtimeContext, \"state.\".concat(method), \": \".concat(JSON.stringify(args)));\n    batchUpdate(args, batch, \"replace\", tplStateStore, runtimeContext, event);\n  } else {\n    var [name, value] = argsFactory(args, runtimeContext, event);\n    var _tplStateStore = getTplStateStore(runtimeContext, \"state.\".concat(method), \": \".concat(name));\n    _tplStateStore.updateValue(name, value, method === \"update\" ? \"replace\" : method, callback, runtimeContext);\n  }\n}\nfunction handleFormStateAction(event, args, callback, runtimeContext) {\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  var formStateStore = getFormStateStore(runtimeContext, \"formstate.update\", \": \".concat(name));\n  formStateStore.updateValue(name, value, \"replace\", callback, runtimeContext);\n}\nfunction handleLocationAction(event, method, args, runtimeContext) {\n  if (method === \"assign\") {\n    var [url] = argsFactory(args, runtimeContext, event);\n    location.assign(url);\n  } else {\n    location[method]();\n  }\n}\nfunction handleStorageAction(event, object, method, args, runtimeContext) {\n  var storage = object === \"localStorage\" ? localStorage : sessionStorage;\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  if (method === \"setItem\") {\n    if (value !== undefined) {\n      storage.setItem(name, JSON.stringify(value));\n    }\n  } else {\n    storage.removeItem(name);\n  }\n}\nfunction handleConsoleAction(event, method, args, runtimeContext) {\n  // eslint-disable-next-line no-console\n  console[method](...argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  }));\n}\nfunction handleMessageAction(event, method, args, runtimeContext) {\n  var computedArgs = argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  });\n  Notification.show({\n    type: method,\n    message: computedArgs[0]\n  });\n}\nfunction handleMessageDispatcher(_x12, _x13, _x14, _x15, _x16, _x17) {\n  return _handleMessageDispatcher.apply(this, arguments);\n}\nfunction _handleMessageDispatcher() {\n  _handleMessageDispatcher = _asyncToGenerator(function* (event, method, args, runtimeContext, runtimeBrick, callback) {\n    var task = () => {\n      var _hooks$messageDispatc;\n      var computedArgs = argsFactory(args, runtimeContext, event);\n      return hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 ? void 0 : _hooks$messageDispatc[method](...computedArgs);\n    };\n    if (!callback) {\n      task();\n      return;\n    }\n    var callbackFactory = eventCallbackFactory(callback, runtimeContext, runtimeBrick);\n    try {\n      var result = yield task();\n      callbackFactory(\"success\")(result);\n    } catch (error) {\n      callbackFactory(\"error\")(error);\n    } finally {\n      callbackFactory(\"finally\")();\n    }\n  });\n  return _handleMessageDispatcher.apply(this, arguments);\n}\nexport function eventCallbackFactory(callback, runtimeContext, runtimeBrick) {\n  return function callbackFactory(type) {\n    return function (result) {\n      var handlers = callback === null || callback === void 0 ? void 0 : callback[type];\n      if (handlers) {\n        try {\n          var event = new CustomEvent(\"callback.\".concat(type), {\n            detail: result\n          });\n          listenerFactory(handlers, runtimeContext, runtimeBrick)(event);\n        } catch (err) {\n          // Do not throw errors in `callback.success` or `callback.progress`,\n          // to avoid the following triggering of `callback.error`.\n          // eslint-disable-next-line\n          console.error(err);\n        }\n      } else if (type === \"error\") {\n        // eslint-disable-next-line\n        console.error(\"Unhandled callback error:\", result);\n      }\n    };\n  };\n}\nfunction argsFactory(args, runtimeContext, event) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return Array.isArray(args) ? computeRealValue(args, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n    event\n  })) : options.useEventAsDefault ? [event] : options.useEventDetailAsDefault ? [event.detail] : [];\n}\n//# sourceMappingURL=bindListeners.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport EventTarget from \"@ungap/event-target\";\nimport { eventCallbackFactory, listenerFactory } from \"../bindListeners.js\";\nimport { asyncCheckIf } from \"../compute/checkIf.js\";\nimport { asyncComputeRealValue, computeRealValue } from \"../compute/computeRealValue.js\";\nimport { resolveData } from \"./resolveData.js\";\nimport { resolveDataStore } from \"./resolveDataStore.js\";\nimport { handleHttpError } from \"../../handleHttpError.js\";\nimport { computePropertyValue } from \"../compute/computeRealProperties.js\";\nvar supportContextResolveTriggerBrickLifeCycle = [\"onBeforePageLoad\", \"onPageLoad\", \"onBeforePageLeave\", \"onPageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nexport class DataStore {\n  // 把 `rendererContext` 放在参数列表的最后，并作为可选，以减少测试文件的调整\n  constructor(type, hostBrick, rendererContext) {\n    _defineProperty(this, \"type\", void 0);\n    _defineProperty(this, \"data\", new Map());\n    _defineProperty(this, \"changeEventType\", void 0);\n    _defineProperty(this, \"pendingStack\", []);\n    _defineProperty(this, \"hostBrick\", void 0);\n    _defineProperty(this, \"batchUpdate\", false);\n    _defineProperty(this, \"batchUpdateContextsNames\", []);\n    _defineProperty(this, \"rendererContext\", void 0);\n    _defineProperty(this, \"routeMap\", new WeakMap());\n    this.type = type;\n    this.changeEventType = this.type === \"FORM_STATE\" ? \"formstate.change\" : this.type === \"STATE\" ? \"state.change\" : \"context.change\";\n    this.hostBrick = hostBrick;\n    this.rendererContext = rendererContext;\n  }\n  getAllValues() {\n    return Object.fromEntries([...this.data.entries()].map(_ref => {\n      var [name, {\n        value\n      }] = _ref;\n      return [name, value];\n    }));\n  }\n  getValue(name) {\n    var _this$data$get;\n    return (_this$data$get = this.data.get(name)) === null || _this$data$get === void 0 ? void 0 : _this$data$get.value;\n  }\n  getAffectListByContext(name) {\n    var affectNames = [name];\n    this.data.forEach((value, key) => {\n      if (value.deps) {\n        var isInDeps = value.deps.some(item => affectNames.includes(item));\n        isInDeps && affectNames.push(key) && affectNames.push(...this.getAffectListByContext(key));\n      }\n    });\n    affectNames.shift();\n    return [...new Set(affectNames)];\n  }\n  updateValues(values, method, argsFactory) {\n    this.batchUpdate = true;\n    this.batchUpdateContextsNames = values.map(item => item.name);\n    if ([...new Set(this.batchUpdateContextsNames)].length !== this.batchUpdateContextsNames.length) {\n      throw new Error(\"Batch update not allow to update same item\");\n    }\n    var updateContexts = {};\n    var affectContexts = {};\n    var affectDepsContextNames = [];\n    values.forEach(arg => {\n      var {\n        name,\n        value\n      } = argsFactory([arg]);\n      var updateContextItem = this.data.get(name);\n      affectDepsContextNames.push(...this.getAffectListByContext(name));\n      updateContextItem && (updateContexts[name] = updateContextItem);\n      this.updateValue(name, value, method);\n    });\n    affectDepsContextNames.filter(item => !updateContexts[item]).forEach(name => {\n      var affectContextItem = this.data.get(name);\n      affectContextItem && (affectContexts[name] = affectContextItem);\n    });\n    var triggerEvent = contexts => {\n      for (var key in contexts) {\n        var _context$eventTarget;\n        var context = contexts[key];\n        (_context$eventTarget = context.eventTarget) === null || _context$eventTarget === void 0 || _context$eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n          detail: context.value\n        }));\n      }\n    };\n    triggerEvent(updateContexts);\n    triggerEvent(affectContexts);\n    this.batchUpdate = false;\n    return;\n  }\n  updateValue(name, value, method, callback, callbackRuntimeContext) {\n    var item = this.data.get(name);\n    if (!item) {\n      throw new Error(\"\".concat(this.type, \" '\").concat(name, \"' is not defined\"));\n    }\n    if (method === \"refresh\" || method === \"load\") {\n      if (!item.load) {\n        throw new Error(\"You can not \".concat(method, \" \\\"\").concat(this.type, \".\").concat(name, \"\\\" which has no resolve\"));\n      }\n      var promise;\n      if (method === \"load\") {\n        // Try to reuse previous request when calling `load`.\n        if (item.loaded) {\n          promise = Promise.resolve(item.value);\n        } else if (item.loading) {\n          promise = item.loading;\n        }\n      }\n      if (!promise) {\n        promise = item.loading = item.load(_objectSpread({\n          cache: method === \"load\" ? \"default\" : \"reload\"\n        }, value));\n        // Do not use the chained promise, since the callbacks need the original promise.\n        promise.then(val => {\n          item.loaded = true;\n          item.value = val;\n          item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n            detail: item.value\n          }));\n        }, err => {\n          // Let users override error handling.\n          if (!(callback !== null && callback !== void 0 && callback.error)) {\n            handleHttpError(err);\n          }\n        });\n      }\n      if (callback) {\n        var callbackFactory = eventCallbackFactory(callback, callbackRuntimeContext);\n        promise.then(val => {\n          callbackFactory(\"success\")({\n            value: val\n          });\n          callbackFactory(\"finally\")();\n        }, err => {\n          callbackFactory(\"error\")(err);\n          callbackFactory(\"finally\")();\n        });\n      }\n      return;\n    }\n    if (method === \"replace\") {\n      item.value = value;\n    } else {\n      if (isObject(item.value)) {\n        Object.assign(item.value, value);\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn(\"Non-object current value of \\\"\".concat(this.type, \".\").concat(name, \"\\\" for \\\"context.assign\\\", try \\\"context.replace\\\" instead.\"));\n        item.value = value;\n      }\n    }\n    if (this.batchUpdate) return;\n    item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n      detail: item.value\n    }));\n  }\n  define(dataConfs, runtimeContext, asyncHostPropertyEntries, routePath) {\n    if (Array.isArray(dataConfs) && dataConfs.length > 0) {\n      var pending = resolveDataStore(dataConfs, dataConf => this.resolve(dataConf, runtimeContext, asyncHostPropertyEntries, routePath), this.type);\n      this.pendingStack.push(pending);\n    }\n  }\n  onChange(dataName, listener) {\n    var _this$data$get2;\n    (_this$data$get2 = this.data.get(dataName)) === null || _this$data$get2 === void 0 || _this$data$get2.eventTarget.addEventListener(this.changeEventType, listener);\n  }\n  waitFor(dataNames) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _loop = function* (pendingContexts) {\n        yield Promise.all([...dataNames].map(ctx => {\n          var p = pendingContexts.get(ctx);\n          return p;\n        }));\n      };\n      for (var {\n        pendingContexts\n      } of _this.pendingStack) {\n        yield* _loop(pendingContexts);\n      }\n    })();\n  }\n  waitForAll() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      // Silent each pending contexts, since the error is handled by batched `pendingResult`\n      for (var {\n        pendingContexts\n      } of _this2.pendingStack) {\n        for (var p of pendingContexts.values()) {\n          p.catch(() => {\n            /* No-op */\n          });\n        }\n      }\n      for (var {\n        pendingResult\n      } of _this2.pendingStack) {\n        yield pendingResult;\n      }\n    })();\n  }\n\n  /**\n   * After mount, dispatch the change event when an async data is loaded.\n   *\n   * If param `route` is present, handle data defined in that route (or its descendants) only.\n   */\n  mountAsyncData(route) {\n    this.data.forEach(item => {\n      var _this$routeMap$get;\n      if (item.async && (!route || (_this$routeMap$get = this.routeMap.get(route)) !== null && _this$routeMap$get !== void 0 && _this$routeMap$get.has(item.name))) {\n        // istanbul ignore next\n        if (item.asyncMounted) {\n          // eslint-disable-next-line no-console\n          console.error(\"Async data \\\"\".concat(item.name, \"\\\" already mounted. This is a bug of Brick Next, please report it.\"));\n          return;\n        }\n        item.asyncMounted = true;\n        // An async data always has `loading`\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        item.loading.then(value => {\n          item.loaded = true;\n          item.value = value;\n          item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n            detail: value\n          }));\n        });\n      }\n    });\n  }\n  resolve(dataConf, runtimeContext, asyncHostPropertyEntries, routePath) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!(yield asyncCheckIf(dataConf, runtimeContext))) {\n        return false;\n      }\n      var value;\n      if (asyncHostPropertyEntries && (_this3.type === \"STATE\" ? dataConf.expose : _this3.type === \"FORM_STATE\")) {\n        value = yield computePropertyValue(asyncHostPropertyEntries, dataConf.name);\n      }\n      var load;\n      var loading;\n      var resolvePolicy = \"eager\";\n      if (value === undefined) {\n        if (dataConf.resolve) {\n          var resolveConf = _objectSpread({\n            transform: \"value\"\n          }, dataConf.resolve);\n          if (yield asyncCheckIf(dataConf.resolve, runtimeContext)) {\n            load = /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator(function* (options) {\n                return (yield resolveData(resolveConf, runtimeContext, options)).value;\n              });\n              return function load(_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }();\n            // `async` take precedence over `lazy`\n            resolvePolicy = dataConf.resolve.async ? \"async\" : dataConf.resolve.lazy ? \"lazy\" : \"eager\";\n            if (resolvePolicy === \"eager\") {\n              value = yield load();\n            } else if (resolvePolicy === \"async\") {\n              loading = load();\n            }\n          } else if (!hasOwnProperty(dataConf, \"value\")) {\n            return false;\n          }\n        }\n        if ((!load || resolvePolicy !== \"eager\") && dataConf.value !== undefined) {\n          // If the context has no resolve, just use its `value`.\n          // Or if the resolve is ignored or lazy, use its `value` as a fallback.\n          value = yield asyncComputeRealValue(dataConf.value, runtimeContext);\n        }\n      }\n      var newData = {\n        name: dataConf.name,\n        value,\n        // This is required for tracking context, even if no `onChange` is specified.\n        eventTarget: new EventTarget(),\n        load,\n        loaded: resolvePolicy === \"eager\",\n        loading,\n        async: resolvePolicy === \"async\",\n        deps: []\n      };\n      if (resolvePolicy === \"lazy\") {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        var {\n          trigger\n        } = dataConf.resolve;\n        if (trigger && supportContextResolveTriggerBrickLifeCycle.includes(trigger)) {\n          var _this3$rendererContex;\n          (_this3$rendererContex = _this3.rendererContext) === null || _this3$rendererContex === void 0 || _this3$rendererContex.registerArbitraryLifeCycle(trigger, () => {\n            _this3.updateValue(dataConf.name, undefined, \"load\");\n          });\n        }\n      }\n      if (dataConf.onChange) {\n        newData.eventTarget.addEventListener(_this3.changeEventType, listenerFactory(dataConf.onChange, runtimeContext));\n      }\n      if (dataConf.track) {\n        var deps = strictCollectMemberUsage(load ? dataConf.resolve : dataConf.value, _this3.type);\n        !load && (newData.deps = [...deps]);\n        for (var dep of deps) {\n          _this3.onChange(dep, _this3.batchAddListener(() => {\n            if (load) {\n              _this3.updateValue(dataConf.name, {\n                cache: \"default\"\n              }, \"refresh\");\n            } else {\n              _this3.updateValue(dataConf.name, computeRealValue(dataConf.value, runtimeContext), \"replace\");\n            }\n          }, dataConf));\n        }\n      }\n      if (_this3.data.has(dataConf.name)) {\n        throw new Error(\"\".concat(_this3.type, \" '\").concat(dataConf.name, \"' has already been declared\"));\n      }\n      _this3.data.set(dataConf.name, newData);\n      if (Array.isArray(routePath)) {\n        for (var route of routePath) {\n          var names = _this3.routeMap.get(route);\n          if (names) {\n            names.add(dataConf.name);\n          } else {\n            _this3.routeMap.set(route, new Set([dataConf.name]));\n          }\n        }\n      }\n      return true;\n    })();\n  }\n  disposeDataInRoutes(routes) {\n    for (var route of routes) {\n      var names = this.routeMap.get(route);\n      if (names !== undefined) {\n        for (var name of names) {\n          this.data.delete(name);\n        }\n      }\n    }\n  }\n  batchAddListener(listener, contextConf) {\n    return event => {\n      if (this.batchUpdate && this.batchUpdateContextsNames.includes(contextConf.name)) {\n        return;\n      }\n      listener(event);\n    };\n  }\n}\n//# sourceMappingURL=DataStore.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { collectMemberUsage } from \"@next-core/utils/storyboard\";\nexport function resolveDataStore(contextConfs, resolveContext) {\n  var keyword = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"CTX\";\n  var dependencyMap = getDependencyMapOfContext(contextConfs, keyword);\n  // There maybe multiple context confs for a specific name, since there are conditional contexts.\n  // This is a map of how many pending context confs for each context name.\n  var pendingDeps = new Map();\n  for (var contextName of Array.from(dependencyMap.keys()).map(contextConf => contextConf.name)) {\n    var _pendingDeps$get;\n    pendingDeps.set(contextName, ((_pendingDeps$get = pendingDeps.get(contextName)) !== null && _pendingDeps$get !== void 0 ? _pendingDeps$get : 0) + 1);\n  }\n  var hasNonStaticUsage = Array.from(dependencyMap.values()).some(stats => stats.hasNonStaticUsage);\n  var processed = new WeakSet();\n  var deferredContexts = new Map();\n  var pendingContexts = new Map([...new Set(contextConfs.map(contextConf => contextConf.name))].map(contextName => [contextName, new Promise((resolve, reject) => {\n    deferredContexts.set(contextName, {\n      resolve,\n      reject\n    });\n  })]));\n  var wrapResolve = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (contextConf) {\n      var _pendingDeps$get2;\n      processed.add(contextConf);\n      var resolved = yield resolveContext(contextConf);\n      dependencyMap.delete(contextConf);\n      var left = (_pendingDeps$get2 = pendingDeps.get(contextConf.name)) !== null && _pendingDeps$get2 !== void 0 ? _pendingDeps$get2 : 0;\n      if (resolved) {\n        // Assert: contextConf.name exists in deferredContexts\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        deferredContexts.get(contextConf.name).resolve();\n        pendingDeps.delete(contextConf.name);\n        if (left === 0) {\n          throw new Error(\"Duplicated context defined: \".concat(contextConf.name));\n        }\n      } else {\n        // Assert: left >= 1\n        if (left === 1) {\n          // Assert: contextConf.name exists in deferredContexts\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          deferredContexts.get(contextConf.name).resolve();\n          pendingDeps.delete(contextConf.name);\n        } else {\n          pendingDeps.set(contextConf.name, left - 1);\n        }\n      }\n      yield scheduleNext();\n    });\n    return function wrapResolve(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var scheduleAsSerial = hasNonStaticUsage;\n  function scheduleNext() {\n    return _scheduleNext.apply(this, arguments);\n  }\n  function _scheduleNext() {\n    _scheduleNext = _asyncToGenerator(function* () {\n      var readyContexts = Array.from(dependencyMap.entries()).filter(predicateNextResolveFactory(pendingDeps, scheduleAsSerial)).map(entry => entry[0]).filter(contextConf => !processed.has(contextConf));\n      yield Promise.all(readyContexts.map(wrapResolve));\n    });\n    return _scheduleNext.apply(this, arguments);\n  }\n  var pendingResult = scheduleNext().then( /*#__PURE__*/_asyncToGenerator(function* () {\n    // If there are still contexts left, it implies one of these situations:\n    //   - Circular contexts.\n    //     Such as: a depends on b, while b depends on a.\n    //   - Related contexts are all ignored.\n    //     Such as: a depends on b,\n    //     while both them are ignore by a falsy result of `if`.\n    if (dependencyMap.size > 0) {\n      // This will throw if circular contexts detected.\n      detectCircularContexts(dependencyMap, keyword);\n      scheduleAsSerial = true;\n      yield scheduleNext();\n    }\n    // There maybe ignored contexts which are still not fulfilled.\n    // We treat them as RESOLVED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.resolve();\n    }\n  })).catch(error => {\n    // There maybe contexts left not fulfilled, when an error occurred.\n    // We treat them as REJECTED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.reject(error);\n    }\n    throw error;\n  });\n  return {\n    pendingResult,\n    pendingContexts\n  };\n}\nfunction predicateNextResolveFactory(pendingDeps, scheduleAsSerial) {\n  return (entry, index) =>\n  // When contexts contain computed CTX accesses, it implies a dynamic dependency map.\n  // So make them process sequentially, keep the same behavior as before.\n  scheduleAsSerial ? index === 0 :\n  // A context is ready when it has no pending dependencies.\n  ![...entry[1].usedProperties].some(dep => pendingDeps.has(dep));\n}\nexport function getDependencyMapOfContext(contextConfs) {\n  var keyword = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"CTX\";\n  var depsMap = new Map();\n  for (var _contextConf of contextConfs) {\n    var stats = collectMemberUsage([_contextConf.if, _contextConf.value, _contextConf.resolve], keyword);\n    depsMap.set(_contextConf, stats);\n  }\n  return depsMap;\n}\nfunction detectCircularContexts(dependencyMap, keyword) {\n  var duplicatedMap = new Map(dependencyMap);\n  var pendingDeps = new Set(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name));\n  var next = () => {\n    var processedAtLeastOne = false;\n    for (var [_contextConf2, stats] of duplicatedMap.entries()) {\n      if (![...stats.usedProperties].some(dep => pendingDeps.has(dep))) {\n        duplicatedMap.delete(_contextConf2);\n        pendingDeps.delete(_contextConf2.name);\n        processedAtLeastOne = true;\n      }\n    }\n    if (processedAtLeastOne) {\n      next();\n    }\n  };\n  next();\n  if (duplicatedMap.size > 0) {\n    throw new ReferenceError(\"Circular \".concat(keyword, \" detected: \").concat(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name).join(\", \")));\n  }\n}\n//# sourceMappingURL=resolveDataStore.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { clamp } from \"lodash\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachIndex, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./constants.js\";\nimport { computePropertyValue } from \"../compute/computeRealProperties.js\";\nexport function setupTemplateProxy(hostContext, ref, slots) {\n  var {\n    reversedProxies,\n    asyncHostPropertyEntries,\n    externalSlots,\n    tplStateStoreId,\n    hostBrick\n  } = hostContext;\n  var asyncComputedProps;\n  if (ref && reversedProxies) {\n    var propertyProxies = reversedProxies.properties.get(ref);\n    if (propertyProxies) {\n      var getComputedProps = asyncHostProps => {\n        return propertyProxies.map(_ref => {\n          var {\n            from,\n            to\n          } = _ref;\n          var filtered = asyncHostProps.filter(entry => entry[0] === from);\n          if (filtered.length > 0 && to.refProperty) {\n            return [to.refProperty, computePropertyValue(filtered, from), true];\n          }\n        }).filter(Boolean);\n      };\n      asyncComputedProps = getComputedProps(asyncHostPropertyEntries);\n    }\n    var slotProxies = reversedProxies.slots.get(ref);\n    if (slotProxies && externalSlots) {\n      // Use an approach like template-literal's quasis:\n      // `quasi0${0}quais1${1}quasi2...`\n      // Every quasi (indexed by `refPosition`) can be slotted with multiple bricks.\n      var quasisMap = new Map();\n      for (var {\n        from,\n        to\n      } of slotProxies) {\n        var _externalSlots$from$b, _externalSlots$from, _to$refSlot, _to$refPosition;\n        var insertBricks = (_externalSlots$from$b = (_externalSlots$from = externalSlots[from]) === null || _externalSlots$from === void 0 ? void 0 : _externalSlots$from.bricks) !== null && _externalSlots$from$b !== void 0 ? _externalSlots$from$b : [];\n        if (!insertBricks.length) {\n          continue;\n        }\n        var refToSlot = (_to$refSlot = to.refSlot) !== null && _to$refSlot !== void 0 ? _to$refSlot : from;\n        var expandableSlot = quasisMap.get(refToSlot);\n        if (!expandableSlot) {\n          expandableSlot = [];\n          // The size of quasis should be the existed slotted bricks' size plus one.\n          var size = hasOwnProperty(slots, refToSlot) ? slots[refToSlot].bricks.length + 1 : 1;\n          for (var i = 0; i < size; i += 1) {\n            expandableSlot.push([]);\n          }\n          quasisMap.set(refToSlot, expandableSlot);\n        }\n        var refPosition = (_to$refPosition = to.refPosition) !== null && _to$refPosition !== void 0 ? _to$refPosition : -1;\n        expandableSlot[clamp(refPosition < 0 ? expandableSlot.length + refPosition : refPosition, 0, expandableSlot.length - 1)].push(...(hasOwnProperty(hostBrick.runtimeContext, \"forEachItem\") ? setupTemplateExternalBricks(insertBricks, hostBrick.runtimeContext.forEachItem, hostBrick.runtimeContext.forEachIndex) : insertBricks));\n      }\n      var _loop = function () {\n        if (!hasOwnProperty(slots, slotName)) {\n          slots[slotName] = {\n            type: \"bricks\",\n            bricks: []\n          };\n        }\n        var slotConf = slots[slotName];\n        slotConf.bricks = quasis.flatMap((bricks, index) => index < slotConf.bricks.length ? bricks.concat(slotConf.bricks[index]) : bricks);\n        if (slotConf.bricks.length === 0) {\n          delete slots[slotName];\n        }\n      };\n      for (var [slotName, quasis] of quasisMap.entries()) {\n        _loop();\n      }\n    }\n  }\n  return {\n    [symbolForAsyncComputedPropsFromHost]: asyncComputedProps,\n    [symbolForTplStateStoreId]: tplStateStoreId\n  };\n}\n\n// External bricks of a template, have the same forEachItem context as their host.\nfunction setupTemplateExternalBricks(bricks, forEachItem, forEachIndex) {\n  return bricks.map(brick => {\n    var _brick$slots;\n    return _objectSpread(_objectSpread({}, brick), {}, {\n      [symbolForTPlExternalForEachItem]: forEachItem,\n      [symbolForTPlExternalForEachIndex]: forEachIndex,\n      slots: Object.fromEntries(Object.entries((_brick$slots = brick.slots) !== null && _brick$slots !== void 0 ? _brick$slots : {}).map(_ref2 => {\n        var _slotConf$bricks;\n        var [slotName, slotConf] = _ref2;\n        return [slotName, slotConf.type === \"routes\" ? {\n          type: \"routes\",\n          routes: setupTemplateExternalRoutes(slotConf.routes, forEachItem, forEachIndex)\n        } : {\n          type: \"bricks\",\n          bricks: setupTemplateExternalBricks((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : [], forEachItem, forEachIndex)\n        }];\n      }))\n    });\n  });\n}\nfunction setupTemplateExternalRoutes(routes, forEachItem, forEachIndex) {\n  return routes.map(route => route.type && route.type !== \"bricks\" ? route : _objectSpread(_objectSpread({}, route), {}, {\n    bricks: setupTemplateExternalBricks(route.bricks, forEachItem, forEachIndex)\n  }));\n}\n//# sourceMappingURL=setupTemplateProxy.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"properties\", \"slots\", \"children\"];\nimport { isObject } from \"@next-core/utils/general\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nexport function setupUseBrickInTemplate(props, hostContext) {\n  function walk(props) {\n    if (!isObject(props) || typeof props === \"function\") {\n      return props;\n    }\n    if (Array.isArray(props)) {\n      return props.map(walk);\n    }\n    return Object.fromEntries(Object.entries(props).map(_ref => {\n      var [key, value] = _ref;\n      return isObject(value) && key === \"useBrick\" ? Array.isArray(value) ? [key, value.map(setup)] : [key, setup(value)] : [key, walk(value)];\n    }).concat(Object.getOwnPropertySymbols(props).map(k => [k, props[k]])));\n  }\n  function setup(item) {\n    var {\n        properties,\n        slots: originalSlots,\n        children\n      } = item,\n      restConf = _objectWithoutProperties(item, _excluded);\n    var transpiledSlots = childrenToSlots(children, originalSlots);\n    var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref2 => {\n      var _slotConf$bricks;\n      var [slotName, slotConf] = _ref2;\n      return [slotName, {\n        type: \"bricks\",\n        bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(setup)\n      }];\n    }));\n    return _objectSpread(_objectSpread({}, restConf), {}, {\n      properties: walk(properties),\n      slots\n    }, setupTemplateProxy(hostContext, restConf.ref, slots));\n  }\n  return walk(props);\n}\n//# sourceMappingURL=setupUseBrickInTemplate.js.map","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nvar _excluded = [\"slots\", \"children\"],\n  _excluded2 = [\"properties\", \"slots\", \"children\"];\nimport { uniqueId } from \"lodash\";\nimport { customTemplates } from \"../../CustomTemplates.js\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { setupUseBrickInTemplate } from \"./setupUseBrickInTemplate.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nimport { hooks } from \"../Runtime.js\";\nexport function expandCustomTemplate(tplTagName, brickConf, hostBrick, asyncHostPropertyEntries, rendererContext) {\n  var _hooks$flowApi;\n  var tplStateStoreId = uniqueId(\"tpl-state-\");\n  var runtimeContext = _objectSpread(_objectSpread({}, hostBrick.runtimeContext), {}, {\n    tplStateStoreId\n  });\n\n  // There is a boundary for `forEachItem` and `FORM_STATE` between template internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.forEachIndex;\n  delete runtimeContext.formStateStoreId;\n  var tplStateStore = new DataStore(\"STATE\", hostBrick, rendererContext);\n  runtimeContext.tplStateStoreMap.set(tplStateStoreId, tplStateStore);\n  if (runtimeContext.tplStateStoreScope) {\n    runtimeContext.tplStateStoreScope.push(tplStateStore);\n  }\n  var {\n    bricks,\n    proxy,\n    state,\n    contracts\n  } = customTemplates.get(tplTagName);\n  hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 || _hooks$flowApi.collectWidgetContract(contracts);\n  tplStateStore.define(state, runtimeContext, asyncHostPropertyEntries);\n  var {\n      slots: originalExternalSlots,\n      children: externalChildren\n    } = brickConf,\n    restBrickConf = _objectWithoutProperties(brickConf, _excluded);\n  var newBrickConf = _objectSpread(_objectSpread({}, restBrickConf), {}, {\n    brick: tplTagName\n  });\n  hostBrick.tplHostMetadata = {\n    internalBricksByRef: new Map(),\n    tplStateStoreId,\n    proxy\n  };\n\n  // Reversed proxies are used for expand storyboard before rendering page.\n  var reversedProxies = {\n    properties: new Map(),\n    slots: new Map()\n    // mergeBases: new Map(),\n  };\n\n  if (proxy !== null && proxy !== void 0 && proxy.properties) {\n    for (var [from, to] of Object.entries(proxy.properties)) {\n      var proxies = reversedProxies.properties.get(to.ref);\n      if (!proxies) {\n        proxies = [];\n        reversedProxies.properties.set(to.ref, proxies);\n      }\n      proxies.push({\n        from,\n        to\n      });\n    }\n  }\n  if (proxy !== null && proxy !== void 0 && proxy.slots) {\n    for (var [_from, _to] of Object.entries(proxy.slots)) {\n      var _proxies = reversedProxies.slots.get(_to.ref);\n      if (!_proxies) {\n        _proxies = [];\n        reversedProxies.slots.set(_to.ref, _proxies);\n      }\n      _proxies.push({\n        from: _from,\n        to: _to\n      });\n    }\n  }\n  var hostContext = {\n    reversedProxies,\n    asyncHostPropertyEntries,\n    externalSlots: childrenToSlots(externalChildren, originalExternalSlots),\n    tplStateStoreId,\n    hostBrick: hostBrick\n  };\n  newBrickConf.slots = {\n    \"\": {\n      type: \"bricks\",\n      bricks: bricks.map(item => expandBrickInTemplate(item, hostContext))\n    }\n  };\n  return newBrickConf;\n}\nfunction expandBrickInTemplate(brickConfInTemplate, hostContext) {\n  // Ignore `if: null` to make `looseCheckIf` working.\n  if (brickConfInTemplate.if === null) {\n    delete brickConfInTemplate.if;\n  }\n  var {\n      properties,\n      slots: slotsInTemplate,\n      children: childrenInTemplate\n    } = brickConfInTemplate,\n    restBrickConfInTemplate = _objectWithoutProperties(brickConfInTemplate, _excluded2);\n  var transpiledSlots = childrenToSlots(childrenInTemplate, slotsInTemplate);\n  var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref => {\n    var _slotConf$bricks;\n    var [slotName, slotConf] = _ref;\n    return [slotName, {\n      type: \"bricks\",\n      bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(item => expandBrickInTemplate(item, hostContext))\n    }];\n  }));\n  return _objectSpread(_objectSpread({}, restBrickConfInTemplate), {}, {\n    properties: setupUseBrickInTemplate(properties, hostContext),\n    slots\n  }, setupTemplateProxy(hostContext, restBrickConfInTemplate.ref, slots));\n}\n//# sourceMappingURL=expandCustomTemplate.js.map","export var RenderTag = /*#__PURE__*/function (RenderTag) {\n  RenderTag[RenderTag[\"ROOT\"] = 1] = \"ROOT\";\n  RenderTag[RenderTag[\"BRICK\"] = 2] = \"BRICK\";\n  RenderTag[RenderTag[\"PLACEHOLDER\"] = 3] = \"PLACEHOLDER\";\n  return RenderTag;\n}({});\n//# sourceMappingURL=enums.js.map","export var FORM_RENDERER = \"form-renderer.form-renderer\";\nexport var symbolForFormStateStoreId = Symbol.for(\"form.stateStoreId\");\n//# sourceMappingURL=constants.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { uniqueId } from \"lodash\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { getDefaultProperties } from \"./getDefaultProperties.js\";\nimport { symbolForFormStateStoreId } from \"./constants.js\";\nvar formContainers = [\"forms.general-form\", \"form.general-form\", \"eo-form\"];\nexport function expandFormRenderer(formData, hostBrickConf, hostBrick, asyncHostPropertyEntries, rendererContext) {\n  var _normalizedFormData$c, _hostBrickConf$proper;\n  var normalizedFormData = typeof formData === \"string\" ? JSON.parse(formData) : formData;\n  var formStateStoreId = uniqueId(\"form-state-\");\n  var runtimeContext = _objectSpread(_objectSpread({}, hostBrick.runtimeContext), {}, {\n    formStateStoreId\n  });\n\n  // There is a boundary for `forEachItem` and `STATE` between form internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.forEachIndex;\n  delete runtimeContext.tplStateStoreId;\n  var formStateStore = new DataStore(\"FORM_STATE\", undefined, rendererContext);\n  runtimeContext.formStateStoreMap.set(formStateStoreId, formStateStore);\n  if (runtimeContext.formStateStoreScope) {\n    runtimeContext.formStateStoreScope.push(formStateStore);\n  }\n\n  // Always add a state of `params`.\n  var context = (_normalizedFormData$c = normalizedFormData.context) !== null && _normalizedFormData$c !== void 0 ? _normalizedFormData$c : [];\n  if (!context.some(ctx => ctx.name === \"params\")) {\n    context.push({\n      name: \"params\"\n    });\n  }\n  formStateStore.define(context, runtimeContext, asyncHostPropertyEntries);\n  var formConf = formSchemaToBrick(normalizedFormData.formSchema, normalizedFormData.fields, formStateStoreId);\n  if (formContainers.includes(formConf.brick) && hostBrickConf.events) {\n    formConf.events = mergeEvents(formConf.events, hostBrickConf.events);\n  }\n  var renderRoot = typeof ((_hostBrickConf$proper = hostBrickConf.properties) === null || _hostBrickConf$proper === void 0 ? void 0 : _hostBrickConf$proper.renderRoot) !== \"boolean\" || hostBrickConf.properties.renderRoot;\n  if (renderRoot) {\n    return _objectSpread(_objectSpread({}, hostBrickConf), {}, {\n      slots: undefined,\n      children: [{\n        brick: \"eo-micro-view\",\n        properties: {\n          style: {\n            padding: \"12px\"\n          }\n        },\n        children: [formConf]\n      }]\n    });\n  }\n  return _objectSpread(_objectSpread({}, hostBrickConf), {}, {\n    slots: undefined,\n    children: [formConf]\n  });\n}\nfunction formSchemaToBrick(schema, fields, formStateStoreId) {\n  var {\n    id,\n    bricks,\n    events,\n    context,\n    mountPoint,\n    instanceId: iid\n  } = schema;\n  var {\n    brick,\n    properties\n  } = schema;\n\n  // 根据字段类型获取默认配置\n  var field = fields.find(item => item.fieldId === id);\n  if (field) {\n    var defaults = getDefaultProperties(field);\n    if (!brick) {\n      brick = defaults.brick;\n    }\n    properties = _objectSpread(_objectSpread({}, defaults.properties), properties);\n  }\n  var brickConf = {\n    brick,\n    properties,\n    iid,\n    slot: mountPoint,\n    events,\n    context,\n    children: formSchemasToBricks(bricks, fields, formStateStoreId),\n    [symbolForFormStateStoreId]: formStateStoreId\n  };\n  if (hasOwnProperty(schema, \"if\")) {\n    brickConf.if = schema.if;\n  }\n  return brickConf;\n}\nfunction formSchemasToBricks(schemas, fields, formStateStoreId) {\n  if (Array.isArray(schemas)) {\n    return schemas.map(schema => formSchemaToBrick(schema, fields, formStateStoreId));\n  }\n}\nfunction mergeEvents(targetEvents, sourceEvents) {\n  var events = targetEvents !== null && targetEvents !== void 0 ? targetEvents : {};\n  for (var [eventType, handlers] of Object.entries(sourceEvents)) {\n    events[eventType] = hasOwnProperty(events, eventType) ? [events[eventType], handlers].flat() : handlers;\n  }\n  return events;\n}\n//# sourceMappingURL=expandFormRenderer.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nexport function getDefaultProperties(field) {\n  var defaultValue;\n  var commonProps = {\n    id: field.fieldId,\n    name: field.fieldId,\n    label: field.name,\n    dataset: {\n      testid: field.fieldId\n    }\n  };\n  var getReadOnlyAndRequired = () => {\n    var _field$limit, _field$limit2;\n    return {\n      readOnly: (_field$limit = field.limit) === null || _field$limit === void 0 ? void 0 : _field$limit.includes(\"READONLY\"),\n      required: (_field$limit2 = field.limit) === null || _field$limit2 === void 0 ? void 0 : _field$limit2.includes(\"REQUIRED\")\n    };\n  };\n  switch (field.fieldType) {\n    case \"INT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          precision: 0,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"BOOLEAN\":\n      defaultValue = {\n        brick: \"forms.general-switch\",\n        properties: _objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired())\n      };\n      break;\n    case \"FLOAT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"ENUM\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"ENUMS\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          mode: \"multiple\",\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"DATE\":\n    case \"TIME\":\n      defaultValue = {\n        brick: \"forms.general-date-picker\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description\n        })\n      };\n      break;\n    case \"IP\":\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          pattern: \"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))\",\n          message: {\n            pattern: \"输入字符不匹配IP格式\"\n          }\n        })\n      };\n      break;\n    case \"JSON\":\n      defaultValue = {\n        brick: \"forms.general-textarea\",\n        properties: _objectSpread({}, commonProps)\n      };\n      break;\n    case \"ARRAY\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread({}, commonProps)\n      };\n      break;\n    case \"STRUCTURE\":\n    case \"STRUCTURE_ARRAY\":\n      defaultValue = {\n        brick: \"forms.cmdb-instance-select-panel\",\n        properties: _objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired())\n      };\n      break;\n    default:\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description\n        })\n      };\n  }\n  return defaultValue;\n}\n//# sourceMappingURL=getDefaultProperties.js.map","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"blockingList\", \"node\", \"menuRequests\", \"hasTrackingControls\"],\n  _excluded2 = [\"if\", \"permissionsPreCheck\"],\n  _excluded3 = [\"formData\"],\n  _excluded4 = [\"src\"],\n  _excluded5 = [\"href\"];\nimport { enqueueStableLoadBricks, flushStableLoadBricks, loadBricksImperatively, loadProcessorsImperatively, loadScript, loadStyle } from \"@next-core/loader\";\nimport { isTrackAll } from \"@next-core/cook\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport { debounce } from \"lodash\";\nimport { asyncCheckBrickIf } from \"./compute/checkIf.js\";\nimport { asyncComputeRealPropertyEntries, constructAsyncProperties } from \"./compute/computeRealProperties.js\";\nimport { resolveData } from \"./data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nimport { listenOnTrackingContext } from \"./compute/listenOnTrackingContext.js\";\nimport { matchRoute, matchRoutes } from \"./matchRoutes.js\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachIndex, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./CustomTemplates/constants.js\";\nimport { expandCustomTemplate } from \"./CustomTemplates/expandCustomTemplate.js\";\nimport { getTagNameOfCustomTemplate, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { getBrickPackages, hooks } from \"./Runtime.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { getTracks } from \"./compute/getTracks.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { FORM_RENDERER, symbolForFormStateStoreId } from \"./FormRenderer/constants.js\";\nimport { expandFormRenderer } from \"./FormRenderer/expandFormRenderer.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { getPreEvaluatedRaw } from \"./compute/evaluate.js\";\nimport { matchHomepage } from \"./matchStoryboard.js\";\nimport { listenerFactory } from \"./bindListeners.js\";\nexport function renderRoutes(_x, _x2, _x3, _x4, _x5, _x6, _x7) {\n  return _renderRoutes.apply(this, arguments);\n}\nfunction _renderRoutes() {\n  _renderRoutes = _asyncToGenerator(function* (returnNode, routes, _runtimeContext, rendererContext, parentRoutes, slotId, isIncremental) {\n    var matched = yield matchRoutes(routes, _runtimeContext);\n    var output = getEmptyRenderOutput();\n    switch (matched) {\n      case \"missed\":\n        break;\n      case \"unauthenticated\":\n        output.unauthenticated = true;\n        break;\n      default:\n        {\n          var _hooks$checkPermissio;\n          var route = output.route = matched.route;\n          output.path = matched.match.path;\n          var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n            match: matched.match\n          });\n          if (isIncremental) {\n            runtimeContext.ctxStore.disposeDataInRoutes(routes);\n          }\n          var routePath = parentRoutes.concat(route);\n          runtimeContext.ctxStore.define(route.context, runtimeContext, undefined, routePath);\n          runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissionsForBrickOrRoute(route, value => asyncComputeRealValue(value, runtimeContext)));\n\n          // Currently, this is only used for brick size-checking: these bricks\n          // will be loaded before page rendering, but they will NOT be rendered.\n          var {\n            preLoadBricks\n          } = route;\n          if (Array.isArray(preLoadBricks)) {\n            output.blockingList.push(loadBricksImperatively(preLoadBricks, getBrickPackages()));\n          }\n          if (route.type === \"redirect\") {\n            var redirectTo;\n            if (typeof route.redirect === \"string\") {\n              redirectTo = yield asyncComputeRealValue(route.redirect, runtimeContext);\n            } else {\n              var resolved = yield resolveData(_objectSpread({\n                transform: \"redirect\"\n              }, route.redirect), runtimeContext);\n              redirectTo = resolved.redirect;\n            }\n            if (typeof redirectTo !== \"string\") {\n              // eslint-disable-next-line no-console\n              console.error(\"Unexpected redirect result:\", redirectTo);\n              throw new Error(\"Unexpected type of redirect result: \".concat(typeof redirectTo));\n            }\n            output.redirect = {\n              path: redirectTo\n            };\n          } else {\n            var menuRequest = loadMenu(route.menu, runtimeContext);\n            if (menuRequest) {\n              output.menuRequests.push(menuRequest);\n            }\n            if (route.type === \"routes\") {\n              var newOutput = yield renderRoutes(returnNode, route.routes, runtimeContext, rendererContext, routePath, slotId);\n              mergeRenderOutput(output, newOutput);\n            } else {\n              var _newOutput = yield renderBricks(returnNode, route.bricks, runtimeContext, rendererContext, routePath, slotId);\n              mergeRenderOutput(output, _newOutput);\n            }\n            if (returnNode.tag === RenderTag.BRICK) {\n              rendererContext.memoizeMenuRequests(route, output.menuRequests);\n            }\n          }\n        }\n    }\n    return output;\n  });\n  return _renderRoutes.apply(this, arguments);\n}\nexport function renderBricks(_x8, _x9, _x10, _x11, _x12, _x13, _x14, _x15) {\n  return _renderBricks.apply(this, arguments);\n}\nfunction _renderBricks() {\n  _renderBricks = _asyncToGenerator(function* (returnNode, bricks, runtimeContext, rendererContext, parentRoutes, slotId, tplStack, keyPath) {\n    var output = getEmptyRenderOutput();\n    var kPath = keyPath !== null && keyPath !== void 0 ? keyPath : [];\n    // 多个构件并行异步转换，但转换的结果按原顺序串行合并。\n    var rendered = yield Promise.all(bricks.map((brickConf, index) => renderBrick(returnNode, brickConf, runtimeContext, rendererContext, parentRoutes, slotId, kPath.concat(index), tplStack && new Map(tplStack))));\n    rendered.forEach((item, index) => {\n      if (item.hasTrackingControls) {\n        // Memoize a render node before it's been merged.\n        rendererContext.memoize(slotId, kPath.concat(index), item.node, returnNode);\n      }\n      mergeRenderOutput(output, item);\n    });\n    return output;\n  });\n  return _renderBricks.apply(this, arguments);\n}\nexport function renderBrick(_x16, _x17, _x18, _x19, _x20, _x21) {\n  return _renderBrick.apply(this, arguments);\n}\nfunction _renderBrick() {\n  _renderBrick = _asyncToGenerator(function* (returnNode, brickConf, _runtimeContext, rendererContext, parentRoutes, slotId) {\n    var _hooks$checkPermissio2, _runtimeContext$app;\n    var keyPath = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : [];\n    var tplStack = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : new Map();\n    var output = getEmptyRenderOutput();\n    if (!brickConf.brick) {\n      if (brickConf.template) {\n        // eslint-disable-next-line no-console\n        console.error(\"Legacy templates are dropped in v3:\", brickConf);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid brick:\", brickConf);\n      }\n      return output;\n    }\n\n    // Translate `if: \"<%= ... %>\"` to `brick: \":if\", dataSource: \"<%= ... %>\"`.\n    // In other words, translate tracking if expressions to tracking control nodes of `:if`.\n    var {\n        if: brickIf,\n        permissionsPreCheck\n      } = brickConf,\n      restBrickConf = _objectWithoutProperties(brickConf, _excluded2);\n    if (isGeneralizedTrackAll(brickIf)) {\n      return renderBrick(returnNode, _objectSpread({\n        brick: \":if\",\n        dataSource: brickIf,\n        // `permissionsPreCheck` maybe required before computing `if`.\n        permissionsPreCheck,\n        slots: {\n          \"\": {\n            type: \"bricks\",\n            bricks: [restBrickConf]\n          }\n        }\n      }, Object.getOwnPropertySymbols(brickConf).reduce((acc, symbol) => _objectSpread(_objectSpread({}, acc), {}, {\n        [symbol]: brickConf[symbol]\n      }), {})), _runtimeContext, rendererContext, parentRoutes, slotId, keyPath, tplStack);\n    }\n    var tplStateStoreId = brickConf[symbolForTplStateStoreId];\n    var formStateStoreId = brickConf[symbolForFormStateStoreId];\n    var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n      tplStateStoreId,\n      formStateStoreId\n    });\n    if (hasOwnProperty(brickConf, symbolForTPlExternalForEachItem)) {\n      // The external bricks of a template should restore their `forEachItem` and\n      // `forEachIndex` from their host.\n      runtimeContext.forEachItem = brickConf[symbolForTPlExternalForEachItem];\n      runtimeContext.forEachIndex = brickConf[symbolForTPlExternalForEachIndex];\n    }\n    var {\n      context\n    } = brickConf;\n    // istanbul ignore next\n    if (Array.isArray(context) && context.length > 0) {\n      var strict = isStrictMode(runtimeContext);\n      warnAboutStrictMode(strict, \"Defining context on bricks\", \"check your brick:\", brickConf);\n      if (!strict) {\n        runtimeContext.ctxStore.define(context, runtimeContext);\n      }\n    }\n    runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 || (_hooks$checkPermissio2 = hooks.checkPermissions) === null || _hooks$checkPermissio2 === void 0 ? void 0 : _hooks$checkPermissio2.preCheckPermissionsForBrickOrRoute(brickConf, value => asyncComputeRealValue(value, runtimeContext)));\n    if (!(yield asyncCheckBrickIf(brickConf, runtimeContext))) {\n      return output;\n    }\n    var brickName = brickConf.brick;\n    if (brickName.startsWith(\":\")) {\n      var _brickConf$lifeCycle;\n      ensureValidControlBrick(brickName);\n      var {\n        dataSource\n      } = brickConf;\n      var lowerLevelRenderControlNode = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (runtimeContext) {\n          var _slots$slot;\n          // First, compute the `dataSource`\n          var computedDataSource = yield asyncComputeRealValue(dataSource, runtimeContext);\n\n          // Then, get the matched slot.\n          var slot = brickName === \":forEach\" ? \"\" : brickName === \":switch\" ? String(computedDataSource) : computedDataSource ? \"\" : \"else\";\n\n          // Don't forget to transpile children to slots.\n          var slots = childrenToSlots(brickConf.children, brickConf.slots);\n\n          // Then, get the bricks in that matched slot.\n          var bricks = slots && hasOwnProperty(slots, slot) && ((_slots$slot = slots[slot]) === null || _slots$slot === void 0 ? void 0 : _slots$slot.bricks);\n          if (!Array.isArray(bricks)) {\n            return getEmptyRenderOutput();\n          }\n          switch (brickName) {\n            case \":forEach\":\n              {\n                if (!Array.isArray(computedDataSource)) {\n                  return getEmptyRenderOutput();\n                }\n                return renderForEach(returnNode, computedDataSource, bricks, runtimeContext, rendererContext, parentRoutes, slotId, tplStack, keyPath);\n              }\n            case \":if\":\n            case \":switch\":\n              {\n                return renderBricks(returnNode, bricks, runtimeContext, rendererContext, parentRoutes, slotId, tplStack, keyPath);\n              }\n          }\n        });\n        return function lowerLevelRenderControlNode(_x31) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      var renderControlNode = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (runtimeContext) {\n          var _rawOutput$node;\n          var rawOutput = yield lowerLevelRenderControlNode(runtimeContext);\n          (_rawOutput$node = rawOutput.node) !== null && _rawOutput$node !== void 0 ? _rawOutput$node : rawOutput.node = {\n            tag: RenderTag.PLACEHOLDER,\n            return: returnNode\n          };\n          return rawOutput;\n        });\n        return function renderControlNode(_x32) {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n      var controlledOutput = yield renderControlNode(runtimeContext);\n      var {\n        onMount,\n        onUnmount\n      } = (_brickConf$lifeCycle = brickConf.lifeCycle) !== null && _brickConf$lifeCycle !== void 0 ? _brickConf$lifeCycle : {};\n      var {\n        contextNames,\n        stateNames\n      } = getTracks(dataSource);\n      if (contextNames || stateNames) {\n        controlledOutput.hasTrackingControls = true;\n        var renderId = 0;\n        var listener = /*#__PURE__*/function () {\n          var _ref3 = _asyncToGenerator(function* () {\n            var currentRenderId = ++renderId;\n            var [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext(runtimeContext);\n            var reControlledOutput = yield renderControlNode(scopedRuntimeContext);\n            var scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n            yield postAsyncRender(reControlledOutput, scopedRuntimeContext, scopedStores);\n\n            // Ignore stale renders\n            if (renderId === currentRenderId) {\n              if (onUnmount) {\n                listenerFactory(onUnmount, runtimeContext)(new CustomEvent(\"unmount\", {\n                  detail: {\n                    rerender: true\n                  }\n                }));\n              }\n              rendererContext.reRender(slotId, keyPath, reControlledOutput.node, returnNode);\n              if (onMount) {\n                listenerFactory(onMount, scopedRuntimeContext)(new CustomEvent(\"mount\", {\n                  detail: {\n                    rerender: true\n                  }\n                }));\n              }\n              for (var store of scopedStores) {\n                store.mountAsyncData();\n              }\n            }\n          });\n          return function listener() {\n            return _ref3.apply(this, arguments);\n          };\n        }();\n        var debouncedListener = debounce(listener);\n        if (contextNames) {\n          for (var contextName of contextNames) {\n            runtimeContext.ctxStore.onChange(contextName, debouncedListener);\n          }\n        }\n        if (stateNames) {\n          for (var _contextName of stateNames) {\n            var tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(dataSource, \"\\\"\"));\n            tplStateStore.onChange(_contextName, debouncedListener);\n          }\n        }\n      }\n      if (onMount) {\n        rendererContext.registerArbitraryLifeCycle(\"onMount\", () => {\n          listenerFactory(onMount, runtimeContext)(new CustomEvent(\"mount\", {\n            detail: {\n              rerender: false\n            }\n          }));\n        });\n      }\n      if (onUnmount) {\n        rendererContext.registerArbitraryLifeCycle(\"onUnmount\", () => {\n          listenerFactory(onUnmount, runtimeContext)(new CustomEvent(\"unmount\", {\n            detail: {\n              rerender: false\n            }\n          }));\n        });\n      }\n      return controlledOutput;\n    }\n\n    // Widgets need to be defined before rendering.\n    if (/\\.tpl-/.test(brickName) && !customTemplates.get(brickName)) {\n      yield catchLoad(loadBricksImperatively([brickName], getBrickPackages()), \"brick\", brickName, rendererContext.unknownBricks);\n    }\n    var tplTagName = getTagNameOfCustomTemplate(brickName, (_runtimeContext$app = runtimeContext.app) === null || _runtimeContext$app === void 0 ? void 0 : _runtimeContext$app.id);\n    if (tplTagName) {\n      var _tplStack$get;\n      var tplCount = (_tplStack$get = tplStack.get(tplTagName)) !== null && _tplStack$get !== void 0 ? _tplStack$get : 0;\n      if (tplCount >= 10) {\n        throw new Error(\"Maximum custom template stack overflowed: \\\"\".concat(tplTagName, \"\\\"\"));\n      }\n      tplStack.set(tplTagName, tplCount + 1);\n    } else if (brickName.includes(\"-\") && !customElements.get(brickName)) {\n      if (brickName === FORM_RENDERER) {\n        customElements.define(FORM_RENDERER, class FormRendererElement extends HTMLElement {\n          get $$typeof() {\n            return \"form-renderer\";\n          }\n        });\n      } else {\n        output.blockingList.push(catchLoad(enqueueStableLoadBricks([brickName], getBrickPackages()), \"brick\", brickName, rendererContext.unknownBricks));\n      }\n    }\n    var formData;\n    var confProps;\n    if (brickName === FORM_RENDERER) {\n      var _brickConf$properties;\n      var _ref4 = (_brickConf$properties = brickConf.properties) !== null && _brickConf$properties !== void 0 ? _brickConf$properties : {};\n      ({\n        formData\n      } = _ref4);\n      confProps = _objectWithoutProperties(_ref4, _excluded3);\n      _ref4;\n    } else {\n      confProps = brickConf.properties;\n    }\n    var trackingContextList = [];\n    var asyncPropertyEntries = asyncComputeRealPropertyEntries(confProps, runtimeContext, trackingContextList);\n    var computedPropsFromHost = brickConf[symbolForAsyncComputedPropsFromHost];\n    if (computedPropsFromHost) {\n      asyncPropertyEntries.push(...computedPropsFromHost);\n    }\n    var isScript = brickName === \"script\";\n    if (isScript || brickName === \"link\") {\n      var props = yield constructAsyncProperties(asyncPropertyEntries);\n      if (isScript ? props.src : props.rel === \"stylesheet\" && props.href) {\n        var _window$PUBLIC_ROOT;\n        var prefix = (_window$PUBLIC_ROOT = window.PUBLIC_ROOT) !== null && _window$PUBLIC_ROOT !== void 0 ? _window$PUBLIC_ROOT : \"\";\n        if (isScript) {\n          var {\n              src\n            } = props,\n            attrs = _objectWithoutProperties(props, _excluded4);\n          yield catchLoad(loadScript(src, prefix, attrs), \"script\", src, \"silent\");\n        } else {\n          var {\n              href\n            } = props,\n            attrs = _objectWithoutProperties(props, _excluded5);\n          yield catchLoad(loadStyle(href, prefix, attrs), \"stylesheet\", href, \"silent\");\n        }\n        return output;\n      }\n    }\n    var brick = {\n      tag: RenderTag.BRICK,\n      type: tplTagName || brickName,\n      return: returnNode,\n      slotId,\n      events: brickConf.events,\n      runtimeContext,\n      portal: brickConf.portal,\n      iid: brickConf.iid,\n      ref: brickConf.ref\n    };\n    output.node = brick;\n\n    // 在最终挂载前，先加载所有可能用到的 processors。\n    var usedProcessors = strictCollectMemberUsage([brickConf.events, brickConf.lifeCycle], \"PROCESSORS\", 2);\n    if (usedProcessors.size > 0) {\n      output.blockingList.push(catchLoad(loadProcessorsImperatively(usedProcessors, getBrickPackages()), \"processors\", [...usedProcessors].join(\", \"), rendererContext.unknownBricks));\n    }\n\n    // 加载构件属性和加载子构件等任务，可以并行。\n    var blockingList = [];\n    var loadProperties = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(function* () {\n        brick.properties = yield constructAsyncProperties(asyncPropertyEntries);\n        listenOnTrackingContext(brick, trackingContextList);\n      });\n      return function loadProperties() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n    blockingList.push(loadProperties());\n    rendererContext.registerBrickLifeCycle(brick, brickConf.lifeCycle);\n    var expandedBrickConf = brickConf;\n    if (tplTagName) {\n      expandedBrickConf = expandCustomTemplate(tplTagName, brickConf, brick, asyncPropertyEntries, rendererContext);\n    } else if (brickName === FORM_RENDERER) {\n      expandedBrickConf = expandFormRenderer(formData, brickConf, brick, asyncPropertyEntries, rendererContext);\n    }\n    if (expandedBrickConf.portal) {\n      // A portal brick has no slotId.\n      brick.slotId = undefined;\n    }\n    var childRuntimeContext;\n    if (tplTagName) {\n      // There is a boundary for `forEachItem` between template internals and externals.\n      childRuntimeContext = _objectSpread({}, runtimeContext);\n      delete childRuntimeContext.forEachItem;\n      delete childRuntimeContext.forEachIndex;\n    } else {\n      childRuntimeContext = runtimeContext;\n    }\n    var loadChildren = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator(function* () {\n        var slots = childrenToSlots(expandedBrickConf.children, expandedBrickConf.slots);\n        if (!slots) {\n          return;\n        }\n        var routeSlotIndexes = new Set();\n        var rendered = yield Promise.all(Object.entries(slots).map((_ref7, index) => {\n          var [childSlotId, slotConf] = _ref7;\n          if (slotConf.type !== \"routes\") {\n            return renderBricks(brick, slotConf.bricks, childRuntimeContext, rendererContext, parentRoutes, childSlotId, tplStack);\n          }\n          if (runtimeContext.flags[\"incremental-sub-route-rendering\"]) {\n            routeSlotIndexes.add(index);\n            rendererContext.performIncrementalRender( /*#__PURE__*/function () {\n              var _ref8 = _asyncToGenerator(function* (location) {\n                var {\n                  homepage\n                } = childRuntimeContext.app;\n                var {\n                  pathname\n                } = location;\n                // Ignore if any one of homepage and parent routes not matched.\n                if (!matchHomepage(homepage, pathname) || !parentRoutes.every(route => matchRoute(route, homepage, pathname))) {\n                  return false;\n                }\n                var [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext(_objectSpread(_objectSpread({}, childRuntimeContext), {}, {\n                  location,\n                  query: new URLSearchParams(location.search)\n                }));\n                var failed = false;\n                var incrementalOutput;\n                var scopedStores = [];\n                try {\n                  incrementalOutput = yield renderRoutes(brick, slotConf.routes, scopedRuntimeContext, rendererContext, parentRoutes, childSlotId, true);\n\n                  // If all sub-routes are missed, ignore incremental rendering\n                  if (!incrementalOutput.route) {\n                    return false;\n                  }\n\n                  // Bailout if redirect or unauthenticated is set\n                  if (rendererContext.reBailout(incrementalOutput)) {\n                    return true;\n                  }\n                  scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n                  yield postAsyncRender(incrementalOutput, scopedRuntimeContext, [scopedRuntimeContext.ctxStore, ...scopedStores]);\n                  yield rendererContext.reMergeMenuRequests(slotConf.routes, incrementalOutput.route, incrementalOutput.menuRequests);\n                } catch (error) {\n                  // eslint-disable-next-line no-console\n                  console.error(\"Incremental sub-router failed:\", error);\n                  var result = rendererContext.reCatch(error, brick);\n                  if (!result) {\n                    return true;\n                  }\n                  ({\n                    failed,\n                    output: incrementalOutput\n                  } = result);\n\n                  // Assert: no errors will be throw\n                  yield rendererContext.reMergeMenuRequests(slotConf.routes, incrementalOutput.route, incrementalOutput.menuRequests);\n                }\n                rendererContext.reRender(childSlotId, [], incrementalOutput.node, brick);\n                if (!failed) {\n                  scopedRuntimeContext.ctxStore.mountAsyncData(incrementalOutput.route);\n                  for (var store of scopedStores) {\n                    store.mountAsyncData();\n                  }\n                }\n                return true;\n              });\n              return function (_x33) {\n                return _ref8.apply(this, arguments);\n              };\n            }());\n          }\n          return renderRoutes(brick, slotConf.routes, childRuntimeContext, rendererContext, parentRoutes, childSlotId);\n        }));\n        var childrenOutput = _objectSpread(_objectSpread({}, output), {}, {\n          node: undefined,\n          blockingList: [],\n          menuRequests: []\n        });\n        rendered.forEach((item, index) => {\n          if (routeSlotIndexes.has(index)) {\n            // Memoize a render node before it's been merged.\n            rendererContext.memoize(slotId, [], item.node, brick);\n          }\n          mergeRenderOutput(childrenOutput, item);\n        });\n        if (childrenOutput.node) {\n          brick.child = childrenOutput.node;\n        }\n        mergeRenderOutput(output, _objectSpread(_objectSpread({}, childrenOutput), {}, {\n          node: undefined\n        }));\n      });\n      return function loadChildren() {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n    blockingList.push(loadChildren());\n    yield Promise.all(blockingList);\n    return output;\n  });\n  return _renderBrick.apply(this, arguments);\n}\nfunction isGeneralizedTrackAll(brickIf) {\n  return typeof brickIf === \"string\" ? isTrackAll(brickIf) : isPreEvaluated(brickIf) &&\n  // istanbul ignore next: covered by e2e tests\n  isTrackAll(getPreEvaluatedRaw(brickIf));\n}\nfunction ensureValidControlBrick(brick) {\n  if (brick !== \":forEach\" && brick !== \":if\" && brick !== \":switch\") {\n    throw new Error(\"Unknown storyboard control node: \\\"\".concat(brick, \"\\\"\"));\n  }\n}\nfunction renderForEach(_x22, _x23, _x24, _x25, _x26, _x27, _x28, _x29, _x30) {\n  return _renderForEach.apply(this, arguments);\n}\nfunction _renderForEach() {\n  _renderForEach = _asyncToGenerator(function* (returnNode, dataSource, bricks, runtimeContext, rendererContext, parentRoutes, slotId, tplStack, keyPath) {\n    var output = getEmptyRenderOutput();\n    var rows = dataSource.length;\n    var rendered = yield Promise.all(dataSource.map((item, i) => Promise.all(bricks.map((brickConf, j) => renderBrick(returnNode, brickConf, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      forEachItem: item,\n      forEachIndex: i\n    }), rendererContext, parentRoutes, slotId, keyPath.concat(i * rows + j), tplStack && new Map(tplStack))))));\n\n    // 多层构件并行异步转换，但转换的结果按原顺序串行合并。\n    rendered.flat().forEach((item, index) => {\n      if (item.hasTrackingControls) {\n        // Memoize a render node before it's been merged.\n        rendererContext.memoize(slotId, keyPath.concat(index), item.node, returnNode);\n      }\n      mergeRenderOutput(output, item);\n    });\n    return output;\n  });\n  return _renderForEach.apply(this, arguments);\n}\nexport function getDataStores(runtimeContext) {\n  return [runtimeContext.ctxStore, ...runtimeContext.tplStateStoreMap.values(), ...runtimeContext.formStateStoreMap.values()];\n}\nexport function postAsyncRender(output, runtimeContext, stores) {\n  flushStableLoadBricks();\n  return Promise.all([...output.blockingList, ...stores.map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck]);\n}\nexport function createScopedRuntimeContext(runtimeContext) {\n  var tplStateStoreScope = [];\n  var formStateStoreScope = [];\n  var scopedRuntimeContext = _objectSpread(_objectSpread({}, runtimeContext), {}, {\n    tplStateStoreScope,\n    formStateStoreScope\n  });\n  return [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope];\n}\nfunction loadMenu(menuConf, runtimeContext) {\n  if (!menuConf) {\n    return;\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"brick\") {\n    // eslint-disable-next-line no-console\n    console.error(\"Set menu with brick is dropped in v3:\", menuConf);\n    throw new Error(\"Set menu with brick is dropped in v3\");\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"resolve\") {\n    // eslint-disable-next-line no-console\n    console.warn(\"Set menu with resolve is not supported in v3 yet:\", menuConf);\n    return;\n  }\n  return asyncComputeRealValue(menuConf, runtimeContext);\n}\nfunction mergeRenderOutput(output, newOutput) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  var {\n      blockingList,\n      node,\n      menuRequests,\n      hasTrackingControls\n    } = newOutput,\n    rest = _objectWithoutProperties(newOutput, _excluded);\n  output.blockingList.push(...blockingList);\n  output.menuRequests.push(...menuRequests);\n  if (node) {\n    if (output.node) {\n      var last = output.node;\n      while (last.sibling) {\n        last = last.sibling;\n      }\n      last.sibling = node;\n    } else {\n      output.node = node;\n    }\n  }\n  Object.assign(output, rest);\n}\nfunction getEmptyRenderOutput() {\n  return {\n    blockingList: [],\n    menuRequests: []\n  };\n}\nexport function childrenToSlots(children, originalSlots) {\n  var newSlots = originalSlots;\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && children && !Array.isArray(children)) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Specified brick children but not array:\", \"<\".concat(typeof children, \">\"), children);\n  }\n  if (Array.isArray(children) && !newSlots) {\n    newSlots = {};\n    for (var child of children) {\n      var _child$slot;\n      var slot = (_child$slot = child.slot) !== null && _child$slot !== void 0 ? _child$slot : \"\";\n      if (!hasOwnProperty(newSlots, slot)) {\n        newSlots[slot] = {\n          type: \"bricks\",\n          bricks: []\n        };\n      }\n      newSlots[slot].bricks.push(child);\n    }\n  }\n  return newSlots;\n}\nfunction catchLoad(promise, type, name, unknownPolicy) {\n  return unknownPolicy === \"silent\" ? promise.catch(e => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load \".concat(type, \" \\\"\").concat(name, \"\\\" failed:\"), e);\n  }) : promise;\n}\n//# sourceMappingURL=Renderer.js.map","import { setProperties } from \"./setProperties.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nexport function listenOnTrackingContext(brick, trackingContextList) {\n  var _loop = function (track) {\n    var listener = () => {\n      if (brick.element) {\n        setProperties(brick.element, {\n          [track.propName]: track.propValue\n        }, brick.runtimeContext);\n      }\n    };\n    if (track.contextNames) {\n      for (var contextName of track.contextNames) {\n        brick.runtimeContext.ctxStore.onChange(contextName, listener);\n      }\n    }\n    if (track.stateNames) {\n      var tplStateStore = getTplStateStore(brick.runtimeContext, \"STATE\", \": \\\"\".concat(track.propValue, \"\\\"\"));\n      for (var stateName of track.stateNames) {\n        tplStateStore.onChange(stateName, listener);\n      }\n    }\n    if (track.formStateNames) {\n      var formStateStore = getFormStateStore(brick.runtimeContext, \"FORM_STATE\", \": \\\"\".concat(track.propValue, \"\\\"\"));\n      for (var _stateName of track.formStateNames) {\n        formStateStore.onChange(_stateName, listener);\n      }\n    }\n  };\n  for (var track of trackingContextList) {\n    _loop(track);\n  }\n}\n//# sourceMappingURL=listenOnTrackingContext.js.map","import { getTplStateStore } from \"./utils.js\";\nexport function bindTemplateProxy(brick) {\n  var _tplHostMetadata$prox;\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n\n  // Error recovering brick may have no runtimeContext.\n  if (!ref || !runtimeContext.tplStateStoreId) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"bindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.set(ref, brick);\n  var events = (_tplHostMetadata$prox = tplHostMetadata.proxy) === null || _tplHostMetadata$prox === void 0 ? void 0 : _tplHostMetadata$prox.events;\n  if (events) {\n    var _loop = function (from) {\n      if (to.ref === ref) {\n        var _to$refEvent, _ref, _ref$$$proxyListeners;\n        var listener = e => {\n          if (e.bubbles) {\n            e.stopPropagation();\n          }\n          hostBrick.element.dispatchEvent(new CustomEvent(from, {\n            detail: e.detail,\n            bubbles: e.bubbles,\n            cancelable: e.cancelable,\n            composed: e.composed\n          }));\n        };\n        var eventType = (_to$refEvent = to.refEvent) !== null && _to$refEvent !== void 0 ? _to$refEvent : from;\n        element.addEventListener(eventType, listener);\n        (_ref$$$proxyListeners = (_ref = element).$$proxyListeners) !== null && _ref$$$proxyListeners !== void 0 ? _ref$$$proxyListeners : _ref.$$proxyListeners = [];\n        element.$$proxyListeners.push([eventType, listener]);\n      }\n    };\n    for (var [from, to] of Object.entries(events)) {\n      _loop(from);\n    }\n  }\n}\nexport function unbindTemplateProxy(brick) {\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n  if (!(runtimeContext !== null && runtimeContext !== void 0 && runtimeContext.tplStateStoreId) || !ref) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"unbindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.delete(ref);\n  for (var [type, fn] of (_$$proxyListeners = element.$$proxyListeners) !== null && _$$proxyListeners !== void 0 ? _$$proxyListeners : []) {\n    var _$$proxyListeners;\n    element.removeEventListener(type, fn);\n  }\n  delete element.$$proxyListeners;\n}\n//# sourceMappingURL=bindTemplateProxy.js.map","import { bindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { bindListeners } from \"./bindListeners.js\";\nimport { setRealProperties } from \"./compute/setRealProperties.js\";\nimport { RenderTag } from \"./enums.js\";\nexport function unmountTree(mountPoint) {\n  mountPoint.replaceChildren();\n}\nexport function mountTree(root, initializedElement) {\n  var current = root.child;\n  var portalElements = [];\n  while (current) {\n    if (current.tag === RenderTag.BRICK) {\n      var _current$tplHostMetad;\n      var tagName = current.type;\n      if (tagName.includes(\"-\") && !customElements.get(tagName)) {\n        // eslint-disable-next-line no-console\n        console.error(\"Undefined custom element: \".concat(tagName));\n      }\n\n      // istanbul ignore if\n      if (tagName === \"basic-bricks.script-brick\") {\n        // eslint-disable-next-line no-console\n        console.warn(\"`basic-bricks.script-brick` is deprecated, please take caution when using it\");\n      }\n      var element = initializedElement && current === root.child ? initializedElement : document.createElement(tagName);\n      current.element = element;\n      if (current.slotId) {\n        element.setAttribute(\"slot\", current.slotId);\n      }\n      if (current.iid) {\n        element.dataset.iid = current.iid;\n      }\n      if ((_current$tplHostMetad = current.tplHostMetadata) !== null && _current$tplHostMetad !== void 0 && _current$tplHostMetad.tplStateStoreId) {\n        element.dataset.tplStateStoreId = current.tplHostMetadata.tplStateStoreId;\n      }\n      setRealProperties(element, current.properties);\n      bindListeners(element, current.events, current.runtimeContext);\n      if (current.tplHostMetadata) {\n        // 先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n        // 避免初始化的一次 state update 操作及其 onChange 事件。\n        element.$$tplStateStore = getTplStateStore({\n          tplStateStoreId: current.tplHostMetadata.tplStateStoreId,\n          tplStateStoreMap: current.runtimeContext.tplStateStoreMap\n        }, \"mount\");\n      }\n      bindTemplateProxy(current);\n      if (current.portal) {\n        portalElements.push(element);\n      } else if (current.return) {\n        if (!current.return.childElements) {\n          current.return.childElements = [];\n        }\n        current.return.childElements.push(element);\n      }\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        // Append elements inside out\n        if (currentReturn.childElements) {\n          if (currentReturn.tag === RenderTag.ROOT) {\n            var _currentReturn$contai;\n            (_currentReturn$contai = currentReturn.container) === null || _currentReturn$contai === void 0 || _currentReturn$contai.append(...currentReturn.childElements);\n          } else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            currentReturn.element.append(...currentReturn.childElements);\n          }\n          currentReturn.childElements = undefined;\n        }\n        if (currentReturn.tag === RenderTag.ROOT && portalElements.length > 0) {\n          var portal = typeof currentReturn.createPortal === \"function\" ? currentReturn.createPortal() : currentReturn.createPortal;\n          portal.append(...portalElements);\n        }\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n}\n//# sourceMappingURL=mount.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport { isEmpty, remove } from \"lodash\";\nimport { listenerFactory } from \"./bindListeners.js\";\nimport { getHistory } from \"../history.js\";\nimport { getReadOnlyProxy } from \"./proxyFactories.js\";\nimport { mediaEventTarget } from \"./mediaQuery.js\";\nimport { mountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { unbindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { hooks } from \"./Runtime.js\";\nvar commonLifeCycles = [\"onMount\", \"onUnmount\", \"onMediaChange\", \"onScrollIntoView\", \"onMessage\", \"onMessageClose\"];\nvar pageOnlyLifeCycles = [\"onBeforePageLoad\", \"onPageLoad\", \"onPageLeave\", \"onBeforePageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nvar _routeHelper = /*#__PURE__*/new WeakMap();\nvar _memoizedLifeCycle = /*#__PURE__*/new WeakMap();\nvar _observers = /*#__PURE__*/new WeakMap();\nvar _mediaListener = /*#__PURE__*/new WeakMap();\nvar _arbitraryLifeCycle = /*#__PURE__*/new WeakMap();\nvar _memoized = /*#__PURE__*/new WeakMap();\nvar _allMenuRequests = /*#__PURE__*/new WeakMap();\nvar _memoizedMenuRequestMap = /*#__PURE__*/new WeakMap();\nvar _locationChangeCallbacks = /*#__PURE__*/new WeakMap();\nvar _unmountBricks = /*#__PURE__*/new WeakSet();\nvar _initializeRerenderBricks = /*#__PURE__*/new WeakSet();\nvar _dispatchGeneralLifeCycle = /*#__PURE__*/new WeakSet();\nvar _addObserver = /*#__PURE__*/new WeakSet();\nexport class RendererContext {\n  constructor(scope, options) {\n    var _options$unknownBrick;\n    _classPrivateMethodInitSpec(this, _addObserver);\n    // Note: no `onScrollIntoView` and `onMessage`\n    _classPrivateMethodInitSpec(this, _dispatchGeneralLifeCycle);\n    _classPrivateMethodInitSpec(this, _initializeRerenderBricks);\n    _classPrivateMethodInitSpec(this, _unmountBricks);\n    /**\n     * - page: render as whole page, triggering page life cycles.\n     * - fragment: render as fragment, not triggering page life cycles.\n     */\n    _defineProperty(this, \"scope\", void 0);\n    _defineProperty(this, \"unknownBricks\", void 0);\n    _classPrivateFieldInitSpec(this, _routeHelper, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _memoizedLifeCycle, {\n      writable: true,\n      value: {\n        onBeforePageLoad: [],\n        onPageLoad: [],\n        onPageLeave: [],\n        onBeforePageLeave: [],\n        onAnchorLoad: [],\n        onAnchorUnload: [],\n        onMediaChange: [],\n        onScrollIntoView: [],\n        onMount: [],\n        onUnmount: [],\n        onMessage: [],\n        onMessageClose: []\n      }\n    });\n    _classPrivateFieldInitSpec(this, _observers, {\n      writable: true,\n      value: new Map()\n    });\n    _classPrivateFieldInitSpec(this, _mediaListener, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _arbitraryLifeCycle, {\n      writable: true,\n      value: new Map()\n    });\n    _classPrivateFieldInitSpec(this, _memoized, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _allMenuRequests, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _memoizedMenuRequestMap, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _locationChangeCallbacks, {\n      writable: true,\n      value: []\n    });\n    this.scope = scope;\n    this.unknownBricks = (_options$unknownBrick = options === null || options === void 0 ? void 0 : options.unknownBricks) !== null && _options$unknownBrick !== void 0 ? _options$unknownBrick : \"throw\";\n    _classPrivateFieldSet(this, _routeHelper, options === null || options === void 0 ? void 0 : options.routeHelper);\n  }\n  setInitialMenuRequests(menuRequests) {\n    _classPrivateFieldSet(this, _allMenuRequests, menuRequests);\n  }\n  memoizeMenuRequests(route, menuRequests) {\n    if (!_classPrivateFieldGet(this, _memoizedMenuRequestMap)) {\n      _classPrivateFieldSet(this, _memoizedMenuRequestMap, new WeakMap());\n    }\n    _classPrivateFieldGet(this, _memoizedMenuRequestMap).set(route, menuRequests[0]);\n  }\n  reMergeMenuRequests(routes, currentRoute, menuRequests) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var previousMenuRequest;\n      var previousRoute;\n      for (var route of routes) {\n        previousMenuRequest = _classPrivateFieldGet(_this, _memoizedMenuRequestMap).get(route);\n        if (previousMenuRequest) {\n          previousRoute = route;\n          break;\n        }\n      }\n      var mergedMenuRequests = _classPrivateFieldGet(_this, _allMenuRequests);\n      var previousIndex = previousMenuRequest ? mergedMenuRequests.indexOf(previousMenuRequest) : -1;\n      if (previousIndex === -1) {\n        if (!menuRequests.length) {\n          return;\n        }\n        mergedMenuRequests.push(...menuRequests);\n      } else {\n        mergedMenuRequests.splice(previousIndex, mergedMenuRequests.length - previousIndex, ...menuRequests);\n      }\n      if (previousRoute && previousRoute !== currentRoute) {\n        _classPrivateFieldGet(_this, _memoizedMenuRequestMap).delete(previousRoute);\n      }\n      yield _classPrivateFieldGet(_this, _routeHelper).mergeMenus(mergedMenuRequests);\n    })();\n  }\n  reBailout(output) {\n    return _classPrivateFieldGet(this, _routeHelper).bailout(output);\n  }\n  reCatch(error, returnNode) {\n    return _classPrivateFieldGet(this, _routeHelper).catch(error, returnNode);\n  }\n  didPerformIncrementalRender(location) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      var results = yield Promise.all(_classPrivateFieldGet(_this2, _locationChangeCallbacks).map(callback => callback(location)));\n      return results.some(result => result);\n    })();\n  }\n\n  /**\n   * When `callback` resolved to `true` which means incremental rendering is performed,\n   * ignore normal rendering.\n   */\n  performIncrementalRender(callback) {\n    _classPrivateFieldGet(this, _locationChangeCallbacks).push(callback);\n  }\n  registerBrickLifeCycle(brick, lifeCycle) {\n    if (!lifeCycle) {\n      return;\n    }\n    var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n    for (var key of lifeCycleTypes) {\n      var handlers = lifeCycle[key];\n      if (handlers) {\n        _classPrivateFieldGet(this, _memoizedLifeCycle)[key].push({\n          brick,\n          handlers: handlers\n        });\n      }\n    }\n    // istanbul ignore next\n    if (!isEmpty(lifeCycle.useResolves)) {\n      // eslint-disable-next-line no-console\n      console.error(\"`lifeCycle.useResolves` is dropped in v3:\", lifeCycle);\n    }\n  }\n  registerArbitraryLifeCycle(lifeCycle, fn) {\n    var arbitraryCallbacks = _classPrivateFieldGet(this, _arbitraryLifeCycle).get(lifeCycle);\n    if (arbitraryCallbacks) {\n      arbitraryCallbacks.add(fn);\n    } else {\n      _classPrivateFieldGet(this, _arbitraryLifeCycle).set(lifeCycle, new Set([fn]));\n    }\n  }\n  memoize(slotId, keyPath, node, returnNode) {\n    if (!_classPrivateFieldGet(this, _memoized)) {\n      _classPrivateFieldSet(this, _memoized, new WeakMap());\n    }\n    var memKey = [slotId !== null && slotId !== void 0 ? slotId : \"\", ...keyPath].join(\".\");\n    var mem = _classPrivateFieldGet(this, _memoized).get(returnNode);\n    if (!mem) {\n      mem = new Map();\n      _classPrivateFieldGet(this, _memoized).set(returnNode, mem);\n    }\n    mem.set(memKey, {\n      node,\n      last: getLastNode(node),\n      lastNormal: getLastNormalNode(node),\n      lastPortal: getLastPortalNode(node)\n    });\n  }\n  reRender(slotId, keyPath, node, returnNode) {\n    var memKey = [slotId !== null && slotId !== void 0 ? slotId : \"\", ...keyPath].join(\".\");\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    var memoized = _classPrivateFieldGet(this, _memoized).get(returnNode).get(memKey);\n    var {\n      node: prevNode,\n      last: prevLast,\n      lastNormal: prevLastNormal,\n      lastPortal: prevLastPortal\n    } = memoized;\n    var insertBeforeChild;\n    var insertPortalBeforeChild;\n    if ((prevNode === null || prevNode === void 0 ? void 0 : prevNode.tag) === RenderTag.PLACEHOLDER) {\n      var _getNextNormalNode$el, _getNextNormalNode, _getNextPortalNode$el, _getNextPortalNode;\n      insertBeforeChild = (_getNextNormalNode$el = (_getNextNormalNode = getNextNormalNode(prevNode)) === null || _getNextNormalNode === void 0 ? void 0 : _getNextNormalNode.element) !== null && _getNextNormalNode$el !== void 0 ? _getNextNormalNode$el : null;\n      insertPortalBeforeChild = (_getNextPortalNode$el = (_getNextPortalNode = getNextPortalNode(prevNode)) === null || _getNextPortalNode === void 0 ? void 0 : _getNextPortalNode.element) !== null && _getNextPortalNode$el !== void 0 ? _getNextPortalNode$el : null;\n    } else {\n      var _prevLastNormal$eleme, _prevLastNormal$eleme2, _prevLastPortal$eleme, _prevLastPortal$eleme2;\n      insertBeforeChild = (_prevLastNormal$eleme = prevLastNormal === null || prevLastNormal === void 0 || (_prevLastNormal$eleme2 = prevLastNormal.element) === null || _prevLastNormal$eleme2 === void 0 ? void 0 : _prevLastNormal$eleme2.nextSibling) !== null && _prevLastNormal$eleme !== void 0 ? _prevLastNormal$eleme : null;\n      insertPortalBeforeChild = (_prevLastPortal$eleme = prevLastPortal === null || prevLastPortal === void 0 || (_prevLastPortal$eleme2 = prevLastPortal.element) === null || _prevLastPortal$eleme2 === void 0 ? void 0 : _prevLastPortal$eleme2.nextSibling) !== null && _prevLastPortal$eleme !== void 0 ? _prevLastPortal$eleme : null;\n    }\n    var last = getLastNode(node);\n    memoized.node = node;\n    memoized.last = last;\n    memoized.lastNormal = getLastNormalNode(node);\n    memoized.lastPortal = getLastPortalNode(node);\n\n    // Figure out the unchanged prev sibling and next sibling\n    var prevSibling;\n    var current = returnNode.child;\n    while (current && current !== prevLast) {\n      if (current.sibling === prevNode) {\n        prevSibling = current;\n        break;\n      }\n      current = current.sibling;\n    }\n    var fragment = document.createDocumentFragment();\n    var portalFragment = document.createDocumentFragment();\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: fragment,\n      createPortal: portalFragment,\n      child: node\n    };\n\n    // Override `return`\n    current = node;\n    while (current) {\n      current.return = renderRoot;\n      current = current.sibling;\n    }\n\n    // Unmount previous bricks, including their descendants\n    var removeBricks = getBrickRange(prevNode, prevLast);\n    _classPrivateMethodGet(this, _unmountBricks, _unmountBricks2).call(this, removeBricks);\n    mountTree(renderRoot);\n\n    // Connect back\n    if (prevSibling) {\n      prevSibling.sibling = node;\n    } else {\n      returnNode.child = node;\n    }\n    if (last) {\n      last.sibling = prevLast === null || prevLast === void 0 ? void 0 : prevLast.sibling;\n    }\n\n    // Resume `return`\n    current = node;\n    while (current) {\n      current.return = returnNode;\n      current = current.sibling;\n    }\n    if (returnNode.tag === RenderTag.ROOT) {\n      var _returnNode$container;\n      (_returnNode$container = returnNode.container) === null || _returnNode$container === void 0 || _returnNode$container.insertBefore(fragment, insertBeforeChild);\n    } else {\n      var _returnNode$element;\n      (_returnNode$element = returnNode.element) === null || _returnNode$element === void 0 || _returnNode$element.insertBefore(fragment, insertBeforeChild);\n    }\n    if (portalFragment.childNodes.length > 0) {\n      var _root;\n      var root = node;\n      while (root && root.return) {\n        root = root.return;\n      }\n      // istanbul ignore next\n      if (((_root = root) === null || _root === void 0 ? void 0 : _root.tag) !== RenderTag.ROOT) {\n        throw new Error(\"Cannot find render root node. This is a bug of Brick Next, please report it.\");\n      }\n      var portal = typeof root.createPortal === \"function\" ? root.createPortal() : root.createPortal;\n      portal.insertBefore(portalFragment, insertPortalBeforeChild);\n    }\n    var newBricks = getBrickRange(node, last);\n    _classPrivateMethodGet(this, _initializeRerenderBricks, _initializeRerenderBricks2).call(this, newBricks);\n  }\n  dispose() {\n    for (var list of Object.values(_classPrivateFieldGet(this, _memoizedLifeCycle))) {\n      list.length = 0;\n    }\n    for (var _list of _classPrivateFieldGet(this, _observers).values()) {\n      for (var observer of _list) {\n        observer.disconnect();\n      }\n      _list.length = 0;\n    }\n    _classPrivateFieldGet(this, _observers).clear();\n    if (_classPrivateFieldGet(this, _mediaListener)) {\n      mediaEventTarget.removeEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n      _classPrivateFieldSet(this, _mediaListener, undefined);\n    }\n    _classPrivateFieldSet(this, _memoized, undefined);\n    _classPrivateFieldSet(this, _allMenuRequests, undefined);\n    _classPrivateFieldSet(this, _memoizedMenuRequestMap, undefined);\n    _classPrivateFieldGet(this, _arbitraryLifeCycle).clear();\n    _classPrivateFieldGet(this, _locationChangeCallbacks).length = 0;\n  }\n  dispatchBeforePageLoad() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLoad\", new CustomEvent(\"page.beforeLoad\"));\n  }\n  dispatchPageLoad() {\n    var event = new CustomEvent(\"page.load\");\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLoad\", event);\n    // Currently only for e2e testing\n    window.dispatchEvent(event);\n  }\n  dispatchBeforePageLeave(detail) {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLeave\", new CustomEvent(\"page.beforeLeave\", {\n      detail\n    }));\n  }\n  dispatchPageLeave() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLeave\", new CustomEvent(\"page.leave\"));\n  }\n  dispatchAnchorLoad() {\n    var {\n      hash\n    } = getHistory().location;\n    if (hash && hash !== \"#\") {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorLoad\", new CustomEvent(\"anchor.load\", {\n        detail: {\n          hash,\n          anchor: hash.substring(1)\n        }\n      }));\n    } else {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorUnload\", new CustomEvent(\"anchor.unload\"));\n    }\n  }\n  initializeScrollIntoView() {\n    for (var {\n      brick,\n      handlers: conf\n    } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, brick, conf);\n    }\n  }\n  initializeMediaChange() {\n    _classPrivateFieldSet(this, _mediaListener, event => {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMediaChange\", new CustomEvent(\"media.change\", {\n        detail: getReadOnlyProxy(event.detail)\n      }));\n    });\n    mediaEventTarget.addEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n  }\n  initializeMessageDispatcher() {\n    var _hooks$messageDispatc;\n    var _loop = function (brick) {\n      var _loop2 = function (conf) {\n        var _hooks$messageDispatc2;\n        hooks === null || hooks === void 0 || (_hooks$messageDispatc2 = hooks.messageDispatcher) === null || _hooks$messageDispatc2 === void 0 || _hooks$messageDispatc2.onMessage(conf.channel, detail => {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"message.push\", {\n            detail\n          }));\n        });\n      };\n      for (var conf of [].concat(confList)) {\n        _loop2(conf);\n      }\n    };\n    for (var {\n      brick,\n      handlers: confList\n    } of _classPrivateFieldGet(this, _memoizedLifeCycle).onMessage) {\n      _loop(brick);\n    }\n    hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 || _hooks$messageDispatc.onClose(() => {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMessageClose\", new CustomEvent(\"message.close\"));\n    });\n  }\n  dispatchOnMount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMount\", new CustomEvent(\"mount\"));\n  }\n  dispatchOnUnmount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onUnmount\", new CustomEvent(\"unmount\"));\n  }\n}\nfunction _unmountBricks2(bricks) {\n  var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n  var unmountList = [];\n\n  // Clear life cycle handlers, record `onUnmount` at the same time\n  for (var key of lifeCycleTypes) {\n    var removed = remove(_classPrivateFieldGet(this, _memoizedLifeCycle)[key], item => bricks.has(item.brick));\n    if (key === \"onUnmount\") {\n      unmountList.push(...removed);\n    }\n  }\n\n  // Clear intersection observers\n  for (var brick of bricks) {\n    var _brick$element, _brick$element2;\n    var observers = _classPrivateFieldGet(this, _observers).get(brick);\n    if (observers !== null && observers !== void 0 && observers.length) {\n      for (var observer of observers) {\n        observer.disconnect();\n      }\n      observers.length = 0;\n      _classPrivateFieldGet(this, _observers).delete(brick);\n    }\n    unbindTemplateProxy(brick);\n    (_brick$element = brick.element) === null || _brick$element === void 0 || delete _brick$element.$$tplStateStore;\n\n    // Also remove the element\n    (_brick$element2 = brick.element) === null || _brick$element2 === void 0 || _brick$element2.remove();\n  }\n\n  // Dispatch unmount events\n  var unmountEvent = new CustomEvent(\"unmount\");\n  for (var {\n    brick: _brick,\n    handlers\n  } of unmountList) {\n    listenerFactory(handlers, _brick.runtimeContext, _brick)(unmountEvent);\n  }\n}\nfunction _initializeRerenderBricks2(bricks) {\n  var mountEvent = new CustomEvent(\"mount\");\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onMount) {\n    if (bricks.has(brick)) {\n      listenerFactory(handlers, brick.runtimeContext, brick)(mountEvent);\n    }\n  }\n  for (var {\n    brick: _brick2,\n    handlers: conf\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n    if (bricks.has(_brick2)) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, _brick2, conf);\n    }\n  }\n}\nfunction _dispatchGeneralLifeCycle2(type, event) {\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && this.scope === \"fragment\" && pageOnlyLifeCycles.includes(type)) {\n    throw new Error(\"`lifeCycle.\".concat(type, \"` cannot be used in \").concat(this.scope, \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle)[type]) {\n    listenerFactory(handlers, brick.runtimeContext, brick)(event);\n  }\n  var arbitraryCallbacks = _classPrivateFieldGet(this, _arbitraryLifeCycle).get(type);\n  if (arbitraryCallbacks) {\n    for (var fn of arbitraryCallbacks) {\n      fn();\n    }\n  }\n}\nfunction _addObserver2(brick, conf) {\n  var _conf$threshold;\n  var threshold = (_conf$threshold = conf.threshold) !== null && _conf$threshold !== void 0 ? _conf$threshold : 0.1;\n  var observer = new IntersectionObserver((entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        if (entry.intersectionRatio >= threshold) {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"scroll.into.view\"));\n          observer.disconnect();\n        }\n      }\n    });\n  }, {\n    threshold\n  });\n  observer.observe(brick.element);\n  var list = _classPrivateFieldGet(this, _observers).get(brick);\n  if (!list) {\n    list = [];\n    _classPrivateFieldGet(this, _observers).set(brick, list);\n  }\n  list.push(observer);\n}\nfunction getLastNode(node) {\n  var last = node;\n  while ((_last = last) !== null && _last !== void 0 && _last.sibling) {\n    var _last;\n    last = last.sibling;\n  }\n  return last;\n}\nfunction getLastNormalNode(node) {\n  return getSpecifiedNormalNode(node, false);\n}\nfunction getNextNormalNode(node) {\n  return getSpecifiedNormalNode(node, true);\n}\nfunction getSpecifiedNormalNode(node, next) {\n  var last;\n  var current = node;\n  while (current) {\n    if (current.tag === RenderTag.BRICK && !current.portal) {\n      if (next) {\n        return current;\n      }\n      last = current;\n    }\n    current = current.sibling;\n  }\n  return last;\n}\nfunction getLastPortalNode(node) {\n  return getSpecifiedPortalNode(node, false);\n}\nfunction getNextPortalNode(node) {\n  return getSpecifiedPortalNode(node, true);\n}\nfunction getSpecifiedPortalNode(node, next) {\n  var last;\n  var current = node;\n  while (current) {\n    if (current.tag === RenderTag.BRICK && current.portal) {\n      if (next) {\n        return current;\n      }\n      last = current;\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n  return last;\n}\nfunction getBrickRange(from, to) {\n  var range = new Set();\n  var current = from;\n  while (current) {\n    if (current.tag === RenderTag.BRICK) {\n      range.add(current);\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current === to) {\n      break;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn2;\n      var currentReturn = current.return;\n      while (currentReturn && currentReturn !== to) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      if (currentReturn === to) {\n        break;\n      }\n      current = (_currentReturn2 = currentReturn) === null || _currentReturn2 === void 0 ? void 0 : _currentReturn2.sibling;\n    }\n  }\n  return range;\n}\n//# sourceMappingURL=RendererContext.js.map","import { getBasePath } from \"./getBasePath.js\";\nvar misc;\n\n/** 运行时页面信息。*/\n\nexport function getPageInfo() {\n  if (!misc) {\n    misc = {\n      isInIframe: false,\n      isInIframeOfSameSite: false,\n      isInIframeOfNext: false,\n      isInIframeOfVisualBuilder: false,\n      isInIframeOfLegacyConsole: false\n    };\n    if (window !== window.parent) {\n      misc.isInIframe = true;\n      try {\n        // Handle:\n        // - Previewing in visual builder by iframe.\n        // - Nesting next in next.\n        // - Nesting console in next.\n        if (window.origin === window.parent.origin) {\n          misc.isInIframeOfSameSite = true;\n          var selfIsNext = getBasePath() === \"/next/\";\n          var parentPathname = window.parent.location.pathname;\n          var parentIsNext = parentPathname.startsWith(\"/next/\");\n          misc.isInIframeOfNext = (Number(selfIsNext) ^ Number(parentIsNext)) === 0;\n          misc.isInIframeOfVisualBuilder = parentPathname.startsWith(\"\".concat(parentIsNext ? \"/next\" : \"\", \"/visual-builder/\"));\n          misc.isInIframeOfLegacyConsole = selfIsNext && !parentIsNext;\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n    Object.freeze(misc);\n  }\n  return misc;\n}\n//# sourceMappingURL=getPageInfo.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { http } from \"@next-core/http\";\nvar nativeController;\nexport function initAbortController() {\n  if (!window.AbortController) {\n    return;\n  }\n  nativeController = new AbortController();\n  http.interceptors.request.use(config => {\n    var _config$options;\n    return _objectSpread(_objectSpread({}, config), {}, {\n      options: _objectSpread(_objectSpread({}, config.options), {}, {\n        signal: (_config$options = config.options) !== null && _config$options !== void 0 && _config$options.noAbortOnRouteChange ? null : nativeController.signal\n      })\n    });\n  });\n}\nexport function abortPendingRequest() {\n  if (nativeController) {\n    nativeController.abort();\n    nativeController = new AbortController();\n  }\n}\n//# sourceMappingURL=abortController.js.map","import { customTemplates } from \"../CustomTemplates.js\";\nexport function registerCustomTemplates(storyboard) {\n  var _storyboard$meta;\n  if (storyboard.$$registerCustomTemplateProcessed) {\n    return;\n  }\n  storyboard.$$registerCustomTemplateProcessed = true;\n  var templates = (_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.customTemplates;\n  if (Array.isArray(templates)) {\n    for (var tpl of templates) {\n      var tagName = tpl.name.includes(\".\") ? tpl.name : \"\".concat(storyboard.app.id, \".\").concat(tpl.name);\n      customTemplates.define(tagName, tpl);\n    }\n  }\n}\n//# sourceMappingURL=registerCustomTemplates.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { hooks } from \"./Runtime.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nexport function fulfilStoryboard(_x) {\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction _fulfilStoryboard() {\n  _fulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    if (storyboard.$$fulfilled) {\n      return;\n    }\n    if (!storyboard.$$fulfilling) {\n      storyboard.$$fulfilling = doFulfilStoryboard(storyboard);\n    }\n    return storyboard.$$fulfilling;\n  });\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction doFulfilStoryboard(_x2) {\n  return _doFulfilStoryboard.apply(this, arguments);\n}\nfunction _doFulfilStoryboard() {\n  _doFulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    var _hooks$fulfilStoryboa;\n    yield hooks === null || hooks === void 0 || (_hooks$fulfilStoryboa = hooks.fulfilStoryboard) === null || _hooks$fulfilStoryboa === void 0 ? void 0 : _hooks$fulfilStoryboa.call(hooks, storyboard);\n    registerAppI18n(storyboard);\n    Object.assign(storyboard, {\n      $$fulfilled: true,\n      $$fulfilling: null\n    });\n  });\n  return _doFulfilStoryboard.apply(this, arguments);\n}\n//# sourceMappingURL=fulfilStoryboard.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport { locationsAreEqual } from \"history\";\nimport { HttpAbortError } from \"@next-core/http\";\nimport { uniqueId } from \"lodash\";\nimport { getHistory } from \"../history.js\";\nimport { getDataStores, postAsyncRender, renderRoutes } from \"./Renderer.js\";\nimport { DataStore } from \"./data/DataStore.js\";\nimport { clearResolveCache } from \"./data/resolveData.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { isOutsideApp, matchStoryboard } from \"./matchStoryboard.js\";\nimport { registerStoryboardFunctions } from \"./compute/StoryboardFunctions.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { applyMode, applyTheme, getLocalAppsTheme, setMode, setTheme } from \"../themeAndMode.js\";\nimport { _internalApiGetAppInBootstrapData, getRuntime, hooks } from \"./Runtime.js\";\nimport { getPageInfo } from \"../getPageInfo.js\";\nimport { resetAllComputedMarks } from \"./compute/markAsComputed.js\";\nimport { handleHttpError, httpErrorToString, isUnauthenticatedError } from \"../handleHttpError.js\";\nimport { abortPendingRequest, initAbortController } from \"./abortController.js\";\nimport { registerCustomTemplates } from \"./registerCustomTemplates.js\";\nimport { fulfilStoryboard } from \"./fulfilStoryboard.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { insertPreviewRoutes } from \"./insertPreviewRoutes.js\";\nimport { devtoolsHookEmit } from \"./devtools.js\";\nvar _storyboards = /*#__PURE__*/new WeakMap();\nvar _rendering = /*#__PURE__*/new WeakMap();\nvar _prevLocation = /*#__PURE__*/new WeakMap();\nvar _nextLocation = /*#__PURE__*/new WeakMap();\nvar _runtimeContext = /*#__PURE__*/new WeakMap();\nvar _rendererContext = /*#__PURE__*/new WeakMap();\nvar _rendererContextTrashCan = /*#__PURE__*/new WeakMap();\nvar _redirectCount = /*#__PURE__*/new WeakMap();\nvar _renderId = /*#__PURE__*/new WeakMap();\nvar _currentApp = /*#__PURE__*/new WeakMap();\nvar _previousApp = /*#__PURE__*/new WeakMap();\nvar _navConfig = /*#__PURE__*/new WeakMap();\nvar _getBlockMessageBeforePageLave = /*#__PURE__*/new WeakSet();\nvar _safeRedirect = /*#__PURE__*/new WeakSet();\nvar _queuedRender = /*#__PURE__*/new WeakSet();\nvar _render = /*#__PURE__*/new WeakSet();\nexport class Router {\n  constructor(storyboards) {\n    _classPrivateMethodInitSpec(this, _render);\n    _classPrivateMethodInitSpec(this, _queuedRender);\n    _classPrivateMethodInitSpec(this, _safeRedirect);\n    _classPrivateMethodInitSpec(this, _getBlockMessageBeforePageLave);\n    _classPrivateFieldInitSpec(this, _storyboards, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendering, {\n      writable: true,\n      value: false\n    });\n    _classPrivateFieldInitSpec(this, _prevLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _nextLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _runtimeContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContextTrashCan, {\n      writable: true,\n      value: new Set()\n    });\n    _classPrivateFieldInitSpec(this, _redirectCount, {\n      writable: true,\n      value: 0\n    });\n    _classPrivateFieldInitSpec(this, _renderId, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _currentApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _previousApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _navConfig, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldSet(this, _storyboards, storyboards);\n    var _history = getHistory();\n    window.addEventListener(\"beforeunload\", event => {\n      var message = _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {});\n      // See examples in https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload\n      if (message) {\n        // Cancel the event\n        // If you prevent default behavior in Mozilla Firefox prompt will always be shown\n        event.preventDefault();\n        // Chrome requires returnValue to be set\n        event.returnValue = \"\";\n      } else {\n        // the absence of a returnValue property on the event will guarantee the browser unload happens\n        delete event.returnValue;\n      }\n    });\n    _history.block((location, action) => _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {\n      location,\n      action\n    }));\n  }\n  getRenderId() {\n    return _classPrivateFieldGet(this, _renderId);\n  }\n  getRuntimeContext() {\n    return _classPrivateFieldGet(this, _runtimeContext);\n  }\n  getRecentApps() {\n    return {\n      currentApp: _classPrivateFieldGet(this, _currentApp),\n      previousApp: _classPrivateFieldGet(this, _previousApp)\n    };\n  }\n  getNavConfig() {\n    return _classPrivateFieldGet(this, _navConfig);\n  }\n  bootstrap() {\n    var _this = this;\n    initAbortController();\n    var history = getHistory();\n    _classPrivateFieldSet(this, _prevLocation, history.location);\n    var renderId = 0;\n    history.listen( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (location, action) {\n        var _classPrivateFieldGet2, _location$state, _classPrivateFieldGet4;\n        var currentRenderId = ++renderId;\n        var ignoreRendering;\n        var omittedLocationProps = {\n          hash: undefined,\n          state: undefined\n        };\n        // Omit the \"key\" when checking whether locations are equal in certain situations.\n        if (\n        // When current location is triggered by browser action of hash link.\n        location.key === undefined ||\n        // When current location is triggered by browser action of non-push-or-replace,\n        // such as goBack or goForward,\n        action === \"POP\" && (\n        // and the previous location was triggered by hash link,\n        _classPrivateFieldGet(_this, _prevLocation).key === undefined ||\n        // or the previous location specified notify false.\n        ((_classPrivateFieldGet2 = _classPrivateFieldGet(_this, _prevLocation).state) === null || _classPrivateFieldGet2 === void 0 ? void 0 : _classPrivateFieldGet2.notify) === false)) {\n          omittedLocationProps.key = undefined;\n        }\n        if (locationsAreEqual(_objectSpread(_objectSpread({}, _classPrivateFieldGet(_this, _prevLocation)), omittedLocationProps), _objectSpread(_objectSpread({}, location), omittedLocationProps)) || action !== \"POP\" && ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.notify) === false) {\n          // Ignore rendering if location not changed except hash, state and optional key.\n          // Ignore rendering if notify is `false`.\n          ignoreRendering = true;\n        }\n        if (!ignoreRendering) {\n          var _classPrivateFieldGet3;\n          ignoreRendering = yield (_classPrivateFieldGet3 = _classPrivateFieldGet(_this, _rendererContext)) === null || _classPrivateFieldGet3 === void 0 ? void 0 : _classPrivateFieldGet3.didPerformIncrementalRender(location);\n        }\n\n        // Ignore stale renders\n        if (renderId !== currentRenderId) {\n          return;\n        }\n        if (ignoreRendering) {\n          _classPrivateFieldSet(_this, _prevLocation, location);\n          return;\n        }\n        abortPendingRequest();\n        _classPrivateFieldSet(_this, _prevLocation, location);\n        (_classPrivateFieldGet4 = _classPrivateFieldGet(_this, _rendererContext)) === null || _classPrivateFieldGet4 === void 0 || _classPrivateFieldGet4.dispatchPageLeave();\n        if (action === \"POP\") {\n          var storyboard = matchStoryboard(_classPrivateFieldGet(_this, _storyboards), location.pathname);\n          // When a browser action of goBack or goForward is performing,\n          // force reload when the target page is a page of an outside app.\n          if (isOutsideApp(storyboard)) {\n            window.location.reload();\n            return;\n          }\n        }\n        if (_classPrivateFieldGet(_this, _rendering)) {\n          _classPrivateFieldSet(_this, _nextLocation, location);\n        } else {\n          devtoolsHookEmit(\"locationChange\");\n          _classPrivateMethodGet(_this, _queuedRender, _queuedRender2).call(_this, location).catch(handleHttpError);\n        }\n      });\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n    return _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, history.location);\n  }\n}\nfunction _getBlockMessageBeforePageLave2(detail) {\n  var _classPrivateFieldGet5;\n  var history = getHistory();\n  var previousMessage = history.getBlockMessage();\n  (_classPrivateFieldGet5 = _classPrivateFieldGet(this, _rendererContext)) === null || _classPrivateFieldGet5 === void 0 || _classPrivateFieldGet5.dispatchBeforePageLeave(detail);\n  var message = history.getBlockMessage();\n  if (!previousMessage && message) {\n    // Auto unblock only if new block was introduced by `onBeforePageLeave`.\n    history.unblock();\n  }\n  return message;\n}\nfunction _safeRedirect2(to, state, from) {\n  var _this$redirectCount, _this$redirectCount2;\n  if ((_classPrivateFieldSet(this, _redirectCount, (_this$redirectCount = _classPrivateFieldGet(this, _redirectCount), _this$redirectCount2 = _this$redirectCount++, _this$redirectCount)), _this$redirectCount2) > 10) {\n    var message = \"Infinite redirect detected: from \\\"\".concat(from.pathname).concat(from.search).concat(from.hash, \"\\\" to \\\"\").concat(to, \"\\\"\");\n    // istanbul ignore else: error cannot be caught in test\n    if (process.env.NODE_ENV === \"test\") {\n      // eslint-disable-next-line no-console\n      console.error(message);\n      return;\n    } else {\n      throw new Error(message);\n    }\n  }\n  getHistory().replace(to, state);\n}\nfunction _queuedRender2(_x3) {\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _queuedRender3() {\n  _queuedRender3 = _asyncToGenerator(function* (location) {\n    _classPrivateFieldSet(this, _rendering, true);\n    try {\n      yield _classPrivateMethodGet(this, _render, _render2).call(this, location);\n    } finally {\n      _classPrivateFieldSet(this, _rendering, false);\n      if (_classPrivateFieldGet(this, _nextLocation)) {\n        var nextLocation = _classPrivateFieldGet(this, _nextLocation);\n        _classPrivateFieldSet(this, _nextLocation, undefined);\n        yield _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, nextLocation);\n      }\n    }\n  });\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _render2(_x4) {\n  return _render3.apply(this, arguments);\n}\nfunction _render3() {\n  _render3 = _asyncToGenerator(function* (location) {\n    var _hooks$flowApi,\n      _hooks$pageView,\n      _classPrivateFieldGet6,\n      _this2 = this;\n    _classPrivateFieldSet(this, _renderId, uniqueId(\"render-id-1\"));\n    resetAllComputedMarks();\n    clearResolveCache();\n    hooks === null || hooks === void 0 || (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 || _hooks$flowApi.clearCollectWidgetContract();\n    var history = getHistory();\n    history.unblock();\n\n    // const renderStartTime = performance.now();\n    var finishPageView = hooks === null || hooks === void 0 || (_hooks$pageView = hooks.pageView) === null || _hooks$pageView === void 0 ? void 0 : _hooks$pageView.create();\n    var storyboard = matchStoryboard(_classPrivateFieldGet(this, _storyboards), location.pathname);\n    var previousApp = (_classPrivateFieldGet6 = _classPrivateFieldGet(this, _runtimeContext)) === null || _classPrivateFieldGet6 === void 0 ? void 0 : _classPrivateFieldGet6.app;\n    if (storyboard !== null && storyboard !== void 0 && storyboard.app) {\n      yield fulfilStoryboard(storyboard);\n    }\n    var currentApp = _classPrivateFieldSet(this, _currentApp, storyboard === null || storyboard === void 0 ? void 0 : storyboard.app);\n\n    // Storyboard maybe re-assigned, e.g. when open launchpad.\n    var appChanged = previousApp && currentApp ? previousApp.id !== currentApp.id : previousApp !== currentApp;\n\n    // TODO: handle favicon\n\n    // Set `Router::#currentApp` before calling `getFeatureFlags()`\n    var flags = getRuntime().getFeatureFlags();\n    var prevRendererContext = _classPrivateFieldGet(this, _rendererContext);\n    var redirectTo = (to, state) => {\n      finishPageView === null || finishPageView === void 0 || finishPageView({\n        status: \"redirected\"\n      });\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      _classPrivateMethodGet(this, _safeRedirect, _safeRedirect2).call(this, to, state, location);\n    };\n    var redirectToLogin = () => {\n      var to = flags[\"sso-enabled\"] ? \"/sso-auth/login\" : \"/auth/login\";\n      redirectTo(to, {\n        from: location\n      });\n    };\n    var main = document.querySelector(\"#main-mount-point\");\n    var portal = document.querySelector(\"#portal-mount-point\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: main,\n      createPortal: portal\n    };\n    var cleanUpPreviousRender = () => {\n      var _hooks$messageDispatc;\n      unmountTree(main);\n      unmountTree(portal);\n\n      // Note: redirects can lead to multiple trash renderer contexts.\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      for (var item of _classPrivateFieldGet(this, _rendererContextTrashCan)) {\n        if (item) {\n          item.dispatchOnUnmount();\n          item.dispose();\n        }\n      }\n      _classPrivateFieldGet(this, _rendererContextTrashCan).clear();\n      hooks === null || hooks === void 0 || (_hooks$messageDispatc = hooks.messageDispatcher) === null || _hooks$messageDispatc === void 0 || _hooks$messageDispatc.reset();\n      if (appChanged) {\n        _classPrivateFieldSet(this, _previousApp, previousApp);\n        window.dispatchEvent(new CustomEvent(\"app.change\", {\n          detail: {\n            previousApp,\n            currentApp\n          }\n        }));\n      }\n    };\n    setTheme(currentApp && (getLocalAppsTheme()[currentApp.id] || currentApp.theme) || \"light\");\n    setMode(\"default\");\n    if (currentApp) {\n      var _hooks$checkInstalled, _hooks$auth, _hooks$checkPermissio, _storyboard$meta, _hooks$flowApi2, _storyboard$meta2;\n      hooks === null || hooks === void 0 || (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 || _hooks$checkInstalled.preCheckInstalledApps(storyboard, appId => !!_internalApiGetAppInBootstrapData(appId));\n      var routeHelper = {\n        bailout: output => {\n          if (output.unauthenticated) {\n            redirectToLogin();\n            return true;\n          }\n          if (output.redirect) {\n            redirectTo(output.redirect.path, output.redirect.state);\n            return true;\n          }\n          // Reset redirect count if no redirect is set.\n          _classPrivateFieldSet(this, _redirectCount, 0);\n        },\n        mergeMenus: function () {\n          var _ref2 = _asyncToGenerator(function* (menuRequests) {\n            var menuConfs = yield Promise.all(menuRequests);\n            _classPrivateFieldSet(_this2, _navConfig, mergeMenuConfs(menuConfs));\n          });\n          return function mergeMenus(_x5) {\n            return _ref2.apply(this, arguments);\n          };\n        }(),\n        catch: (error, returnNode) => {\n          if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n            redirectToLogin();\n            return;\n          } else if (error instanceof HttpAbortError) {\n            _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n            return;\n          } else {\n            var noAuthGuardLoginPath = getRuntime().getMiscSettings().noAuthGuardLoginPath;\n            if (isUnauthenticatedError(error) && noAuthGuardLoginPath) {\n              redirectTo(noAuthGuardLoginPath, {\n                from: location\n              });\n              return;\n            }\n            return {\n              failed: true,\n              output: {\n                node: {\n                  tag: RenderTag.BRICK,\n                  type: \"div\",\n                  properties: {\n                    textContent: httpErrorToString(error)\n                  },\n                  runtimeContext: null,\n                  return: returnNode\n                },\n                blockingList: [],\n                menuRequests: []\n              }\n            };\n          }\n        }\n      };\n      var rendererContext = _classPrivateFieldSet(this, _rendererContext, new RendererContext(\"page\", {\n        routeHelper\n      }));\n      var runtimeContext = _classPrivateFieldSet(this, _runtimeContext, {\n        app: currentApp,\n        location,\n        query: new URLSearchParams(location.search),\n        flags,\n        sys: _objectSpread(_objectSpread(_objectSpread({}, hooks === null || hooks === void 0 || (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 ? void 0 : _hooks$auth.getAuth()), getPageInfo()), {}, {\n          settings: {\n            brand: getRuntime().getBrandSettings()\n          }\n        }),\n        ctxStore: new DataStore(\"CTX\", undefined, rendererContext),\n        pendingPermissionsPreCheck: [hooks === null || hooks === void 0 || (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissions(storyboard)],\n        tplStateStoreMap: new Map(),\n        formStateStoreMap: new Map()\n      });\n      _classPrivateFieldSet(this, _navConfig, undefined);\n      registerCustomTemplates(storyboard);\n      registerStoryboardFunctions((_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.functions, currentApp);\n      hooks === null || hooks === void 0 || (_hooks$flowApi2 = hooks.flowApi) === null || _hooks$flowApi2 === void 0 || _hooks$flowApi2.collectContract((_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.contracts);\n      var failed = false;\n      var output;\n      var stores = [];\n      try {\n        output = yield renderRoutes(renderRoot, insertPreviewRoutes(storyboard.routes), runtimeContext, rendererContext, []);\n        if (routeHelper.bailout(output)) {\n          return;\n        }\n        stores = getDataStores(runtimeContext);\n        yield postAsyncRender(output, runtimeContext, stores);\n        yield routeHelper.mergeMenus(output.menuRequests);\n        rendererContext.setInitialMenuRequests(output.menuRequests);\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error(\"Router failed:\", error);\n        var result = routeHelper.catch(error, renderRoot);\n        if (!result) {\n          return;\n        }\n        ({\n          failed,\n          output\n        } = result);\n      }\n      renderRoot.child = output.node;\n      cleanUpPreviousRender();\n      if (output.route && output.route.type !== \"routes\" || failed) {\n        if (!failed) {\n          // There is a window to set theme and mode by `lifeCycle.onBeforePageLoad`.\n          rendererContext.dispatchBeforePageLoad();\n        }\n        applyTheme();\n        applyMode();\n        window.DISABLE_REACT_FLUSH_SYNC = false;\n        mountTree(renderRoot);\n        setTimeout(() => {\n          window.DISABLE_REACT_FLUSH_SYNC = true;\n        });\n\n        // Scroll to top after each rendering.\n        // See https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/scroll-restoration.md\n        window.scrollTo(0, 0);\n        if (!failed) {\n          rendererContext.dispatchPageLoad();\n          rendererContext.dispatchAnchorLoad();\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n          rendererContext.initializeMessageDispatcher();\n          for (var store of stores) {\n            store.mountAsyncData();\n          }\n          finishPageView === null || finishPageView === void 0 || finishPageView({\n            status: \"ok\",\n            path: output.path,\n            pageTitle: document.title\n          });\n        } else {\n          finishPageView === null || finishPageView === void 0 || finishPageView({\n            status: \"failed\"\n          });\n        }\n        devtoolsHookEmit(\"rendered\");\n        return;\n      }\n    } else if (!window.NO_AUTH_GUARD && hooks !== null && hooks !== void 0 && hooks.auth && !hooks.auth.isLoggedIn()) {\n      // Todo(steve): refine after api-gateway supports fetching storyboards before logged in.\n      // Redirect to login if no storyboard is matched.\n      redirectToLogin();\n      return;\n    } else {\n      cleanUpPreviousRender();\n    }\n    applyTheme();\n    applyMode();\n    var node = {\n      tag: RenderTag.BRICK,\n      type: \"div\",\n      properties: {\n        textContent: \"Page not found\"\n      },\n      runtimeContext: null,\n      return: renderRoot\n    };\n    renderRoot.child = node;\n    mountTree(renderRoot);\n\n    // Scroll to top after each rendering.\n    window.scrollTo(0, 0);\n    finishPageView === null || finishPageView === void 0 || finishPageView({\n      status: \"not-found\"\n    });\n    devtoolsHookEmit(\"rendered\");\n  });\n  return _render3.apply(this, arguments);\n}\nfunction mergeMenuConfs(menuConfs) {\n  var navConfig = {\n    breadcrumb: []\n  };\n  for (var menuConf of menuConfs) {\n    var {\n      breadcrumb\n    } = menuConf;\n    if (breadcrumb) {\n      if (breadcrumb.overwrite) {\n        navConfig.breadcrumb = breadcrumb.items;\n      } else {\n        navConfig.breadcrumb.push(...breadcrumb.items);\n      }\n    }\n  }\n  return navConfig;\n}\n//# sourceMappingURL=Router.js.map","import { findLastIndex } from \"lodash\";\nexport function insertPreviewRoutes(routes) {\n  // Insert preview routes for iframe only.\n  if (window.parent === window) {\n    return routes;\n  }\n  var mergedRoutes = routes;\n  var specificTemplatePreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/template-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificTemplatePreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/template-preview/:templateId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificTemplatePreviewIndex + 1)];\n  var specificSnippetPreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/snippet-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificSnippetPreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/snippet-preview/:snippetId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificSnippetPreviewIndex + 1)];\n  return mergedRoutes;\n}\n//# sourceMappingURL=insertPreviewRoutes.js.map","// Allow inject brick packages in a runtime other than Brick Next.\nexport var injectedBrickPackages =\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntypeof BRICK_PACKAGES !== \"undefined\" ? BRICK_PACKAGES : null;\n//# sourceMappingURL=injected.js.map","// istanbul ignore file\n// Todo(steve): This file will be removed in the future.\nimport { hooks } from \"./internal/Runtime.js\";\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function authenticate() {\n  var _hooks$auth, _hooks$auth$authentic;\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  hooks === null || hooks === void 0 || (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 || (_hooks$auth$authentic = _hooks$auth.authenticate) === null || _hooks$auth$authentic === void 0 || _hooks$auth$authentic.call(_hooks$auth, ...args);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function getAuth() {\n  var _hooks$auth2;\n  return hooks === null || hooks === void 0 || (_hooks$auth2 = hooks.auth) === null || _hooks$auth2 === void 0 ? void 0 : _hooks$auth2.getAuth();\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function logout() {\n  var _hooks$auth3, _hooks$auth3$logout;\n  return hooks === null || hooks === void 0 || (_hooks$auth3 = hooks.auth) === null || _hooks$auth3 === void 0 || (_hooks$auth3$logout = _hooks$auth3.logout) === null || _hooks$auth3$logout === void 0 ? void 0 : _hooks$auth3$logout.call(_hooks$auth3);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function isLoggedIn() {\n  var _hooks$auth4;\n  return hooks === null || hooks === void 0 || (_hooks$auth4 = hooks.auth) === null || _hooks$auth4 === void 0 ? void 0 : _hooks$auth4.isLoggedIn();\n}\n//# sourceMappingURL=auth.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getProviderBrick } from \"./internal/data/getProviderBrick.js\";\nimport { resolveByProvider } from \"./internal/data/resolveData.js\";\nexport function fetchByProvider(_x, _x2, _x3) {\n  return _fetchByProvider.apply(this, arguments);\n}\nfunction _fetchByProvider() {\n  _fetchByProvider = _asyncToGenerator(function* (provider, args, options) {\n    var providerBrick = yield getProviderBrick(provider);\n    return resolveByProvider(providerBrick, provider, \"resolve\", args, options);\n  });\n  return _fetchByProvider.apply(this, arguments);\n}\n//# sourceMappingURL=fetchByProvider.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getDataStores, postAsyncRender, renderBricks } from \"./internal/Renderer.js\";\nimport { RendererContext } from \"./internal/RendererContext.js\";\nimport { DataStore } from \"./internal/data/DataStore.js\";\nimport { mountTree, unmountTree } from \"./internal/mount.js\";\nimport { httpErrorToString } from \"./handleHttpError.js\";\nimport { applyMode, applyTheme, setMode, setTheme } from \"./themeAndMode.js\";\nimport { RenderTag } from \"./internal/enums.js\";\nimport { registerStoryboardFunctions } from \"./internal/compute/StoryboardFunctions.js\";\nimport { registerAppI18n } from \"./internal/registerAppI18n.js\";\nimport { registerCustomTemplates } from \"./internal/registerCustomTemplates.js\";\nexport function unstable_createRoot(container) {\n  var {\n    portal: _portal,\n    scope = \"fragment\",\n    unknownBricks\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var portal = _portal;\n  var createPortal;\n  if (_portal) {\n    createPortal = _portal;\n  } else {\n    // Create portal container when necessary.\n    createPortal = () => {\n      portal = document.createElement(\"div\");\n      portal.style.position = \"absolute\";\n      portal.style.width = portal.style.height = \"0\";\n      document.body.append(portal);\n      return portal;\n    };\n  }\n  var unmounted = false;\n  var rendererContext;\n  var clearI18nBundles;\n  return {\n    render(brick) {\n      var _arguments = arguments;\n      return _asyncToGenerator(function* () {\n        var {\n          theme,\n          context,\n          functions,\n          templates,\n          i18n: i18nData\n        } = _arguments.length > 1 && _arguments[1] !== undefined ? _arguments[1] : {};\n        if (unmounted) {\n          throw new Error(\"The root is unmounted and cannot be rendered any more\");\n        }\n        var bricks = [].concat(brick);\n        var previousRendererContext = rendererContext;\n        rendererContext = new RendererContext(scope, {\n          unknownBricks\n        });\n        var runtimeContext = {\n          ctxStore: new DataStore(\"CTX\", undefined, rendererContext),\n          pendingPermissionsPreCheck: [],\n          tplStateStoreMap: new Map(),\n          formStateStoreMap: new Map()\n        };\n        var renderRoot = {\n          tag: RenderTag.ROOT,\n          container,\n          createPortal\n        };\n        if (scope === \"page\") {\n          var _clearI18nBundles;\n          setTheme(theme !== null && theme !== void 0 ? theme : \"light\");\n          setMode(\"default\");\n          var demoApp = {\n            id: \"demo\",\n            homepage: \"/demo\"\n          };\n          runtimeContext.app = demoApp;\n          var demoStoryboard = {\n            app: demoApp,\n            meta: {\n              i18n: i18nData,\n              customTemplates: templates\n            }\n          };\n\n          // Register i18n.\n          (_clearI18nBundles = clearI18nBundles) === null || _clearI18nBundles === void 0 || _clearI18nBundles();\n          clearI18nBundles = registerAppI18n(demoStoryboard);\n\n          // Register custom templates.\n          registerCustomTemplates(demoStoryboard);\n\n          // Register functions.\n          registerStoryboardFunctions(functions, demoApp);\n        }\n        runtimeContext.ctxStore.define(context, runtimeContext);\n        var failed = false;\n        var output;\n        var stores = [];\n        try {\n          output = yield renderBricks(renderRoot, bricks, runtimeContext, rendererContext, []);\n          stores = getDataStores(runtimeContext);\n          yield postAsyncRender(output, runtimeContext, stores);\n        } catch (error) {\n          failed = true;\n          output = {\n            node: {\n              tag: RenderTag.BRICK,\n              type: \"div\",\n              properties: {\n                textContent: httpErrorToString(error)\n              },\n              return: renderRoot,\n              runtimeContext: null\n            },\n            blockingList: [],\n            menuRequests: []\n          };\n        }\n        renderRoot.child = output.node;\n        previousRendererContext === null || previousRendererContext === void 0 || previousRendererContext.dispatchOnUnmount();\n        previousRendererContext === null || previousRendererContext === void 0 || previousRendererContext.dispose();\n        unmountTree(container);\n        if (portal) {\n          unmountTree(portal);\n        }\n        if (scope === \"page\") {\n          if (!failed) {\n            rendererContext.dispatchBeforePageLoad();\n          }\n          applyTheme();\n          applyMode();\n        }\n        mountTree(renderRoot);\n        if (scope === \"page\") {\n          window.scrollTo(0, 0);\n        }\n        if (!failed) {\n          for (var store of stores) {\n            store.mountAsyncData();\n          }\n          if (scope === \"page\") {\n            rendererContext.dispatchPageLoad();\n            // rendererContext.dispatchAnchorLoad();\n          }\n\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n          rendererContext.initializeMessageDispatcher();\n        }\n      })();\n    },\n    unmount() {\n      if (unmounted) {\n        return;\n      }\n      unmounted = true;\n      unmountTree(container);\n      if (portal) {\n        unmountTree(portal);\n        // Only remove the portal from its parent when it's dynamic created.\n        if (!_portal) {\n          portal.remove();\n        }\n      }\n    }\n  };\n}\n//# sourceMappingURL=createRoot.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { pick } from \"lodash\";\nimport { _internalApiGetRenderId, _internalApiGetRuntimeContext, _internalApiGetStoryboardInBootstrapData, getBrickPackages } from \"./Runtime.js\";\nimport { createScopedRuntimeContext, postAsyncRender, renderBrick } from \"./Renderer.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nexport function renderUseBrick(_x, _x2) {\n  return _renderUseBrick.apply(this, arguments);\n}\nfunction _renderUseBrick() {\n  _renderUseBrick = _asyncToGenerator(function* (useBrick, data) {\n    var _scopedRuntimeContext, _scopedRuntimeContext2, _output$node, _output$node2;\n    var [scopedRuntimeContext, tplStateStoreScope, formStateStoreScope] = createScopedRuntimeContext(_objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n      data,\n      pendingPermissionsPreCheck: []\n    }));\n    (_scopedRuntimeContext = scopedRuntimeContext.tplStateStoreMap) !== null && _scopedRuntimeContext !== void 0 ? _scopedRuntimeContext : scopedRuntimeContext.tplStateStoreMap = new Map();\n    (_scopedRuntimeContext2 = scopedRuntimeContext.formStateStoreMap) !== null && _scopedRuntimeContext2 !== void 0 ? _scopedRuntimeContext2 : scopedRuntimeContext.formStateStoreMap = new Map();\n    var rendererContext = new RendererContext(\"fragment\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      // Will set during `mountUseBrick`\n      createPortal: null\n    };\n    var transform = useBrick.transform;\n    var strict = isStrictMode();\n    if (transform) {\n      warnAboutStrictMode(strict, \"`useBrick.transform`\", 'please use \"properties\" instead, check your useBrick:', useBrick);\n    }\n    var output = yield renderBrick(renderRoot, strict ? useBrick : _objectSpread(_objectSpread({}, useBrick), {}, {\n      properties: _objectSpread(_objectSpread({}, useBrick.properties), transform)\n    }), scopedRuntimeContext, rendererContext, []);\n    var scopedStores = [...tplStateStoreScope, ...formStateStoreScope];\n    yield postAsyncRender(output, scopedRuntimeContext, scopedStores);\n    if (((_output$node = output.node) === null || _output$node === void 0 ? void 0 : _output$node.tag) === RenderTag.PLACEHOLDER) {\n      throw new Error(\"The root brick of useBrick cannot be an ignored control node\");\n    }\n    if ((_output$node2 = output.node) !== null && _output$node2 !== void 0 && _output$node2.portal) {\n      throw new Error(\"The root brick of useBrick cannot be a portal brick\");\n    }\n    renderRoot.child = output.node;\n    var tagName = output.node ? output.node.type : null;\n    return {\n      tagName,\n      renderRoot,\n      rendererContext,\n      scopedStores\n    };\n  });\n  return _renderUseBrick.apply(this, arguments);\n}\nexport function mountUseBrick(_ref, element) {\n  var {\n    renderRoot,\n    rendererContext,\n    scopedStores\n  } = _ref;\n  var portal;\n  renderRoot.createPortal = () => {\n    var portalRoot = document.querySelector(\"#portal-mount-point\");\n    portal = document.createElement(\"div\");\n    portalRoot.appendChild(portal);\n    return portal;\n  };\n  mountTree(renderRoot, element);\n  rendererContext.dispatchOnMount();\n  rendererContext.initializeScrollIntoView();\n  rendererContext.initializeMediaChange();\n  rendererContext.initializeMessageDispatcher();\n  for (var store of scopedStores) {\n    store.mountAsyncData();\n  }\n  return {\n    portal\n  };\n}\nexport function unmountUseBrick(_ref2, mountResult) {\n  var {\n    rendererContext\n  } = _ref2;\n  // if (mountResult.mainBrick) {\n  //   mountResult.mainBrick.unmount();\n  // }\n  if (mountResult.portal) {\n    unmountTree(mountResult.portal);\n    mountResult.portal.remove();\n  }\n  rendererContext.dispatchOnUnmount();\n  rendererContext.dispose();\n}\n\n/** For v2 compatibility of `doTransform` from brick-kit. */\nexport function legacyDoTransform(data, to, options) {\n  if (options) {\n    throw new Error(\"Legacy doTransform does not support options in v3\");\n  }\n  return computeRealValue(to, _objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n    data\n  }), {\n    noInject: true\n  });\n}\nexport function updateStoryboard(appId, storyboardPatch) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  Object.assign(storyboard, _objectSpread(_objectSpread({}, storyboardPatch), {}, {\n    $$fulfilling: null,\n    $$fulfilled: true,\n    $$registerCustomTemplateProcessed: false\n  }));\n  registerAppI18n(storyboard);\n}\nexport function updateStoryboardByRoute(appId, newRoute) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  var match = false;\n  var getKey = route => \"\".concat(route.path, \".\").concat(route.exact);\n  var replaceRoute = (routes, key) => {\n    return routes.map(route => {\n      var routeKey = getKey(route);\n      if (route.type === \"routes\") {\n        route.routes = replaceRoute(route.routes, key);\n        return route;\n      } else if (routeKey === key) {\n        match = true;\n        return newRoute;\n      } else {\n        return route;\n      }\n    });\n  };\n  storyboard.routes = replaceRoute(storyboard.routes, getKey(newRoute));\n  if (!match) {\n    storyboard.routes.unshift(newRoute);\n  }\n}\nexport function updateStoryboardByTemplate(appId, newTemplate, settings) {\n  var tplName = \"\".concat(appId, \".\").concat(newTemplate.name);\n  // customTemplateRegistry.delete(tplName);\n  customTemplates.define(tplName, {\n    bricks: newTemplate.bricks,\n    proxy: newTemplate.proxy,\n    state: newTemplate.state\n  });\n  updateTemplatePreviewSettings(appId, newTemplate.name, settings);\n}\nexport function updateTemplatePreviewSettings(appId, templateId, settings) {\n  _updatePreviewSettings(appId, \"${APP.homepage}/_dev_only_/template-preview/\".concat(templateId), [_objectSpread({\n    brick: templateId\n  }, pick(settings, \"properties\", \"events\", \"lifeCycle\", \"context\"))]);\n}\nfunction getSnippetPreviewPath(snippetId) {\n  return \"${APP.homepage}/_dev_only_/snippet-preview/\".concat(snippetId);\n}\nexport function updateStoryboardBySnippet(appId, snippetData) {\n  var _snippetData$bricks;\n  _updatePreviewSettings(appId, getSnippetPreviewPath(snippetData.snippetId), (_snippetData$bricks = snippetData.bricks) !== null && _snippetData$bricks !== void 0 && _snippetData$bricks.length ? snippetData.bricks : [{\n    brick: \"span\"\n  }], snippetData.context);\n}\nexport var updateSnippetPreviewSettings = updateStoryboardBySnippet;\nfunction _updatePreviewSettings(appId, path, bricks, context) {\n  var {\n    routes\n  } = _internalApiGetStoryboardInBootstrapData(appId);\n  var previewRouteIndex = routes.findIndex(route => route.path === path);\n  var newPreviewRoute = {\n    path,\n    bricks,\n    context,\n    menu: false,\n    exact: true\n  };\n  if (previewRouteIndex === -1) {\n    routes.unshift(newPreviewRoute);\n  } else {\n    routes.splice(previewRouteIndex, 1, newPreviewRoute);\n  }\n}\nexport function getContextValue(name, _ref3) {\n  var {\n    tplStateStoreId\n  } = _ref3;\n  var runtimeContext = _internalApiGetRuntimeContext();\n  if (tplStateStoreId) {\n    var tplStateStore = getTplStateStore(_objectSpread(_objectSpread({}, runtimeContext), {}, {\n      tplStateStoreId\n    }), \"STATE\");\n    return tplStateStore.getValue(name);\n  }\n  return runtimeContext.ctxStore.getValue(name);\n}\nexport function getAllContextValues(_ref4) {\n  var {\n    tplStateStoreId\n  } = _ref4;\n  var runtimeContext = _internalApiGetRuntimeContext();\n  if (tplStateStoreId) {\n    var tplStateStore = getTplStateStore(_objectSpread(_objectSpread({}, runtimeContext), {}, {\n      tplStateStoreId\n    }), \"STATE\");\n    return tplStateStore.getAllValues();\n  }\n  return runtimeContext.ctxStore.getAllValues();\n}\nexport function getBrickPackagesById(id) {\n  return getBrickPackages().find(pkg => pkg.id ? pkg.id === id : pkg.filePath.startsWith(id));\n}\nexport function getRenderId() {\n  return _internalApiGetRenderId();\n}\nexport function getAddedContracts(_x3, _x4) {\n  return _getAddedContracts.apply(this, arguments);\n}\nfunction _getAddedContracts() {\n  _getAddedContracts = _asyncToGenerator(function* (storyboardPatch, _ref5) {\n    var {\n      appId,\n      updateStoryboardType,\n      collectUsedContracts\n    } = _ref5;\n    var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n    var updatedStoryboard;\n\n    // 拿到更新部分的 storyboard 配置，然后扫描一遍，找到新增的 contracts\n    if (updateStoryboardType === \"route\") {\n      updatedStoryboard = {\n        routes: [storyboardPatch]\n      };\n    } else if (updateStoryboardType === \"template\") {\n      updatedStoryboard = {\n        meta: {\n          customTemplates: [storyboardPatch]\n        }\n      };\n    } else if (updateStoryboardType === \"snippet\") {\n      var _storyboard$routes;\n      // snippet 是放在挂载 route 里预览，通过 previewPath 拿到当前修改 route\n      var snippetPreviewPath = getSnippetPreviewPath(storyboardPatch.snippetId);\n      var currentRoute = storyboard === null || storyboard === void 0 || (_storyboard$routes = storyboard.routes) === null || _storyboard$routes === void 0 ? void 0 : _storyboard$routes.find(route => route.path === snippetPreviewPath);\n      updatedStoryboard = {\n        routes: [currentRoute]\n      };\n    }\n    var addedContracts = [];\n    if (updatedStoryboard && collectUsedContracts) {\n      var contractApis = yield collectUsedContracts(updatedStoryboard);\n      contractApis.forEach(api => {\n        var _storyboard$meta;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var [_, namespaceId, name] = api.match(/(.*)@(.*):\\d\\.\\d\\.\\d/);\n        if (!(storyboard !== null && storyboard !== void 0 && (_storyboard$meta = storyboard.meta) !== null && _storyboard$meta !== void 0 && (_storyboard$meta = _storyboard$meta.contracts) !== null && _storyboard$meta !== void 0 && _storyboard$meta.some(contract => contract.namespaceId === namespaceId && contract.name === name))) {\n          addedContracts.push(api);\n        }\n      });\n    }\n    return addedContracts;\n  });\n  return _getAddedContracts.apply(this, arguments);\n}\n//# sourceMappingURL=secret_internals.js.map"],"names":["_checkPrivateRedeclaration","obj","privateCollection","has","TypeError","_classExtractFieldDescriptor","receiver","privateMap","action","get","_classPrivateFieldGet","descriptor","call","value","classExtractFieldDescriptor","_classPrivateFieldInitSpec","set","_classPrivateFieldSet","writable","_classPrivateMethodGet","privateSet","fn","_classPrivateMethodInitSpec","add","_defineProperty","key","Object","defineProperty","enumerable","configurable","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","_objectWithoutProperties","source","excluded","i","target","sourceKeys","indexOf","sourceSymbolKeys","prototype","propertyIsEnumerable","_toPropertyKey","arg","input","hint","prim","Symbol","toPrimitive","undefined","res","String","_typeof","iterator","constructor","getBasePath","base","document","querySelector","getAttribute","matchStoryboard","storyboards","pathname","sortedStoryboards","orderBy","storyboard","_storyboard$app$homep","_storyboard$app$homep2","app","homepage","matchHomepage","concat","replace","startsWith","isOutsideApp","_getRuntime$getCurren","getRuntime","getCurrentApp","id","window","STANDALONE_MICRO_APPS","standaloneMode","_excluded","blocked","getUserConfirmation","message","callback","confirm","getV2RuntimeFromDll","_window$BRICK_NEXT_VE","dll","BRICK_NEXT_VERSIONS","createHistory","browserHistory","createBrowserHistory","basename","assign","blockMessage","originalPush","originalReplace","location","state","updateQueryFactory","method","query","options","extraQuery","clear","keepHash","urlSearchParams","URLSearchParams","search","params","entries","Array","isArray","item","delete","append","toString","hash","pushQuery","replaceQuery","pushAnchor","notify","reload","setBlockMessage","getBlockMessage","unblock","updateFactory","path","pathIsString","parsePath","_bootstrapData$storyb","_bootstrapData8","bootstrapData","_internalApiMatchStoryboard","substring","createHref","historyOverridden","historyExtended","getHistory","v2Kit","getHistoryV2Factory","_registry","WeakMap","customProcessors","freeze","define","processorFullName","processorFunc","registerCustomProcessor","getCustomProcessorsV2","this","Map","namespace","processorName","split","pkg","Error","registerAppI18n","_ref","meta","i18n","i18nNamespace","getI18nNamespace","languages","_ref2","lang","resources","addResourceBundle","removeResourceBundle","type","widgetI18nFactory","widgetId","getFixedT","selectedPanel","registerWidgetI18n","i18nData","registerWidgetI18nV2Factory","ns","MESSAGE_SOURCE_PANEL","FRAME_ACTIVE_CHANGE","PANEL_CHANGE","frameIsActive","devtoolsHookEmit","payload","devtools","getDevHook","emit","_devtools$emit","requestIdleCallback","setTimeout","__BRICK_NEXT_DEVTOOLS_HOOK__","THROW","readOnlyHandler","deleteProperty","setPrototypeOf","getReadOnlyProxy","object","Proxy","getDynamicReadOnlyProxy","fromEntries","map","theme","storage","JsonStorage","localStorage","LOCAL_STORAGE_APPS_THEME_KEY","setTheme","getTheme","getCurrentTheme","documentElement","dataset","applyTheme","dispatchEvent","CustomEvent","detail","batchSetAppsLocalTheme","appsTheme","setItem","getLocalAppsTheme","_result","result","getItem","_unused","console","error","mode","setMode","getCurrentMode","applyMode","getCssPropertyValue","name","_window$getComputedSt","el","getComputedStyle","getPropertyValue","getGeneralGlobals","attemptToVisitGlobals","globalVariables","variableName","variable","getIndividualGlobal","_hooks$images","_hooks$images2","_hooks$checkPermissio","collectCoverage","widgetVersion","appendI18nNamespace","storyboardFunctions","isStoryboardFunction","hooks","images","widgetImagesFactory","imagesFactory","isBuildPush","currentVersion","identity","Boolean","fakeI18nText","i18nText","check","fakeCheckPermissions","checkPermissions","href","origin","host","hostname","data","en","StoryboardFunctionRegistryFactory","currentApp","registeredFunctions","collector","processed","cooked","createCollector","precooked","precookFunction","typescript","beforeVisit","cook","function","rules","noVar","supply","beforeEvaluate","beforeCall","beforeBranch","getStoryboardFunction","registerStoryboardFunctions","functions","deps","collectMemberUsageInFunction","hasPermissionsCheck","updateStoryboardFunction","newFn","checkPermissionsUsage","functionNames","checkedFunctions","Set","some","EventTarget","wm","create","proto","dispatch","info","once","removeEventListener","listener","handleEvent","_stopImmediatePropagationFlag","secret","listeners","event","slice","currentTarget","splice","MediaBreakpoint","mediaBreakpointMinWidthMap","xLarge","large","medium","small","xSmall","mediaEventTarget","breakpointMatchesMap","MEDIA","handleMatchesChange","breakpoint","changed","_breakpoint","matches","minWidth","mediaQueryList","matchMedia","addEventListener","addListener","getMedia","getStorageItem","storageType","_storage$getItem","sessionStorage","JSON","parse","isStrictMode","runtimeContext","_getRuntime","flags","getFeatureFlags","warnAboutStrictMode","strict","_len","extraLogs","_key","punctuation","warn","allowedNativeProps","customTemplates","tagName","registerCustomTemplate","getCustomTemplatesV2","_constructor$proxy$pr","_constructor$proxy","_compatibleConstructo","_compatibleConstructo2","registered","customElements","proxyProperties","proxy","properties","validProxyProps","legacyTplVariables","asVariable","mergeProperty","refTransform","ref","compatibleConstructor","expose","tpl","_state$filter$map","exposedStates","uniq","proxyMethods","methods","props","entry","nativeProps","prop","HTMLElement","p","join","TplElement","$$typeof","_dev_only_definedProperties","_dev_only_definedMethods","$$getElementByRef","_this$$$tplStateStore","$$tplStateStore","hostBrick","tplHostMetadata","internalBricksByRef","element","connectedCallback","shadowRoot","attachShadow","fragment","createDocumentFragment","style","createElement","textContent","slot","appendChild","disconnectedCallback","_loop","propName","getValue","_this$$$tplStateStore2","updateValue","_loop2","from","to","_to$refProperty","refProperty","_this$$$getElementByR","_to$refProperty2","_loop3","_from","_to","_to$refMethod","refMethod","getTplStateStore","using","extraInfo","tplStateStoreId","tplStateStoreMap","store","getTplHostElement","hostElement","widgetFunctionRegistry","widgetFunctions","registerWidgetFunctions","registerWidgetFunctionsV2Factory","semver","validateAndParse","version","match","shift","isWildcard","s","tryParse","v","n","parseInt","isNaN","compareStrings","a","b","ap","bp","forceType","compareSegments","Math","max","compare","v1","v2","operator","assertValidOperator","n1","n2","p1","pop","p2","compareVersions","operatorResMap","includes","allowedOperators","op","hasInstalledApp","appId","matchVersion","_internalApiGetAppInBootstrapData","checkInstalledApps","getCheckedApp","installStatus","getFormStateStore","formStateStoreId","formStateStoreMap","pool","getProviderBrick","_x","_getProviderBrick","provider","_hooks$flowApi","isFlowApi","flowApi","isFlowApiProvider","FLOW_API_PROVIDER","brick","registerFlowApiProvider","loadBricksImperatively","getBrickPackages","computed","WeakSet","markAsComputed","isObject","hasBeenComputed","getPrototypeOf","values","cache","resolveData","_x2","_x3","_resolveData","resolveConf","useProvider","args","onReject","legacyProvider","field","legacyField","hasLegacyField","providerBrick","actualArgs","Promise","all","asyncComputeRealValue","promise","resolveByProvider","transform","isHandleRejectByTransform","_x4","_x5","_x6","_x7","_x8","_x9","_resolveByProvider","originalArgs","cacheKey","stringify","finalArgs","getArgsOfFlowApi","resolve","symbolForRaw","for","symbolForContext","isPreEvaluated","raw","getPreEvaluatedRaw","pre","shouldDismissMarkingComputed","shouldAllowRecursiveEvaluations","possibleErrorConstructs","SyntaxError","ReferenceError","getCookErrorConstructor","_asyncEvaluate","blockingList","run","lowLevelEvaluate","isAsync","passByRuntimeContext","omit","menuUsage","usedArgs","hasAppUsage","preevaluate","withParent","beforeVisitGlobal","node","parent","collectAppGetMenuUsage","collectInstalledAppsHasUsage","hasNonStaticUsage","usedCtx","usedProcessors","usedStates","tplStateStore","lazy","hasOwnProperty","usedFormStates","formStateStore","devHook","strictCollectMemberUsage","ctxStore","waitFor","usedTpls","loadProcessorsImperatively","_hooks$checkInstalled","attemptToCheckPermissions","usedFunctions","pendingPermissionsPreCheck","size","menu","usedMenuIds","menuId","fetchMenuById","getStoryboardByAppId","_internalApiGetStoryboardInBootstrapData","waitForCheckingApps","_runtimeContext$overr","_hooks$menu","_match$params","sys","overrideApp","cloneDeep","getMenu","getMenuById","property","getMiscSettings","k","processor","getAll","expression","context","_message","StateOfUseBrick","isLazyContentInUseBrick","USE_BRICK_PROPERTIES","USE_BRICK_TRANSFORM","USE_BRICK_EVENTS","USE_BRICK_IF","USE_BRICK_LIFECYCLE","USE_BRICK_DATA_SOURCE","getNextStateOfUseBrick","USE_BRICK","USE_BRICK_ITEM","USE_BRICK_SLOTS_ITEM_BRICKS","USE_BRICK_SLOTS_ITEM_BRICKS_ITEM","INITIAL","USE_BRICK_SLOTS","USE_BRICK_SLOTS_ITEM","_asyncComputeRealValue","internalOptions","preEvaluated","$$lazyForUseBrick","$$stateOfUseBrick","dismissMarkingComputed","isEvaluable","asyncEvaluate","noInject","transformAndInject","inject","nextOptions","getNextComputeOptions","ignoreSymbols","computeRealValue","evaluate","asyncCheckIf","_asyncCheckIf","ifContainer","if","checkIf","checkIfOfComputed","_asyncCheckBrickIf","brickConf","checkIfByTransform","looseCheckIfByTransform","checkIfByTransformV2Factory","getTracks","contextNames","stateNames","formStateNames","isTrackAll","trackAll","formState","track","computePropertyValue","_computePropertyValue","asyncPropertyEntries","asyncValue","ignoreUndefined","constructAsyncProperties","_constructAsyncProperties","setRealProperties","realProps","propValue","setProperties","bricks","realValue","computeRealProperties","escapeString","str","sensitive","stringToRegexp","tokens","_a","_b","start","_c","end","_d","encode","x","_e","delimiter","_f","endsWith","endsWithRe","delimiterRe","route","_i","tokens_1","token","prefix","suffix","pattern","modifier","mod","endToken","isEndDelimited","RegExp","tokensToRegexp","char","index","count","j","code","charCodeAt","lexer","prefixes","defaultPattern","tryConsume","mustConsume","nextType","consumeText","name_1","pattern_1","pathToRegexp","groupsRegex","execResult","exec","regexpToRegexp","paths","parts","arrayToRegexp","cacheLimit","cacheCount","matchPath","exact","reduce","matched","regexp","pathCache","cacheResult","compilePath","url","isExact","memo","_matchRoutes","routes","matchRoute","noAuthGuard","public","auth","isLoggedIn","symbolForAsyncComputedPropsFromHost","symbolForTplStateStoreId","symbolForTPlExternalForEachItem","symbolForTPlExternalForEachIndex","timeoutIdList","K","REQUEST_FAILED","SOMETHING_WENT_WRONG","LOGIN_TIMEOUT_MESSAGE","NETWORK_ERROR","zh","NS","locales","Dialog","show","content","reject","alert","httpErrorToString","Event","HTMLScriptElement","src","HttpFetchError","HttpResponseError","responseJson","msg","isUnauthenticatedError","response","status","lastErrorMessage","unauthenticatedConfirming","handleHttpError","HttpAbortError","NO_AUTH_GUARD","then","ssoEnabled","history","title","contentStyle","whiteSpace","Notification","bindListeners","eventsMap","eventType","handlers","listenerFactory","handler","$$listeners","$$eventListeners","isBuiltinHandler","isUseProviderHandler","isCustomHandler","targetRef","isConditionalEventHandler","runtimeBrick","_handler$batch","_handler$batch2","handleHistoryAction","handleWindowAction","handleLocationAction","handleStorageAction","preventDefault","handleConsoleAction","handleMessageAction","handleContextAction","batch","handleTplStateAction","init","argsFactory","handleFormStateAction","handleMessageDispatcher","handleUseProviderAction","handleCustomAction","else","_handleUseProviderAction","brickCallback","targets","rawTarget","rawTargetRef","computedTarget","multiple","querySelectorAll","found","computedTargetRef","targetRefs","tplHostElement","_tplHostElement$$$get","isExecuteCustomHandler","useEventAsDefault","isSetPropsCustomHandler","_x10","_x11","_brickCallback","_poll","task","computedArgs","poll","callbackFactory","eventCallbackFactory","pollableCallback","progress","success","finally","enabled","currentTimeoutId","finallyCallback","interval","leadingRequestDelay","continueOnError","delegateLoadingBar","expectPollEnd","expectPollStopImmediately","currentRenderId","_internalApiGetRenderId","shouldStop","delayedPoll","delay","startPoll","err","baseArgsLength","hasCallback","overrideMethod","useEventDetailAsDefault","features","open","batchUpdate","updateValues","every","removeItem","_x12","_x13","_x14","_x15","_x16","_x17","_handleMessageDispatcher","_hooks$messageDispatc","messageDispatcher","supportContextResolveTriggerBrickLifeCycle","DataStore","rendererContext","changeEventType","getAllValues","_this$data$get","getAffectListByContext","affectNames","batchUpdateContextsNames","updateContexts","affectContexts","affectDepsContextNames","updateContextItem","affectContextItem","triggerEvent","contexts","_context$eventTarget","eventTarget","callbackRuntimeContext","load","loaded","loading","val","dataConfs","asyncHostPropertyEntries","routePath","pending","contextConfs","resolveContext","keyword","dependencyMap","depsMap","_contextConf","stats","collectMemberUsage","getDependencyMapOfContext","pendingDeps","contextName","contextConf","_pendingDeps$get","deferredContexts","pendingContexts","wrapResolve","_pendingDeps$get2","resolved","left","scheduleNext","scheduleAsSerial","_scheduleNext","readyContexts","usedProperties","dep","predicateNextResolveFactory","pendingResult","deferred","duplicatedMap","next","processedAtLeastOne","_contextConf2","detectCircularContexts","catch","resolveDataStore","dataConf","pendingStack","onChange","dataName","_this$data$get2","dataNames","_this","ctx","waitForAll","_this2","mountAsyncData","_this$routeMap$get","async","routeMap","asyncMounted","_this3","resolvePolicy","newData","_this3$rendererContex","trigger","registerArbitraryLifeCycle","batchAddListener","names","disposeDataInRoutes","setupTemplateProxy","hostContext","slots","asyncComputedProps","asyncHostProps","reversedProxies","externalSlots","propertyProxies","filtered","slotProxies","quasisMap","_externalSlots$from$b","_externalSlots$from","_to$refSlot","_to$refPosition","insertBricks","refToSlot","refSlot","expandableSlot","refPosition","clamp","setupTemplateExternalBricks","forEachItem","forEachIndex","slotName","slotConf","quasis","flatMap","_brick$slots","_slotConf$bricks","setupTemplateExternalRoutes","setupUseBrickInTemplate","walk","setup","originalSlots","children","restConf","transpiledSlots","childrenToSlots","_excluded2","expandCustomTemplate","tplTagName","uniqueId","tplStateStoreScope","contracts","collectWidgetContract","originalExternalSlots","externalChildren","restBrickConf","newBrickConf","proxies","_proxies","expandBrickInTemplate","brickConfInTemplate","slotsInTemplate","childrenInTemplate","restBrickConfInTemplate","RenderTag","FORM_RENDERER","symbolForFormStateStoreId","formContainers","formSchemaToBrick","schema","fields","events","mountPoint","instanceId","iid","find","fieldId","defaults","defaultValue","commonProps","label","testid","getReadOnlyAndRequired","_field$limit","_field$limit2","readOnly","limit","required","fieldType","placeholder","description","precision","inputBoxStyle","width","getDefaultProperties","formSchemasToBricks","schemas","_excluded3","_excluded4","_excluded5","renderRoutes","_renderRoutes","returnNode","_runtimeContext","parentRoutes","slotId","isIncremental","matchRoutes","output","menuRequests","unauthenticated","preCheckPermissionsForBrickOrRoute","preLoadBricks","redirectTo","redirect","menuRequest","menuConf","loadMenu","mergeRenderOutput","renderBricks","tag","BRICK","memoizeMenuRequests","_renderBricks","tplStack","keyPath","kPath","renderBrick","hasTrackingControls","memoize","_x18","_x19","_x20","_x21","_renderBrick","_hooks$checkPermissio2","_runtimeContext$app","template","brickIf","permissionsPreCheck","isGeneralizedTrackAll","dataSource","acc","symbol","asyncCheckBrickIf","brickName","_brickConf$lifeCycle","ensureValidControlBrick","lowerLevelRenderControlNode","_slots$slot","computedDataSource","_x22","_x23","_x24","_x25","_x26","_x27","_x28","_x29","_x30","_renderForEach","renderForEach","_x31","renderControlNode","_rawOutput$node","rawOutput","PLACEHOLDER","return","_x32","controlledOutput","onMount","onUnmount","lifeCycle","renderId","_ref3","scopedRuntimeContext","formStateStoreScope","createScopedRuntimeContext","reControlledOutput","scopedStores","postAsyncRender","rerender","reRender","debouncedListener","debounce","_contextName","test","catchLoad","unknownBricks","formData","confProps","getTagNameOfCustomTemplate","_tplStack$get","tplCount","enqueueStableLoadBricks","_brickConf$properties","_ref4","trackingContextList","asyncComputeRealPropertyEntries","computedPropsFromHost","isScript","rel","_window$PUBLIC_ROOT","PUBLIC_ROOT","attrs","loadScript","loadStyle","portal","loadProperties","_ref5","stateName","_stateName","listenOnTrackingContext","registerBrickLifeCycle","childRuntimeContext","expandedBrickConf","hostBrickConf","_normalizedFormData$c","_hostBrickConf$proper","normalizedFormData","formConf","formSchema","targetEvents","sourceEvents","flat","mergeEvents","renderRoot","padding","expandFormRenderer","loadChildren","_ref6","routeSlotIndexes","rendered","_ref7","childSlotId","performIncrementalRender","_ref8","incrementalOutput","failed","reBailout","reMergeMenuRequests","reCatch","_x33","childrenOutput","child","rows","getDataStores","stores","flushStableLoadBricks","newOutput","rest","last","sibling","newSlots","_child$slot","unknownPolicy","bindTemplateProxy","_tplHostMetadata$prox","_to$refEvent","_ref$$$proxyListeners","bubbles","stopPropagation","cancelable","composed","refEvent","$$proxyListeners","unbindTemplateProxy","_$$proxyListeners","unmountTree","replaceChildren","mountTree","root","initializedElement","current","portalElements","_current$tplHostMetad","setAttribute","childElements","_currentReturn","currentReturn","_currentReturn$contai","ROOT","container","createPortal","misc","nativeController","commonLifeCycles","pageOnlyLifeCycles","_routeHelper","_memoizedLifeCycle","_observers","_mediaListener","_arbitraryLifeCycle","_memoized","_allMenuRequests","_memoizedMenuRequestMap","_locationChangeCallbacks","_unmountBricks","_initializeRerenderBricks","_dispatchGeneralLifeCycle","_addObserver","RendererContext","scope","_options$unknownBrick","onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload","onMediaChange","onScrollIntoView","onMessage","onMessageClose","routeHelper","setInitialMenuRequests","currentRoute","previousMenuRequest","previousRoute","mergedMenuRequests","previousIndex","mergeMenus","bailout","didPerformIncrementalRender","lifeCycleTypes","isEmpty","useResolves","arbitraryCallbacks","memKey","mem","getLastNode","lastNormal","getLastNormalNode","lastPortal","getLastPortalNode","insertBeforeChild","insertPortalBeforeChild","_getNextNormalNode$el","_getNextNormalNode","_getNextPortalNode$el","_getNextPortalNode","_prevLastNormal$eleme","_prevLastNormal$eleme2","_prevLastPortal$eleme","_prevLastPortal$eleme2","memoized","prevNode","prevLast","prevLastNormal","prevLastPortal","getSpecifiedNormalNode","getNextNormalNode","getSpecifiedPortalNode","getNextPortalNode","nextSibling","prevSibling","portalFragment","_returnNode$container","_returnNode$element","removeBricks","getBrickRange","_unmountBricks2","insertBefore","childNodes","_root","newBricks","_initializeRerenderBricks2","dispose","list","_list","observer","disconnect","dispatchBeforePageLoad","_dispatchGeneralLifeCycle2","dispatchPageLoad","dispatchBeforePageLeave","dispatchPageLeave","dispatchAnchorLoad","anchor","initializeScrollIntoView","conf","_addObserver2","initializeMediaChange","initializeMessageDispatcher","_hooks$messageDispatc2","channel","confList","onClose","dispatchOnMount","dispatchOnUnmount","unmountList","removed","remove","_brick$element","_brick$element2","observers","unmountEvent","_brick","mountEvent","_brick2","_conf$threshold","threshold","IntersectionObserver","isIntersecting","intersectionRatio","observe","_last","range","_currentReturn2","getPageInfo","isInIframe","isInIframeOfSameSite","isInIframeOfNext","isInIframeOfVisualBuilder","isInIframeOfLegacyConsole","selfIsNext","parentPathname","parentIsNext","Number","registerCustomTemplates","_storyboard$meta","$$registerCustomTemplateProcessed","templates","_fulfilStoryboard","$$fulfilled","$$fulfilling","_doFulfilStoryboard","doFulfilStoryboard","_hooks$fulfilStoryboa","fulfilStoryboard","_storyboards","_rendering","_prevLocation","_nextLocation","_rendererContext","_rendererContextTrashCan","_redirectCount","_renderId","_currentApp","_previousApp","_navConfig","_getBlockMessageBeforePageLave","_safeRedirect","_queuedRender","_render","Router","_history","_getBlockMessageBeforePageLave2","returnValue","block","getRenderId","getRuntimeContext","getRecentApps","previousApp","getNavConfig","bootstrap","AbortController","http","interceptors","request","use","config","_config$options","signal","noAbortOnRouteChange","listen","_classPrivateFieldGet2","_location$state","_classPrivateFieldGet4","ignoreRendering","_classPrivateFieldGet3","omittedLocationProps","locationsAreEqual","abort","_queuedRender2","_classPrivateFieldGet5","previousMessage","_safeRedirect2","_this$redirectCount","_this$redirectCount2","_queuedRender3","_render2","nextLocation","_render3","_hooks$pageView","_classPrivateFieldGet6","clearCollectWidgetContract","finishPageView","pageView","appChanged","prevRendererContext","redirectToLogin","main","cleanUpPreviousRender","reset","_hooks$auth","_hooks$flowApi2","_storyboard$meta2","preCheckInstalledApps","menuConfs","navConfig","breadcrumb","overwrite","items","mergeMenuConfs","noAuthGuardLoginPath","getAuth","settings","brand","getBrandSettings","preCheckPermissions","collectContract","mergedRoutes","specificTemplatePreviewIndex","findLastIndex","specificSnippetPreviewIndex","insertPreviewRoutes","DISABLE_REACT_FLUSH_SYNC","scrollTo","pageTitle","runtime","router","injectedBrickPackages","BRICK_PACKAGES","createRuntime","active","panel","initializeI18n","language","on","Runtime","Reflect","getRuntimeV2Factory","_initialized","_bootstrapped","initialize","_data$settings$preset","_data$settings","localeName","deepFreeze","brickPackages","normalizeBootstrapData","notification","dialog","presetBricks","loadNotificationService","loadBricks","loader","loadDialogService","_router$getRecentApps","_router","_router2","_bootstrapData","_router3","featureFlags","_bootstrapData2","_router4","_bootstrapData3","base_title","getLaunchpadSettings","_bootstrapData4","columns","launchpad","getDesktops","_bootstrapData$deskto","_bootstrapData5","desktops","getLaunchpadSiteMap","_bootstrapData$siteSo","_bootstrapData6","siteSort","toggleLaunchpadEffect","body","classList","toggle","applyPageTitle","baseTitle","_router5","_bootstrapData$brickP","_bootstrapData7","STANDALONE_BRICK_PACKAGES","_router6","_internalApiGetRuntimeContext","_router7","_bootstrapData9","_internalApiGetStoryb","authenticate","_hooks$auth$authentic","_hooks$auth2","logout","_hooks$auth3","_hooks$auth3$logout","_hooks$auth4","fetchByProvider","_fetchByProvider","unstable_createRoot","_portal","position","height","clearI18nBundles","unmounted","render","_arguments","previousRendererContext","_clearI18nBundles","demoApp","demoStoryboard","unmount","renderUseBrick","_renderUseBrick","useBrick","_scopedRuntimeContext","_scopedRuntimeContext2","_output$node","_output$node2","mountUseBrick","portalRoot","unmountUseBrick","mountResult","legacyDoTransform","updateStoryboard","storyboardPatch","updateStoryboardByRoute","newRoute","getKey","replaceRoute","routeKey","unshift","updateStoryboardByTemplate","newTemplate","tplName","updateTemplatePreviewSettings","templateId","_updatePreviewSettings","pick","getSnippetPreviewPath","snippetId","updateStoryboardBySnippet","snippetData","_snippetData$bricks","updateSnippetPreviewSettings","previewRouteIndex","findIndex","newPreviewRoute","getContextValue","getAllContextValues","getBrickPackagesById","filePath","getAddedContracts","_getAddedContracts","updatedStoryboard","updateStoryboardType","collectUsedContracts","_storyboard$routes","snippetPreviewPath","addedContracts","api","_","namespaceId","contract"],"sourceRoot":""}